(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8374,e=>{"use strict";var t=e.i(43476),r=e.i(22016),s=e.i(18566),a=e.i(47163),n=e.i(75254);let i=(0,n.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var o=e.i(88844),l=e.i(1928),d=e.i(61911),c=e.i(39616);let u=(0,n.default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var m=e.i(37727),p=e.i(15788),h=e.i(73014),f=e.i(5125),x=e.i(67881),v=e.i(71435),w=e.i(52917),g=e.i(71645);let y=[{title:"داشبورد",href:"/admin",icon:i},{title:"محصولات",href:"/admin/products",icon:o.Package},{title:"سفارشات",href:"/admin/orders",icon:l.ShoppingCart,disabled:!1},{title:"کاربران",href:"/admin/users",icon:d.Users,disabled:!1},{title:"تامین‌کنندگان",href:"/admin/suppliers",icon:p.Truck,disabled:!1},{title:"دسته‌بندی‌ها",href:"/admin/categories",icon:h.FolderTree,disabled:!1},{title:"خودروها",href:"/admin/vehicles",icon:f.Car,disabled:!1},{title:"تنظیمات",href:"/admin/settings",icon:c.Settings,disabled:!1}];function j({className:e}){let n=(0,s.usePathname)(),[o,l]=(0,g.useState)(!1),d=()=>(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("div",{className:"p-6 border-b border-border/30 bg-gradient-to-br from-primary/5 to-primary/10",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-primary text-primary-foreground",children:(0,t.jsx)(i,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-primary",children:"پنل مدیریت"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"فروشگاه ساد"})]})]})}),(0,t.jsx)(v.ScrollArea,{className:"flex-1",children:(0,t.jsx)("nav",{className:"p-4 space-y-1",children:y.map(e=>{let s=e.icon,i=n===e.href||"/admin"!==e.href&&n?.startsWith(e.href),o=e.disabled;return(0,t.jsxs)(r.default,{href:o?"#":e.href,onClick:()=>l(!1),className:(0,a.cn)("flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200",i?"bg-primary text-primary-foreground shadow-sm":"text-foreground hover:bg-accent hover:text-accent-foreground hover:translate-x-[-2px]",o&&"opacity-50 cursor-not-allowed"),children:[(0,t.jsx)(s,{className:"h-5 w-5 flex-shrink-0"}),(0,t.jsx)("span",{children:e.title}),o&&(0,t.jsx)("span",{className:"mr-auto text-xs opacity-60",children:"(به زودی)"})]},e.href)})})}),(0,t.jsx)("div",{className:"p-4 border-t border-border/30",children:(0,t.jsx)(r.default,{href:"/",children:(0,t.jsxs)(x.Button,{variant:"outline",className:"w-full justify-start gap-2",children:[(0,t.jsx)(m.X,{className:"h-4 w-4"}),"بازگشت به سایت"]})})})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("aside",{className:(0,a.cn)("hidden lg:flex flex-col w-64 border-l border-border/30 bg-background/95 backdrop-blur",e),children:(0,t.jsx)(d,{})}),(0,t.jsx)(w.Sheet,{open:o,onOpenChange:l,children:(0,t.jsxs)(w.SheetContent,{side:"right",className:"w-64 p-0",children:[(0,t.jsx)(w.SheetHeader,{className:"sr-only",children:(0,t.jsx)(w.SheetTitle,{children:"منوی مدیریت"})}),(0,t.jsx)(d,{})]})}),(0,t.jsx)(x.Button,{variant:"ghost",size:"icon",className:"lg:hidden fixed top-4 left-4 z-50",onClick:()=>l(!0),children:(0,t.jsx)(u,{className:"h-5 w-5"})})]})}var b=e.i(82429),N=e.i(63415),E=e.i(30374),C=e.i(84614),k=e.i(92270),T=e.i(45423),P=e.i(55436),S=e.i(70756),D=e.i(94983),R=e.i(86536),L=e.i(77705),A=e.i(95468),F=e.i(31278),M=e.i(23750),I=e.i(10708),H=e.i(20682);function O({onSearch:e}){let[r,s]=(0,g.useState)(!1),[a,n]=(0,g.useState)(!1),[i,o]=(0,g.useState)(0),[l,d]=(0,g.useState)(!1),[c,u]=(0,g.useState)(""),[m,p]=(0,g.useState)(""),[h,f]=(0,g.useState)(""),[v,w]=(0,g.useState)(!1),[y,j]=(0,g.useState)(!1),[O,B]=(0,g.useState)(!1),[K,z]=(0,g.useState)(!1),{toast:U}=(0,H.useToast)();(0,g.useEffect)(()=>{s(!0)},[]);let $=(0,g.useCallback)(async()=>{try{let e=await fetch("/api/chat/unread-count?all=true");if(e.ok){let t=await e.json();if(t.success&&t.data?.chats){let e=t.data.chats.reduce((e,t)=>e+(t.unreadCount||0),0);o(e)}}}catch(e){console.error("Error fetching unread count:",e)}},[]);(0,g.useEffect)(()=>{$();let e=setInterval(()=>{$()},a?1e4:5e3);return()=>clearInterval(e)},[$,a]),(0,g.useEffect)(()=>{$()},[a,$]);let V=async e=>{if(e.preventDefault(),!m.trim())return void U({title:"خطا",description:"لطفاً رمز عبور جدید را وارد کنید",variant:"destructive"});if(m.length<6)return void U({title:"خطا",description:"رمز عبور باید حداقل 6 کاراکتر باشد",variant:"destructive"});if(m!==h)return void U({title:"خطا",description:"رمز عبور جدید و تأیید آن مطابقت ندارند",variant:"destructive"});z(!0);try{let e=await fetch("/api/admin/password",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:m,currentPassword:c||void 0})}),t=await e.json();t.success?(U({title:"موفق",description:"رمز عبور با موفقیت تغییر کرد"}),u(""),p(""),f(""),d(!1)):U({title:"خطا",description:t.error||"خطا در تغییر رمز عبور",variant:"destructive"})}catch(e){U({title:"خطا",description:e.message||"خطا در اتصال به سرور",variant:"destructive"})}finally{z(!1)}},X=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),window.location.href="/admin/login"}catch(e){console.error("Logout error:",e),window.location.href="/admin/login"}};return(0,t.jsxs)("header",{className:"sticky top-0 z-40 w-full border-b border-border/30 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex h-16 items-center gap-4 px-4 lg:px-6",children:[e&&(0,t.jsx)("div",{className:"flex-1 max-w-md",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(P.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(M.Input,{type:"search",placeholder:"جستجو...",className:"pr-10",onChange:t=>e(t.target.value)})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mr-auto",children:[(0,t.jsxs)(x.Button,{variant:"ghost",size:"icon",onClick:()=>n(!0),className:"relative",title:"چت با کاربران",children:[(0,t.jsx)(D.MessageCircle,{className:"h-5 w-5"}),i>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 h-5 w-5 rounded-full bg-destructive text-white text-xs font-bold flex items-center justify-center border-2 border-background shadow-sm",children:"!"})]}),(0,t.jsxs)(x.Button,{variant:"ghost",size:"icon",className:"relative",children:[(0,t.jsx)(T.Bell,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"absolute top-1 left-1 h-2 w-2 rounded-full bg-destructive"})]}),r?(0,t.jsxs)(N.DropdownMenu,{children:[(0,t.jsx)(N.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(x.Button,{variant:"ghost",size:"icon",className:"rounded-full",children:(0,t.jsx)(C.User,{className:"h-5 w-5"})})}),(0,t.jsxs)(N.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsx)(N.DropdownMenuLabel,{children:"حساب کاربری"}),(0,t.jsx)(N.DropdownMenuSeparator,{}),(0,t.jsxs)(N.DropdownMenuItem,{onClick:()=>d(!0),children:[(0,t.jsx)(S.Lock,{className:"ml-2 h-4 w-4"}),"تغییر رمز عبور"]}),(0,t.jsx)(N.DropdownMenuSeparator,{}),(0,t.jsxs)(N.DropdownMenuItem,{className:"text-destructive",onClick:X,children:[(0,t.jsx)(k.LogOut,{className:"ml-2 h-4 w-4"}),"خروج"]})]})]}):(0,t.jsx)(x.Button,{variant:"ghost",size:"icon",className:"rounded-full",disabled:!0,children:(0,t.jsx)(C.User,{className:"h-5 w-5"})})]})]}),(0,t.jsx)(b.AdminChat,{isOpen:a,onOpenChange:n}),(0,t.jsx)(E.Dialog,{open:l,onOpenChange:d,children:(0,t.jsxs)(E.DialogContent,{className:"max-w-md",children:[(0,t.jsx)(E.DialogHeader,{children:(0,t.jsxs)(E.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(S.Lock,{className:"h-5 w-5"}),"تغییر رمز عبور ادمین"]})}),(0,t.jsxs)("form",{onSubmit:V,className:"space-y-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(I.Label,{htmlFor:"currentPassword",children:"رمز عبور فعلی (اختیاری برای اولین بار)"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(M.Input,{id:"currentPassword",type:v?"text":"password",placeholder:"رمز عبور فعلی را وارد کنید",value:c,onChange:e=>u(e.target.value),disabled:K,className:"pr-10"}),(0,t.jsx)(x.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>w(!v),disabled:K,children:v?(0,t.jsx)(L.EyeOff,{className:"h-4 w-4"}):(0,t.jsx)(R.Eye,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(I.Label,{htmlFor:"newPassword",children:["رمز عبور جدید ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(M.Input,{id:"newPassword",type:y?"text":"password",placeholder:"رمز عبور جدید را وارد کنید (حداقل 6 کاراکتر)",value:m,onChange:e=>p(e.target.value),disabled:K,className:"pr-10",minLength:6}),(0,t.jsx)(x.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>j(!y),disabled:K,children:y?(0,t.jsx)(L.EyeOff,{className:"h-4 w-4"}):(0,t.jsx)(R.Eye,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(I.Label,{htmlFor:"confirmPassword",children:["تأیید رمز عبور جدید ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(M.Input,{id:"confirmPassword",type:O?"text":"password",placeholder:"رمز عبور جدید را دوباره وارد کنید",value:h,onChange:e=>f(e.target.value),disabled:K,className:"pr-10"}),(0,t.jsx)(x.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>B(!O),disabled:K,children:O?(0,t.jsx)(L.EyeOff,{className:"h-4 w-4"}):(0,t.jsx)(R.Eye,{className:"h-4 w-4"})})]}),h&&m!==h&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:"رمز عبور جدید و تأیید آن مطابقت ندارند"}),h&&m===h&&m.length>=6&&(0,t.jsxs)("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[(0,t.jsx)(A.CheckCircle2,{className:"h-4 w-4"}),"رمز عبور جدید معتبر است"]})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,t.jsx)(x.Button,{type:"button",variant:"outline",className:"flex-1",onClick:()=>{d(!1),u(""),p(""),f("")},disabled:K,children:"انصراف"}),(0,t.jsx)(x.Button,{type:"submit",className:"flex-1",disabled:K||!m||m!==h||m.length<6,children:K?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"در حال تغییر..."]}):"تغییر رمز عبور"})]})]})]})})]})}var B=e.i(24327),K=e.i(36361),z=e.i(60366),U=e.i(81947),$=e.i(94179),V=e.i(78894),X=e.i(61659),_=e.i(73375);function W(){let{suppliers:e}=(0,B.useSupplierStore)(),{products:s}=(0,K.useProductStore)(),{orders:a}=(0,z.useOrderStore)(),[n,i]=(0,g.useState)(new Set),d=(0,g.useMemo)(()=>{let t=[],r=new Date;r.setDate(r.getDate()+2),r.setHours(23,59,59,999);let n=new Date;n.setHours(0,0,0,0);let i=[];e.forEach(e=>{e.transactions?.forEach(t=>{if("check"===t.paymentMethod&&t.checkDetails){let s=new Date(t.checkDetails.dueDate);s.setHours(0,0,0,0),s>=n&&s<=r&&i.push({supplierName:e.name,checkNumber:t.checkDetails.checkNumber,dueDate:t.checkDetails.dueDate,amount:t.totalAmount})}})}),i.length>0&&t.push({id:"upcoming-checks",type:"check",title:"چک‌های نزدیک به سررسید",description:`${i.length} چک در 2 روز آینده سررسید می‌شود`,count:i.length,link:"/admin/suppliers",severity:"high"});let o=s.filter(e=>e.stockCount<=10);o.length>0&&t.push({id:"low-stock",type:"lowStock",title:"موجودی کم",description:`${o.length} محصول موجودی کم دارد`,count:o.length,link:"/admin/products",severity:"high"});let l=new Date;l.setHours(l.getHours()-24);let d=a.filter(e=>new Date(e.createdAt)>=l&&"cancelled"!==e.status);return d.length>0&&t.push({id:"new-orders",type:"newOrder",title:"سفارش‌های جدید",description:`${d.length} سفارش جدید در 24 ساعت گذشته`,count:d.length,link:"/admin/orders",severity:"medium"}),t},[e,s,a]).filter(e=>!n.has(e.id));return 0===d.length?null:(0,t.jsx)("div",{className:"border-b border-border/30 bg-background/95 backdrop-blur",children:(0,t.jsx)("div",{className:"px-4 lg:px-6 py-3 space-y-2",children:d.map(e=>{var s;return(0,t.jsxs)(U.Alert,{variant:(s=e.severity,"check"===e.type?"warning":"high"===s?"destructive":"default"),className:"flex items-center justify-between gap-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(e=>{switch(e){case"check":return(0,t.jsx)(X.CreditCard,{className:"h-5 w-5"});case"lowStock":return(0,t.jsx)(o.Package,{className:"h-5 w-5"});case"newOrder":return(0,t.jsx)(l.ShoppingCart,{className:"h-5 w-5"});default:return(0,t.jsx)(V.AlertTriangle,{className:"h-5 w-5"})}})(e.type)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)(U.AlertTitle,{className:"flex items-center gap-2 mb-1",children:[e.title,(0,t.jsx)($.Badge,{variant:"secondary",className:"text-xs",children:e.count})]}),(0,t.jsx)(U.AlertDescription,{children:e.description})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.link&&(0,t.jsx)(x.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)(r.default,{href:e.link,children:["مشاهده",(0,t.jsx)(_.ChevronLeft,{className:"h-4 w-4 mr-1"})]})}),(0,t.jsx)(x.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{i(t=>new Set(t).add(e.id))},children:(0,t.jsx)(m.X,{className:"h-4 w-4"})})]})]},e.id)})})})}var q=e.i(74080),Y=e.i(81140),G=e.i(20783),J=e.i(75830),Q=e.i(30030),Z=e.i(26330),ee=e.i(74606),et=e.i(96626),er=e.i(48425),es=e.i(30207),ea=e.i(69340),en=e.i(34620),ei=e.i(59411),eo="ToastProvider",[el,ed,ec]=(0,J.createCollection)("Toast"),[eu,em]=(0,Q.createContextScope)("Toast",[ec]),[ep,eh]=eu(eo),ef=e=>{let{__scopeToast:r,label:s="Notification",duration:a=5e3,swipeDirection:n="right",swipeThreshold:i=50,children:o}=e,[l,d]=g.useState(null),[c,u]=g.useState(0),m=g.useRef(!1),p=g.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${eo}\`. Expected non-empty \`string\`.`),(0,t.jsx)(el.Provider,{scope:r,children:(0,t.jsx)(ep,{scope:r,label:s,duration:a,swipeDirection:n,swipeThreshold:i,toastCount:c,viewport:l,onViewportChange:d,onToastAdd:g.useCallback(()=>u(e=>e+1),[]),onToastRemove:g.useCallback(()=>u(e=>e-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:p,children:o})})};ef.displayName=eo;var ex="ToastViewport",ev=["F8"],ew="toast.viewportPause",eg="toast.viewportResume",ey=g.forwardRef((e,r)=>{let{__scopeToast:s,hotkey:a=ev,label:n="Notifications ({hotkey})",...i}=e,o=eh(ex,s),l=ed(s),d=g.useRef(null),c=g.useRef(null),u=g.useRef(null),m=g.useRef(null),p=(0,G.useComposedRefs)(r,m,o.onViewportChange),h=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),f=o.toastCount>0;g.useEffect(()=>{let e=e=>{0!==a.length&&a.every(t=>e[t]||e.code===t)&&m.current?.focus()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a]),g.useEffect(()=>{let e=d.current,t=m.current;if(f&&e&&t){let r=()=>{if(!o.isClosePausedRef.current){let e=new CustomEvent(ew);t.dispatchEvent(e),o.isClosePausedRef.current=!0}},s=()=>{if(o.isClosePausedRef.current){let e=new CustomEvent(eg);t.dispatchEvent(e),o.isClosePausedRef.current=!1}},a=t=>{e.contains(t.relatedTarget)||s()},n=()=>{e.contains(document.activeElement)||s()};return e.addEventListener("focusin",r),e.addEventListener("focusout",a),e.addEventListener("pointermove",r),e.addEventListener("pointerleave",n),window.addEventListener("blur",r),window.addEventListener("focus",s),()=>{e.removeEventListener("focusin",r),e.removeEventListener("focusout",a),e.removeEventListener("pointermove",r),e.removeEventListener("pointerleave",n),window.removeEventListener("blur",r),window.removeEventListener("focus",s)}}},[f,o.isClosePausedRef]);let x=g.useCallback(({tabbingDirection:e})=>{let t=l().map(t=>{let r=t.ref.current,s=[r,...function(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}(r)];return"forwards"===e?s:s.reverse()});return("forwards"===e?t.reverse():t).flat()},[l]);return g.useEffect(()=>{let e=m.current;if(e){let t=t=>{let r=t.altKey||t.ctrlKey||t.metaKey;if("Tab"===t.key&&!r){let r=document.activeElement,s=t.shiftKey;if(t.target===e&&s)return void c.current?.focus();let a=x({tabbingDirection:s?"backwards":"forwards"}),n=a.findIndex(e=>e===r);eO(a.slice(n+1))?t.preventDefault():s?c.current?.focus():u.current?.focus()}};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)}},[l,x]),(0,t.jsxs)(Z.Branch,{ref:d,role:"region","aria-label":n.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:f?void 0:"none"},children:[f&&(0,t.jsx)(eb,{ref:c,onFocusFromOutsideViewport:()=>{eO(x({tabbingDirection:"forwards"}))}}),(0,t.jsx)(el.Slot,{scope:s,children:(0,t.jsx)(er.Primitive.ol,{tabIndex:-1,...i,ref:p})}),f&&(0,t.jsx)(eb,{ref:u,onFocusFromOutsideViewport:()=>{eO(x({tabbingDirection:"backwards"}))}})]})});ey.displayName=ex;var ej="ToastFocusProxy",eb=g.forwardRef((e,r)=>{let{__scopeToast:s,onFocusFromOutsideViewport:a,...n}=e,i=eh(ej,s);return(0,t.jsx)(ei.VisuallyHidden,{tabIndex:0,...n,ref:r,style:{position:"fixed"},onFocus:e=>{let t=e.relatedTarget;i.viewport?.contains(t)||a()}})});eb.displayName=ej;var eN="Toast",eE=g.forwardRef((e,r)=>{let{forceMount:s,open:a,defaultOpen:n,onOpenChange:i,...o}=e,[l,d]=(0,ea.useControllableState)({prop:a,defaultProp:n??!0,onChange:i,caller:eN});return(0,t.jsx)(et.Presence,{present:s||l,children:(0,t.jsx)(eT,{open:l,...o,ref:r,onClose:()=>d(!1),onPause:(0,es.useCallbackRef)(e.onPause),onResume:(0,es.useCallbackRef)(e.onResume),onSwipeStart:(0,Y.composeEventHandlers)(e.onSwipeStart,e=>{e.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:(0,Y.composeEventHandlers)(e.onSwipeMove,e=>{let{x:t,y:r}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${r}px`)}),onSwipeCancel:(0,Y.composeEventHandlers)(e.onSwipeCancel,e=>{e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:(0,Y.composeEventHandlers)(e.onSwipeEnd,e=>{let{x:t,y:r}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${t}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${r}px`),d(!1)})})})});eE.displayName=eN;var[eC,ek]=eu(eN,{onClose(){}}),eT=g.forwardRef((e,r)=>{let{__scopeToast:s,type:a="foreground",duration:n,open:i,onClose:o,onEscapeKeyDown:l,onPause:d,onResume:c,onSwipeStart:u,onSwipeMove:m,onSwipeCancel:p,onSwipeEnd:h,...f}=e,x=eh(eN,s),[v,w]=g.useState(null),y=(0,G.useComposedRefs)(r,e=>w(e)),j=g.useRef(null),b=g.useRef(null),N=n||x.duration,E=g.useRef(0),C=g.useRef(N),k=g.useRef(0),{onToastAdd:T,onToastRemove:P}=x,S=(0,es.useCallbackRef)(()=>{v?.contains(document.activeElement)&&x.viewport?.focus(),o()}),D=g.useCallback(e=>{e&&e!==1/0&&(window.clearTimeout(k.current),E.current=new Date().getTime(),k.current=window.setTimeout(S,e))},[S]);g.useEffect(()=>{let e=x.viewport;if(e){let t=()=>{D(C.current),c?.()},r=()=>{let e=new Date().getTime()-E.current;C.current=C.current-e,window.clearTimeout(k.current),d?.()};return e.addEventListener(ew,r),e.addEventListener(eg,t),()=>{e.removeEventListener(ew,r),e.removeEventListener(eg,t)}}},[x.viewport,N,d,c,D]),g.useEffect(()=>{i&&!x.isClosePausedRef.current&&D(N)},[i,N,x.isClosePausedRef,D]),g.useEffect(()=>(T(),()=>P()),[T,P]);let R=g.useMemo(()=>v?function e(t){let r=[];return Array.from(t.childNodes).forEach(t=>{var s;if(t.nodeType===t.TEXT_NODE&&t.textContent&&r.push(t.textContent),(s=t).nodeType===s.ELEMENT_NODE){let s=t.ariaHidden||t.hidden||"none"===t.style.display,a=""===t.dataset.radixToastAnnounceExclude;if(!s)if(a){let e=t.dataset.radixToastAnnounceAlt;e&&r.push(e)}else r.push(...e(t))}}),r}(v):null,[v]);return x.viewport?(0,t.jsxs)(t.Fragment,{children:[R&&(0,t.jsx)(eP,{__scopeToast:s,role:"status","aria-live":"foreground"===a?"assertive":"polite",children:R}),(0,t.jsx)(eC,{scope:s,onClose:S,children:q.createPortal((0,t.jsx)(el.ItemSlot,{scope:s,children:(0,t.jsx)(Z.Root,{asChild:!0,onEscapeKeyDown:(0,Y.composeEventHandlers)(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||S(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:(0,t.jsx)(er.Primitive.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...f,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:(0,Y.composeEventHandlers)(e.onKeyDown,e=>{"Escape"===e.key&&(l?.(e.nativeEvent),e.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,S()))}),onPointerDown:(0,Y.composeEventHandlers)(e.onPointerDown,e=>{0===e.button&&(j.current={x:e.clientX,y:e.clientY})}),onPointerMove:(0,Y.composeEventHandlers)(e.onPointerMove,e=>{if(!j.current)return;let t=e.clientX-j.current.x,r=e.clientY-j.current.y,s=!!b.current,a=["left","right"].includes(x.swipeDirection),n=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,i=a?n(0,t):0,o=a?0:n(0,r),l="touch"===e.pointerType?10:2,d={x:i,y:o},c={originalEvent:e,delta:d};s?(b.current=d,eI("toast.swipeMove",m,c,{discrete:!1})):eH(d,x.swipeDirection,l)?(b.current=d,eI("toast.swipeStart",u,c,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(t)>l||Math.abs(r)>l)&&(j.current=null)}),onPointerUp:(0,Y.composeEventHandlers)(e.onPointerUp,e=>{let t=b.current,r=e.target;if(r.hasPointerCapture(e.pointerId)&&r.releasePointerCapture(e.pointerId),b.current=null,j.current=null,t){let r=e.currentTarget,s={originalEvent:e,delta:t};eH(t,x.swipeDirection,x.swipeThreshold)?eI("toast.swipeEnd",h,s,{discrete:!0}):eI("toast.swipeCancel",p,s,{discrete:!0}),r.addEventListener("click",e=>e.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),eP=e=>{let{__scopeToast:r,children:s,...a}=e,n=eh(eN,r),[i,o]=g.useState(!1),[l,d]=g.useState(!1);return function(e=()=>{}){let t=(0,es.useCallbackRef)(e);(0,en.useLayoutEffect)(()=>{let e=0,r=0;return e=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(e),window.cancelAnimationFrame(r)}},[t])}(()=>o(!0)),g.useEffect(()=>{let e=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(e)},[]),l?null:(0,t.jsx)(ee.Portal,{asChild:!0,children:(0,t.jsx)(ei.VisuallyHidden,{...a,children:i&&(0,t.jsxs)(t.Fragment,{children:[n.label," ",s]})})})},eS=g.forwardRef((e,r)=>{let{__scopeToast:s,...a}=e;return(0,t.jsx)(er.Primitive.div,{...a,ref:r})});eS.displayName="ToastTitle";var eD=g.forwardRef((e,r)=>{let{__scopeToast:s,...a}=e;return(0,t.jsx)(er.Primitive.div,{...a,ref:r})});eD.displayName="ToastDescription";var eR="ToastAction",eL=g.forwardRef((e,r)=>{let{altText:s,...a}=e;return s.trim()?(0,t.jsx)(eM,{altText:s,asChild:!0,children:(0,t.jsx)(eF,{...a,ref:r})}):(console.error(`Invalid prop \`altText\` supplied to \`${eR}\`. Expected non-empty \`string\`.`),null)});eL.displayName=eR;var eA="ToastClose",eF=g.forwardRef((e,r)=>{let{__scopeToast:s,...a}=e,n=ek(eA,s);return(0,t.jsx)(eM,{asChild:!0,children:(0,t.jsx)(er.Primitive.button,{type:"button",...a,ref:r,onClick:(0,Y.composeEventHandlers)(e.onClick,n.onClose)})})});eF.displayName=eA;var eM=g.forwardRef((e,r)=>{let{__scopeToast:s,altText:a,...n}=e;return(0,t.jsx)(er.Primitive.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...n,ref:r})});function eI(e,t,r,{discrete:s}){let a=r.originalEvent.currentTarget,n=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),s?(0,er.dispatchDiscreteCustomEvent)(a,n):a.dispatchEvent(n)}var eH=(e,t,r=0)=>{let s=Math.abs(e.x),a=Math.abs(e.y),n=s>a;return"left"===t||"right"===t?n&&s>r:!n&&a>r};function eO(e){let t=document.activeElement;return e.some(e=>e===t||(e.focus(),document.activeElement!==t))}var eB=e.i(25913);let eK=g.forwardRef(({className:e,...r},s)=>(0,t.jsx)(ey,{ref:s,className:(0,a.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...r}));eK.displayName=ey.displayName;let ez=(0,eB.cva)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 space-x-reverse overflow-hidden rounded-md border-[0.25px] border-border/30 glass-morphism p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-right-full",{variants:{variant:{default:"border text-foreground",destructive:"destructive group border-destructive bg-destructive/90 backdrop-blur-md text-destructive-foreground"}},defaultVariants:{variant:"default"}}),eU=g.forwardRef(({className:e,variant:r,...s},n)=>(0,t.jsx)(eE,{ref:n,className:(0,a.cn)(ez({variant:r}),e),...s}));eU.displayName=eE.displayName,g.forwardRef(({className:e,...r},s)=>(0,t.jsx)(eL,{ref:s,className:(0,a.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border-[0.25px] border-border/30 bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...r})).displayName=eL.displayName;let e$=g.forwardRef(({className:e,...r},s)=>(0,t.jsx)(eF,{ref:s,className:(0,a.cn)("absolute left-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...r,children:(0,t.jsx)(m.X,{className:"h-4 w-4"})}));e$.displayName=eF.displayName;let eV=g.forwardRef(({className:e,...r},s)=>(0,t.jsx)(eS,{ref:s,className:(0,a.cn)("text-sm font-semibold",e),...r}));eV.displayName=eS.displayName;let eX=g.forwardRef(({className:e,...r},s)=>(0,t.jsx)(eD,{ref:s,className:(0,a.cn)("text-sm opacity-90",e),...r}));function e_(){let{toasts:e}=(0,H.useToast)();return(0,t.jsxs)(ef,{children:[e.map(function({id:e,title:r,description:s,action:a,...n}){return(0,t.jsxs)(eU,{...n,children:[(0,t.jsxs)("div",{className:"grid gap-1",children:[r&&(0,t.jsx)(eV,{children:r}),s&&(0,t.jsx)(eX,{children:s})]}),a,(0,t.jsx)(e$,{})]},e)}),(0,t.jsx)(eK,{})]})}eX.displayName=eD.displayName;var eW=e.i(38808),eq=e.i(73860);function eY(){return(0,g.useEffect)(()=>(console.log("[AdminChatPolling] Component mounted, starting polling..."),()=>{console.log("[AdminChatPolling] Component unmounted, stopping polling...")}),[]),(0,eq.useGlobalChatPolling)({isUser:!1,onNewMessage:(e,t)=>{console.log("[AdminChatPolling] New message received:",e,t)}}),null}e.i(12012);var eG=e.i(73306),eJ=e.i(93226);function eQ({children:e}){let r=(0,s.useRouter)(),a=(0,s.usePathname)(),{user:n,isAuthenticated:i,hasCheckedAuth:o,checkAuth:l}=(0,eJ.useAuthStore)(),[d,c]=(0,g.useState)(!0);return((0,g.useEffect)(()=>{if("/admin/login"===a)return void c(!1);if(o){if(!i||n?.role!=="admin")return void r.push("/admin/login");c(!1)}},[a,o,i,n,r]),(0,g.useEffect)(()=>{let e=document.body.style.overflow,t=document.body.style.height,r=document.documentElement.style.overflow,s=document.documentElement.style.height;return document.body.style.overflow="hidden",document.body.style.height="100vh",document.documentElement.style.overflow="hidden",document.documentElement.style.height="100vh",()=>{document.body.style.overflow=e,document.body.style.height=t,document.documentElement.style.overflow=r,document.documentElement.style.height=s}},[]),d&&"/admin/login"!==a)?(0,t.jsx)("div",{className:"h-screen w-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(F.Loader2,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"در حال بررسی دسترسی..."})]})}):"/admin/login"===a?(0,t.jsx)(t.Fragment,{children:e}):(0,t.jsx)(eW.ErrorBoundary,{children:(0,t.jsxs)("div",{className:"h-screen w-screen flex overflow-hidden",children:[(0,t.jsx)(j,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:[(0,t.jsx)(O,{}),(0,t.jsx)(W,{}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 lg:p-6",children:e})]}),(0,t.jsx)(e_,{}),(0,t.jsx)(eY,{}),(0,t.jsx)(eG.NotificationCenter,{position:"top-right",maxNotifications:5})]})})}e.s(["default",()=>eQ],8374)}]);