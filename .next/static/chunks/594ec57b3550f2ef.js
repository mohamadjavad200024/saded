(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,60366,e=>{"use strict";var t=e.i(6344),r=e.i(73493);let a={},s=(0,t.create)((t,s)=>({orders:[],filters:a,isLoading:!1,setOrders:e=>t({orders:e}),addOrder:e=>t(t=>{let r=t.orders.findIndex(t=>t.id===e.id);if(r>=0){let a=[...t.orders];return a[r]=e,{orders:a}}return{orders:[...t.orders,e]}}),updateOrder:(e,r)=>t(t=>{let a=t.orders.findIndex(t=>t.id===e);if(a>=0){let e=[...t.orders];return e[a]={...e[a],...r},{orders:e}}return t}),updateOrderStatus:(e,r)=>t(t=>({orders:t.orders.map(t=>t.id===e?{...t,status:r,updatedAt:new Date}:t)})),updatePaymentStatus:(e,r)=>t(t=>({orders:t.orders.map(t=>t.id===e?{...t,paymentStatus:r,updatedAt:new Date}:t)})),deleteOrder:e=>t(t=>({orders:t.orders.filter(t=>t.id!==e)})),getOrder:e=>s().orders.find(t=>t.id===e),setFilters:e=>t(t=>({filters:{...t.filters,...e}})),clearFilters:()=>t({filters:a}),loadOrdersFromDB:async()=>{t({isLoading:!0});try{let a=new AbortController,s=setTimeout(()=>a.abort(),15e3),{fetchWithAuth:i}=await e.A(91079);r.logger.debug("Loading orders from database...");let o=await i("/api/orders",{signal:a.signal,credentials:"include"});if(clearTimeout(s),o.ok){let e;try{e=await o.json()}catch(e){r.logger.error("Error parsing orders response:",e),t({orders:[],isLoading:!1});return}if(e.success&&e.data)try{let a=e.data.map(e=>{let t=[],a={};try{t=Array.isArray(e.items)?e.items:"string"==typeof e.items?JSON.parse(e.items):[]}catch(a){r.logger.warn("Error parsing items for order:",e.id,a),t=[]}try{a="object"==typeof e.shippingAddress&&null!==e.shippingAddress?e.shippingAddress:"string"==typeof e.shippingAddress?JSON.parse(e.shippingAddress):{}}catch(t){r.logger.warn("Error parsing shippingAddress for order:",e.id,t),a={}}return{...e,items:t,shippingAddress:a,total:Number(e.total)||0,shippingCost:Number(e.shippingCost)||0,createdAt:e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),updatedAt:e.updatedAt instanceof Date?e.updatedAt:new Date(e.updatedAt)}});r.logger.info(`✅ Loaded ${a.length} orders from database`),t({orders:a,isLoading:!1})}catch(e){r.logger.error("Error parsing orders data:",e),t({orders:[],isLoading:!1})}else r.logger.info("No orders found in database"),t({orders:[],isLoading:!1})}else{let e=await o.text().catch(()=>"Unknown error");r.logger.error(`Failed to load orders: ${o.status} - ${e}`),t({orders:[],isLoading:!1})}}catch(e){e instanceof Error&&"AbortError"!==e.name&&r.logger.error("Error loading orders from DB:",e),t({orders:[],isLoading:!1})}}}));e.s(["useOrderStore",0,s])},10708,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(74080);var a=e.i(91918),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let i=(0,a.createSlot)(`Primitive.${s}`),o=r.forwardRef((e,r)=>{let{asChild:a,...o}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(a?i:s,{...o,ref:r})});return o.displayName=`Primitive.${s}`,{...e,[s]:o}},{}),i=r.forwardRef((e,r)=>(0,t.jsx)(s.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var o=e.i(25913),l=e.i(47163);let d=(0,o.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),n=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)(i,{ref:a,className:(0,l.cn)(d(),e),...r}));n.displayName=i.displayName,e.s(["Label",()=>n],10708)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},84762,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(47163);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border-[0.25px] border-input/30 bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));s.displayName="Textarea",e.s(["Textarea",()=>s])},69638,e=>{"use strict";let t=(0,e.i(75254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},95468,e=>{"use strict";let t=(0,e.i(75254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],95468)},73884,e=>{"use strict";let t=(0,e.i(75254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],73884)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],27612)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},70065,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(47163);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",e),...r}));s.displayName="Card";let i=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...r}));i.displayName="CardHeader";let o=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));o.displayName="CardTitle";let l=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",e),...r}));l.displayName="CardDescription";let d=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",e),...r}));d.displayName="CardContent",r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>d,"CardDescription",()=>l,"CardHeader",()=>i,"CardTitle",()=>o])},20682,e=>{"use strict";var t=e.i(71645);let r=0,a=new Map,s=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=[],o={toasts:[]};function l(e){o=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?s(r):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(o,e),i.forEach(e=>{e(o)})}function d({...e}){let t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>l({type:"DISMISS_TOAST",toastId:t});return l({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function n(){let[e,r]=t.useState(o);return t.useEffect(()=>(i.push(r),()=>{let e=i.indexOf(r);e>-1&&i.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}e.s(["useToast",()=>n])},36361,e=>{"use strict";var t=e.i(6344),r=e.i(73493);let a={},s=(0,t.create)((e,t)=>({products:[],filters:a,setProducts:t=>e({products:t}),addProduct:t=>e(e=>{let r=e.products.findIndex(e=>e.id===t.id);if(r>=0){let a=[...e.products];return a[r]=t,{products:a}}return{products:[...e.products,t]}}),updateProduct:t=>e(e=>{let r=e.products.findIndex(e=>e.id===t.id);if(r>=0){let a=[...e.products];return a[r]=t,{products:a}}return e}),removeProduct:t=>e(e=>({products:e.products.filter(e=>e.id!==t)})),getProduct:e=>t().products.find(t=>t.id===e),getEnabledProducts:()=>t().products.filter(e=>e.enabled),getFilteredProducts:()=>{let{products:e,filters:r}=t(),a=e.filter(e=>e.enabled);if(r.search){let e=r.search.toLowerCase();a=a.filter(t=>t.name.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e)||t.brand?.toLowerCase().includes(e))}return void 0!==r.minPrice&&(a=a.filter(e=>e.price>=r.minPrice)),void 0!==r.maxPrice&&(a=a.filter(e=>e.price<=r.maxPrice)),r.brands&&r.brands.length>0&&(a=a.filter(e=>e.brand&&r.brands.includes(e.brand))),r.categories&&r.categories.length>0&&(a=a.filter(e=>e.category&&r.categories.includes(e.category))),void 0!==r.inStock&&(a=a.filter(e=>e.inStock===r.inStock)),a},setFilters:t=>e(e=>({filters:{...e.filters,...t}})),clearFilters:()=>e({filters:a}),createProduct:async e=>{let r=await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error((await r.json().catch(()=>({}))).message||"خطا در ایجاد محصول");let a=(await r.json()).data;return t().addProduct(a),a},updateProductInDB:async(e,r)=>{let a=await fetch(`/api/products/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).message||"خطا در به‌روزرسانی محصول");let s=(await a.json()).data;return t().updateProduct(s),s},deleteProductFromDB:async e=>{let r=await fetch(`/api/products/${e}`,{method:"DELETE"});if(!r.ok)throw Error((await r.json().catch(()=>({}))).message||"خطا در حذف محصول");t().removeProduct(e)},loadProductsFromDB:async(e=!1)=>{try{let r=await fetch(e?"/api/products?limit=1000&all=true":"/api/products?limit=1000");if(!r.ok){let e=await r.json().catch(()=>({})),t=e.error||e.message||"خطا در بارگذاری محصولات";throw Error(t)}let a=((await r.json()).data||[]).map(e=>({...e,createdAt:e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),updatedAt:e.updatedAt instanceof Date?e.updatedAt:new Date(e.updatedAt)}));t().setProducts(a)}catch(e){r.logger.error("Error loading products from DB:",e)}},deleteProduct:async e=>{await t().deleteProductFromDB(e)},deleteProducts:async e=>{await Promise.all(e.map(e=>t().deleteProductFromDB(e)))},toggleProduct:async e=>{let r=t().getProduct(e);r&&await t().updateProductInDB(e,{enabled:!r.enabled})},toggleProducts:async(e,r)=>{await Promise.all(e.map(e=>t().updateProductInDB(e,{enabled:r})))}}));e.s(["useProductStore",0,s])},87316,e=>{"use strict";let t=(0,e.i(75254).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},15788,e=>{"use strict";let t=(0,e.i(75254).default)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>t],15788)},78583,e=>{"use strict";let t=(0,e.i(75254).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],78583)},73708,e=>{"use strict";let t=(0,e.i(75254).default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["Image",()=>t],73708)},46897,e=>{"use strict";let t=(0,e.i(75254).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>t],46897)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},27651,e=>{"use strict";var t=e.i(71645),r=e.i(73493);function a({adminId:e="admin-1",enabled:s=!0,heartbeatInterval:i=15e3}={}){let[o,l]=(0,t.useState)(!1),[d,n]=(0,t.useState)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(!0),p=(0,t.useCallback)(async()=>{if(s&&u.current)try{let t=await fetch(`/api/admin/presence?adminId=${e}`);if(!t.ok){let a=`Failed to check admin status (${t.status})`;try{let e=await t.json();e.error&&(a=`Failed to check admin status: ${e.error}`)}catch{}r.logger.error(a,{status:t.status,adminId:e});return}let a=await t.json();a.success&&a.data?(l(a.data.isOnline||!1),n(a.data.lastSeen||null)):a.success||r.logger.error("Failed to check admin status:",a.error||"Unknown error",{adminId:e})}catch(t){r.logger.error("Error checking admin status:",t,{adminId:e})}},[e,s]),m=(0,t.useCallback)(async t=>{if(s&&u.current)try{let a=await fetch("/api/admin/presence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminId:e,isOnline:t})});if(!a.ok){let t=`Failed to update admin status (${a.status})`;try{let e=await a.json();e.error&&(t=`Failed to update admin status: ${e.error}`)}catch{}r.logger.error(t,{status:a.status,adminId:e});return}let s=await a.json();s.success&&s.data?(l(s.data.isOnline||!1),n(s.data.lastSeen||null)):s.success||r.logger.error("Failed to update admin status:",s.error||"Unknown error",{adminId:e})}catch(t){r.logger.error("Error updating admin status:",t,{adminId:e})}},[e,s]);return(0,t.useEffect)(()=>{s&&p()},[s,p]),(0,t.useEffect)(()=>{if(!s||!o){c.current&&(clearInterval(c.current),c.current=null);return}return m(!0),c.current=setInterval(()=>{u.current&&m(!0)},i),()=>{c.current&&(clearInterval(c.current),c.current=null)}},[s,o,i,m]),(0,t.useEffect)(()=>()=>{u.current=!1,c.current&&(clearInterval(c.current),c.current=null),s&&m(!1).catch(e=>r.logger.error("Error setting offline status:",e))},[s,m]),{isOnline:o,lastSeen:d,checkStatus:p,setOnline:m}}e.s(["useAdminPresence",()=>a])},94771,e=>{"use strict";let t=(0,e.i(75254).default)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);e.s(["CheckCheck",()=>t],94771)},29006,92930,23585,e=>{"use strict";var t=e.i(75254);let r=(0,t.default)("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);e.s(["Reply",()=>r],29006);let a=(0,t.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>a],92930);let s=(0,t.default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["MoreVertical",()=>s],23585)},87951,e=>{"use strict";let t=(0,e.i(75254).default)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);e.s(["Mic",()=>t],87951)},26428,e=>{"use strict";var t=e.i(43476),r=e.i(46932);function a({className:e}){return(0,t.jsxs)(r.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:`flex items-center gap-2 px-5 py-3 bg-muted/60 rounded-2xl shadow-sm border border-border/30 ${e||""}`,children:[(0,t.jsx)(r.motion.div,{className:"w-2.5 h-2.5 bg-muted-foreground/70 rounded-full",animate:{y:[0,-6,0]},transition:{duration:.6,repeat:1/0,delay:0}}),(0,t.jsx)(r.motion.div,{className:"w-2.5 h-2.5 bg-muted-foreground/70 rounded-full",animate:{y:[0,-6,0]},transition:{duration:.6,repeat:1/0,delay:.2}}),(0,t.jsx)(r.motion.div,{className:"w-2.5 h-2.5 bg-muted-foreground/70 rounded-full",animate:{y:[0,-6,0]},transition:{duration:.6,repeat:1/0,delay:.4}})]})}e.s(["TypingIndicator",()=>a])},82735,e=>{"use strict";let t=(0,e.i(75254).default)("Paperclip",[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]]);e.s(["Paperclip",()=>t],82735)},52044,95242,e=>{"use strict";var t=e.i(75254);let r=(0,t.default)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);e.s(["Square",()=>r],52044);let a=(0,t.default)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);e.s(["Pause",()=>a],95242)},73042,e=>{"use strict";var t=e.i(43476),r=e.i(46932),a=e.i(14683),s=e.i(47163);function i({isOnline:e,lastSeen:i,className:o,showText:l=!1}){return(0,t.jsxs)(r.motion.span,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:(0,s.cn)("inline-flex items-center gap-2",o),children:[(0,t.jsxs)("span",{className:"relative inline-flex items-center",children:[(0,t.jsx)(a.Circle,{className:(0,s.cn)("h-3 w-3",e?"fill-green-500 text-green-500":"fill-gray-400 text-gray-400")}),e&&(0,t.jsx)(r.motion.span,{className:"absolute inset-0 rounded-full bg-green-500 pointer-events-none",animate:{scale:[1,1.5,1],opacity:[1,0,1]},transition:{duration:2,repeat:1/0}})]}),l&&(0,t.jsx)("span",{className:(0,s.cn)("text-sm font-semibold leading-tight",e?"text-green-600 dark:text-green-400":"text-gray-500"),children:e?"آنلاین":i?`آخرین بازدید: ${(e=>{if(!e)return"هرگز";let t=new Date(e),r=new Date().getTime()-t.getTime(),a=Math.floor(r/6e4),s=Math.floor(r/36e5),i=Math.floor(r/864e5);return a<1?"همین الان":a<60?`${a} دقیقه پیش`:s<24?`${s} ساعت پیش`:i<7?`${i} روز پیش`:t.toLocaleDateString("fa-IR")})(i)}`:"آفلاین"})]})}e.s(["OnlineStatusBadge",()=>i])},22085,e=>{"use strict";var t=e.i(43476),r=e.i(46932),a=e.i(88653),s=e.i(67881),i=e.i(84762),o=e.i(14764),l=e.i(82735),d=e.i(46897),n=e.i(78583),c=e.i(37727),u=e.i(87951),p=e.i(52044),m=e.i(95242),h=e.i(31278),f=e.i(64659),g=e.i(73708);function x({message:e,setMessage:x,onMessageChange:y,attachments:v,setAttachments:w,onRemoveAttachment:k,showAttachmentOptions:b,setShowAttachmentOptions:j,onToggleAttachmentOptions:N,isRecording:C,recordingTime:P,audioUrl:T,isSaving:A,isSending:S,showScrollToBottom:M,showPermissionGuide:D,setShowPermissionGuide:E,textareaRef:O,imageInputRef:B,fileInputRef:I,typingTimeoutRef:z,handleSendMessage:F,onSend:L,handleFileSelect:R,onFileSelect:$,handleRemoveAttachment:q,onLocationShare:V,handleLocationShare:H,startRecording:_,onStartRecording:U,stopRecording:W,onStopRecording:X,saveRecording:J,onSaveRecording:K,cancelRecording:Z,onCancelRecording:G,sendTypingStatus:Q,scrollToBottom:Y,formatTime:ee,toast:et}){let er=x||(e=>{y&&y({target:{value:e}})}),ea=F||L||(()=>{}),es=R||$,ei=q||k,eo=H||V,el=_||U,ed=W||X,en=J||K,ec=j||(()=>{N&&N()});return(0,t.jsxs)("div",{className:"border-t border-border/40 bg-background p-2 sm:p-3 space-y-2 relative flex-shrink-0",children:[(0,t.jsx)(a.AnimatePresence,{children:M&&(0,t.jsx)(r.motion.div,{initial:{opacity:0,y:10,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.9},className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-10",children:(0,t.jsx)(s.Button,{onClick:()=>{Y&&Y(!1)},size:"icon",className:"h-9 w-9 rounded-full shadow-lg hover:shadow-xl bg-primary text-primary-foreground hover:bg-primary/90 transition-all",title:"برو به آخرین پیام",children:(0,t.jsx)(f.ChevronDown,{className:"h-4 w-4"})})})}),D&&(0,t.jsx)(r.motion.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"p-3 bg-destructive/5 border-2 border-destructive/20 rounded-xl shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(u.Mic,{className:"h-3.5 w-3.5 text-destructive mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-destructive mb-1.5 leading-tight",children:"دسترسی میکروفون نیاز است"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"لطفاً در تنظیمات مرورگر دسترسی میکروفون را فعال کنید"})]}),(0,t.jsx)("button",{onClick:()=>{E&&E(!1)},className:"p-0.5 rounded hover:bg-destructive/10 transition-colors flex-shrink-0",children:(0,t.jsx)(c.X,{className:"h-3 w-3 text-destructive"})})]})}),(C||T)&&(0,t.jsx)(r.motion.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"flex items-center gap-2 p-2 bg-destructive/10 border border-destructive/30 rounded-lg",children:C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.motion.div,{animate:{scale:[1,1.1,1]},transition:{repeat:1/0,duration:1},className:"p-1.5 rounded-full bg-destructive/20",children:(0,t.jsx)(u.Mic,{className:"h-3.5 w-3.5 text-destructive"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-destructive leading-tight",children:"در حال ضبط"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground font-mono",children:ee(P)})]}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:ed,className:"h-7 w-7 text-destructive hover:bg-destructive/10 rounded-lg",children:(0,t.jsx)(p.Square,{className:"h-3 w-3 fill-current"})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"p-1.5 rounded-full bg-primary/20",children:(0,t.jsx)(u.Mic,{className:"h-3.5 w-3.5 text-primary"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-xs font-medium leading-tight",children:"پیام صوتی آماده است"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground font-mono",children:ee(P)})]}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:Z||G,className:"h-7 w-7 text-muted-foreground hover:text-destructive rounded-lg",children:(0,t.jsx)(c.X,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(s.Button,{onClick:async e=>{e.preventDefault(),e.stopPropagation(),console.log("[Voice Widget] Save button clicked!"),en&&await en()},size:"sm",className:"h-7 px-3 text-xs rounded-lg",title:"ذخیره و ارسال پیام صوتی",children:"ذخیره"})]})}),b&&(0,t.jsxs)(r.motion.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"flex gap-2 p-2 bg-card rounded-lg border border-border/50 shadow-lg",onClick:e=>{console.log("[Attachment Options Widget] Container clicked!",e.target)},children:[(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:()=>{B?.current?.click(),N?N():ec(!1)},className:"h-8 w-8 hover:bg-primary/10 hover:text-primary transition-all rounded-lg",children:(0,t.jsx)(g.Image,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:()=>{I?.current?.click(),N?N():ec(!1)},className:"h-8 w-8 hover:bg-primary/10 hover:text-primary transition-all rounded-lg",children:(0,t.jsx)(n.FileText,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log("[Location Widget] Button clicked!"),eo&&eo(),N?N():ec(!1)},className:"h-8 w-8 hover:bg-primary/10 hover:text-primary transition-all rounded-lg",title:"اشتراک‌گذاری موقعیت مکانی",children:(0,t.jsx)(d.MapPin,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:async e=>{if(e.preventDefault(),e.stopPropagation(),console.log("[Voice Widget] Button clicked!"),N?N():ec(!1),C)ed&&ed();else{et({title:"در حال درخواست دسترسی...",description:"لطفاً اجازه دسترسی به میکروفون را در مرورگر بدهید",duration:3e3});try{el&&await el()}catch(e){console.error("[Voice Widget] Error starting recording:",e)}}},title:"ضبط پیام صوتی",className:"h-8 w-8 hover:bg-primary/10 hover:text-primary transition-all rounded-lg",disabled:C,children:C?(0,t.jsx)(m.Pause,{className:"h-3.5 w-3.5 text-destructive"}):(0,t.jsx)(u.Mic,{className:"h-3.5 w-3.5"})})]}),(0,t.jsx)("input",{ref:B,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:e=>{es&&es(e,"image")}}),(0,t.jsx)("input",{ref:I,type:"file",multiple:!0,className:"hidden",onChange:e=>{es&&es(e,"file")}}),(0,t.jsx)("div",{className:"flex items-end gap-2",children:(0,t.jsxs)("div",{className:"flex-1 relative",children:[v.length>0&&(0,t.jsx)("div",{className:"absolute top-2 right-2 left-2 z-10 pointer-events-none overflow-hidden",children:(0,t.jsx)("div",{className:"overflow-x-auto overflow-y-hidden scroll-smooth w-full [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:(0,t.jsx)("div",{className:"flex items-center gap-1.5 flex-nowrap",children:v.map(e=>(0,t.jsxs)("div",{className:"relative group pointer-events-auto flex-shrink-0 w-auto",children:[(0,t.jsxs)("div",{className:"bg-card/95 backdrop-blur-sm rounded-md p-1 border border-border/40 shadow-sm",children:["image"===e.type&&e.url&&(0,t.jsx)("img",{src:e.url,alt:e.name||"تصویر",className:"w-10 h-10 object-cover rounded"}),"file"===e.type&&(0,t.jsxs)("div",{className:"flex items-center gap-1 px-1.5 py-1",children:[(0,t.jsx)(n.FileText,{className:"h-3 w-3 flex-shrink-0 text-primary"}),(0,t.jsx)("p",{className:"text-[10px] truncate max-w-[50px] font-medium leading-tight",children:e.name})]}),"location"===e.type&&(0,t.jsxs)("div",{className:"flex items-center gap-1 px-1.5 py-1",children:[(0,t.jsx)(d.MapPin,{className:"h-3 w-3 flex-shrink-0 text-primary"}),(0,t.jsx)("span",{className:"text-[10px] font-medium whitespace-nowrap leading-tight",children:"موقعیت"})]}),"audio"===e.type&&(0,t.jsxs)("div",{className:"flex items-center gap-1 px-1.5 py-1",children:[(0,t.jsx)(u.Mic,{className:"h-3 w-3 flex-shrink-0 text-primary"}),(0,t.jsx)("span",{className:"text-[10px] font-medium whitespace-nowrap leading-tight",children:e.duration?ee(e.duration):"صدا"})]})]}),(0,t.jsx)("button",{onClick:()=>{ei&&ei(e.id)},className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity shadow-sm z-20 hover:scale-110",children:(0,t.jsx)(c.X,{className:"h-2.5 w-2.5"})})]},e.id))})})}),(0,t.jsx)(i.Textarea,{ref:O,value:e,onChange:e=>{y?y(e):er(e.target.value),z?.current&&clearTimeout(z.current),Q&&e.target.value.trim().length>0?(Q(!0),z&&(z.current=setTimeout(()=>{Q(!1)},2e3))):Q&&Q(!1)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),z?.current&&clearTimeout(z.current),Q&&Q(!1),ea())},placeholder:"پیام خود را بنویسید...",className:`min-h-[44px] max-h-[100px] resize-none text-sm leading-relaxed rounded-lg border pr-20 pl-3 py-2 ${v.length>0?"pt-12":""}`}),(0,t.jsxs)("div",{className:"absolute bottom-2 right-2 flex items-center gap-1",children:[(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log("[Paperclip Widget] Button clicked! showAttachmentOptions:",!b),N?N():ec(!b)},className:`h-7 w-7 rounded-lg transition-all ${b?"bg-primary/10 text-primary":"hover:bg-muted/60 text-muted-foreground hover:text-foreground"}`,children:(0,t.jsx)(l.Paperclip,{className:"h-4 w-4"})}),!C&&(0,t.jsx)(t.Fragment,{children:A??S?(0,t.jsx)(h.Loader2,{className:"h-4 w-4 text-primary animate-spin"}):(0,t.jsx)(s.Button,{onClick:ea,size:"icon",className:"h-7 w-7 rounded-lg transition-all",children:(0,t.jsx)(o.Send,{className:"h-3.5 w-3.5"})})})]})]})})]})}e.s(["ChatInput",()=>x])},72664,e=>{"use strict";let t=(0,e.i(75254).default)("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);e.s(["Box",()=>t],72664)},91079,e=>{e.v(t=>Promise.all(["static/chunks/0212ee3e90afbd18.js"].map(t=>e.l(t))).then(()=>t(40171)))}]);