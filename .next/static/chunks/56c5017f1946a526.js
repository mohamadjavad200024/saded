(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10708,e=>{"use strict";var s=e.i(43476),t=e.i(71645);e.i(74080);var a=e.i(91918),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let i=(0,a.createSlot)(`Primitive.${r}`),l=t.forwardRef((e,t)=>{let{asChild:a,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(a?i:r,{...l,ref:t})});return l.displayName=`Primitive.${r}`,{...e,[r]:l}},{}),i=t.forwardRef((e,t)=>(0,s.jsx)(r.label,{...e,ref:t,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));i.displayName="Label";var l=e.i(25913),n=e.i(47163);let c=(0,l.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(i,{ref:a,className:(0,n.cn)(c(),e),...t}));d.displayName=i.displayName,e.s(["Label",()=>d],10708)},17513,e=>{"use strict";var s=e.i(6344),t=e.i(73493);let a=(0,s.create)((e,s)=>({categories:[],setCategories:s=>e({categories:s}),addCategory:s=>e(e=>{let t=e.categories.findIndex(e=>e.id===s.id);if(t>=0){let a=[...e.categories];return a[t]=s,{categories:a}}return{categories:[...e.categories,s]}}),updateCategory:s=>e(e=>{let t=e.categories.findIndex(e=>e.id===s.id);if(t>=0){let a=[...e.categories];return a[t]=s,{categories:a}}return e}),deleteCategory:s=>e(e=>({categories:e.categories.filter(e=>e.id!==s)})),toggleCategory:s=>e(e=>({categories:e.categories.map(e=>e.id===s?{...e,isActive:!e.isActive}:e)})),getCategory:e=>s().categories.find(s=>s.id===e),getActiveCategories:()=>s().categories.filter(e=>e.isActive&&e.enabled),getEnabledCategories:()=>s().categories.filter(e=>e.enabled),loadCategoriesFromDB:async(e=!1)=>{try{let t=await fetch(e?"/api/categories?all=true":"/api/categories");if(!t.ok)throw Error("خطا در بارگذاری دسته‌بندی‌ها");let a=(await t.json()).data||[];s().setCategories(a)}catch(e){t.logger.error("Error loading categories from DB:",e)}}}));e.s(["useCategoryStore",0,a])},70065,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(47163);let r=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",e),...t}));r.displayName="Card";let i=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let l=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let n=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));n.displayName="CardDescription";let c=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>c,"CardDescription",()=>n,"CardHeader",()=>i,"CardTitle",()=>l])},99682,e=>{"use strict";var s=e.i(71645);function t(e){let t=s.useRef({value:e,previous:e});return s.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}e.s(["usePrevious",()=>t])},19036,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(81140),r=e.i(20783),i=e.i(30030),l=e.i(69340),n=e.i(99682),c=e.i(35804),d=e.i(48425),o="Switch",[m,x]=(0,i.createContextScope)(o),[u,h]=m(o),p=t.forwardRef((e,i)=>{let{__scopeSwitch:n,name:c,checked:m,defaultChecked:x,required:h,disabled:p,value:j="on",onCheckedChange:g,form:b,...v}=e,[y,w]=t.useState(null),C=(0,r.useComposedRefs)(i,e=>w(e)),D=t.useRef(!1),k=!y||b||!!y.closest("form"),[T,S]=(0,l.useControllableState)({prop:m,defaultProp:x??!1,onChange:g,caller:o});return(0,s.jsxs)(u,{scope:n,checked:T,disabled:p,children:[(0,s.jsx)(d.Primitive.button,{type:"button",role:"switch","aria-checked":T,"aria-required":h,"data-state":N(T),"data-disabled":p?"":void 0,disabled:p,value:j,...v,ref:C,onClick:(0,a.composeEventHandlers)(e.onClick,e=>{S(e=>!e),k&&(D.current=e.isPropagationStopped(),D.current||e.stopPropagation())})}),k&&(0,s.jsx)(f,{control:y,bubbles:!D.current,name:c,value:j,checked:T,required:h,disabled:p,form:b,style:{transform:"translateX(-100%)"}})]})});p.displayName=o;var j="SwitchThumb",g=t.forwardRef((e,t)=>{let{__scopeSwitch:a,...r}=e,i=h(j,a);return(0,s.jsx)(d.Primitive.span,{"data-state":N(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:t})});g.displayName=j;var f=t.forwardRef(({__scopeSwitch:e,control:a,checked:i,bubbles:l=!0,...d},o)=>{let m=t.useRef(null),x=(0,r.useComposedRefs)(m,o),u=(0,n.usePrevious)(i),h=(0,c.useSize)(a);return t.useEffect(()=>{let e=m.current;if(!e)return;let s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(u!==i&&s){let t=new Event("click",{bubbles:l});s.call(e,i),e.dispatchEvent(t)}},[u,i,l]),(0,s.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...d,tabIndex:-1,ref:x,style:{...d.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function N(e){return e?"checked":"unchecked"}f.displayName="SwitchBubbleInput";var b=e.i(47163);let v=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(p,{className:(0,b.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:a,children:(0,s.jsx)(g,{className:(0,b.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));v.displayName=p.displayName,e.s(["Switch",()=>v],19036)},72520,e=>{"use strict";let s=(0,e.i(75254).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>s],72520)},12426,e=>{"use strict";let s=(0,e.i(75254).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],12426)},7233,e=>{"use strict";let s=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},88511,e=>{"use strict";let s=(0,e.i(75254).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>s],88511)},47627,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(47163);let r=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,a.cn)("w-full caption-bottom text-sm",e),...t})}));r.displayName="Table";let i=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("thead",{ref:r,className:(0,a.cn)("[&_tr]:border-b border-border/30",e),...t}));i.displayName="TableHeader";let l=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tbody",{ref:r,className:(0,a.cn)("[&_tr:last-child]:border-0",e),...t}));l.displayName="TableBody",t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tfoot",{ref:r,className:(0,a.cn)("border-t border-border/30 bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let n=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tr",{ref:r,className:(0,a.cn)("border-b border-border/30 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));n.displayName="TableRow";let c=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("th",{ref:r,className:(0,a.cn)("h-12 px-4 text-right align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableHead";let d=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("td",{ref:r,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));d.displayName="TableCell",t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("caption",{ref:r,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption",e.s(["Table",()=>r,"TableBody",()=>l,"TableCell",()=>d,"TableHead",()=>c,"TableHeader",()=>i,"TableRow",()=>n])},41071,e=>{"use strict";let s=(0,e.i(75254).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>s],41071)},27341,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(81140),r=e.i(30030),i=e.i(42727),l=e.i(96626),n=e.i(48425),c=e.i(86318),d=e.i(69340),o=e.i(10772),m="Tabs",[x,u]=(0,r.createContextScope)(m,[i.createRovingFocusGroupScope]),h=(0,i.createRovingFocusGroupScope)(),[p,j]=x(m),g=t.forwardRef((e,t)=>{let{__scopeTabs:a,value:r,onValueChange:i,defaultValue:l,orientation:x="horizontal",dir:u,activationMode:h="automatic",...j}=e,g=(0,c.useDirection)(u),[f,N]=(0,d.useControllableState)({prop:r,onChange:i,defaultProp:l??"",caller:m});return(0,s.jsx)(p,{scope:a,baseId:(0,o.useId)(),value:f,onValueChange:N,orientation:x,dir:g,activationMode:h,children:(0,s.jsx)(n.Primitive.div,{dir:g,"data-orientation":x,...j,ref:t})})});g.displayName=m;var f="TabsList",N=t.forwardRef((e,t)=>{let{__scopeTabs:a,loop:r=!0,...l}=e,c=j(f,a),d=h(a);return(0,s.jsx)(i.Root,{asChild:!0,...d,orientation:c.orientation,dir:c.dir,loop:r,children:(0,s.jsx)(n.Primitive.div,{role:"tablist","aria-orientation":c.orientation,...l,ref:t})})});N.displayName=f;var b="TabsTrigger",v=t.forwardRef((e,t)=>{let{__scopeTabs:r,value:l,disabled:c=!1,...d}=e,o=j(b,r),m=h(r),x=C(o.baseId,l),u=D(o.baseId,l),p=l===o.value;return(0,s.jsx)(i.Item,{asChild:!0,...m,focusable:!c,active:p,children:(0,s.jsx)(n.Primitive.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":u,"data-state":p?"active":"inactive","data-disabled":c?"":void 0,disabled:c,id:x,...d,ref:t,onMouseDown:(0,a.composeEventHandlers)(e.onMouseDown,e=>{c||0!==e.button||!1!==e.ctrlKey?e.preventDefault():o.onValueChange(l)}),onKeyDown:(0,a.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&o.onValueChange(l)}),onFocus:(0,a.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==o.activationMode;p||c||!e||o.onValueChange(l)})})})});v.displayName=b;var y="TabsContent",w=t.forwardRef((e,a)=>{let{__scopeTabs:r,value:i,forceMount:c,children:d,...o}=e,m=j(y,r),x=C(m.baseId,i),u=D(m.baseId,i),h=i===m.value,p=t.useRef(h);return t.useEffect(()=>{let e=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,s.jsx)(l.Presence,{present:c||h,children:({present:t})=>(0,s.jsx)(n.Primitive.div,{"data-state":h?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":x,hidden:!t,id:u,tabIndex:0,...o,ref:a,style:{...e.style,animationDuration:p.current?"0s":void 0},children:t&&d})})});function C(e,s){return`${e}-trigger-${s}`}function D(e,s){return`${e}-content-${s}`}w.displayName=y;var k=e.i(47163);let T=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(N,{ref:a,className:(0,k.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));T.displayName=N.displayName;let S=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(v,{ref:a,className:(0,k.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));S.displayName=v.displayName;let I=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(w,{ref:a,className:(0,k.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));I.displayName=w.displayName,e.s(["Tabs",()=>g,"TabsContent",()=>I,"TabsList",()=>T,"TabsTrigger",()=>S],27341)},10524,e=>{"use strict";var s=e.i(43476),t=e.i(53145),a=e.i(94814),r=e.i(65638),i=e.i(67881),l=e.i(23750),n=e.i(10708),c=e.i(84762),d=e.i(19036),o=e.i(70065),m=e.i(24327),x=e.i(17513),u=e.i(20682),h=e.i(18566),p=e.i(71645),j=e.i(37727),g=e.i(31278),f=e.i(43432),N=e.i(88844),b=e.i(94179),v=e.i(62870),y=e.i(30374),w=e.i(47627),C=e.i(36361),D=e.i(7233),k=e.i(27612),T=e.i(88511);function S({supplier:e,onUpdate:t}){let{products:a}=(0,C.useProductStore)(),{getActiveCategories:r}=(0,x.useCategoryStore)(),{toast:c}=(0,u.useToast)(),[d,o]=(0,p.useState)(!1),[m,h]=(0,p.useState)(null),[j,g]=(0,p.useState)(""),[f,N]=(0,p.useState)(0),[S,I]=(0,p.useState)(void 0),[R,P]=(0,p.useState)("all"),M=r(),H=e.products||[],A=(0,p.useMemo)(()=>{let s=a.filter(s=>s.category&&e.categories.includes(s.category));if("all"!==R&&(s=s.filter(e=>e.category===R)),!m){let e=H.map(e=>e.productId);s=s.filter(s=>!e.includes(s.id))}return s},[a,e.categories,R,H,m]),B=(0,p.useMemo)(()=>{let e={};return H.forEach(s=>{e[s.category]||(e[s.category]=[]),e[s.category].push(s)}),e},[H]);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"مدیریت محصولات"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"محصولات و تعداد موجودی که این تامین‌کننده می‌تواند تامین کند"})]}),(0,s.jsxs)(i.Button,{onClick:()=>o(!0),size:"sm",children:[(0,s.jsx)(D.Plus,{className:"ml-2 h-4 w-4"}),"افزودن محصول"]})]}),0===H.length?(0,s.jsx)("div",{className:"text-center py-8 border border-dashed rounded-lg",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"هیچ محصولی اضافه نشده است"})}):(0,s.jsx)("div",{className:"space-y-4",children:Object.entries(B).map(([e,a])=>(0,s.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-muted/50 px-4 py-2 border-b",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(b.Badge,{variant:"secondary",children:e}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.length," محصول - مجموع:"," ",new Intl.NumberFormat("fa-IR").format(a.reduce((e,s)=>e+s.quantity,0))," ","عدد"]})]})}),(0,s.jsxs)(w.Table,{children:[(0,s.jsx)(w.TableHeader,{children:(0,s.jsxs)(w.TableRow,{children:[(0,s.jsx)(w.TableHead,{children:"محصول"}),(0,s.jsx)(w.TableHead,{children:"تعداد"}),(0,s.jsx)(w.TableHead,{children:"قیمت واحد"}),(0,s.jsx)(w.TableHead,{className:"text-left",children:"عملیات"})]})}),(0,s.jsx)(w.TableBody,{children:a.map(e=>(0,s.jsxs)(w.TableRow,{children:[(0,s.jsx)(w.TableCell,{className:"font-medium",children:e.productName}),(0,s.jsxs)(w.TableCell,{children:[new Intl.NumberFormat("fa-IR").format(e.quantity)," عدد"]}),(0,s.jsx)(w.TableCell,{children:e.unitPrice?`${new Intl.NumberFormat("fa-IR").format(e.unitPrice)} تومان`:"-"}),(0,s.jsx)(w.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>{h(e),g(e.productId),N(e.quantity),I(e.unitPrice),o(!0)},children:(0,s.jsx)(T.Edit,{className:"h-4 w-4"})}),(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>{var s;return s=e.productId,void(t(H.filter(e=>e.productId!==s)),c({title:"موفق",description:"محصول حذف شد"}))},children:(0,s.jsx)(k.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},e.productId))})]})]},e))}),(0,s.jsx)(y.Dialog,{open:d,onOpenChange:o,children:(0,s.jsxs)(y.DialogContent,{className:"max-w-md",children:[(0,s.jsxs)(y.DialogHeader,{children:[(0,s.jsx)(y.DialogTitle,{children:m?"ویرایش محصول":"افزودن محصول"}),(0,s.jsx)(y.DialogDescription,{children:"محصول و تعداد موجودی را انتخاب کنید"})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"فیلتر دسته‌بندی"}),(0,s.jsxs)(v.Select,{value:R,onValueChange:P,children:[(0,s.jsx)(v.SelectTrigger,{children:(0,s.jsx)(v.SelectValue,{placeholder:"همه دسته‌بندی‌ها"})}),(0,s.jsxs)(v.SelectContent,{children:[(0,s.jsx)(v.SelectItem,{value:"all",children:"همه دسته‌بندی‌ها"}),M.map(e=>(0,s.jsx)(v.SelectItem,{value:e.name,children:e.name},e.id))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"محصول *"}),(0,s.jsxs)(v.Select,{value:j,onValueChange:g,children:[(0,s.jsx)(v.SelectTrigger,{children:(0,s.jsx)(v.SelectValue,{placeholder:"انتخاب محصول"})}),(0,s.jsx)(v.SelectContent,{children:A.map(e=>(0,s.jsxs)(v.SelectItem,{value:e.id,children:[e.name," (",e.category,")"]},e.id))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"تعداد *"}),(0,s.jsx)(l.Input,{type:"number",min:"1",value:f||"",onChange:e=>N(parseInt(e.target.value)||0),placeholder:"تعداد موجودی"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"قیمت واحد (اختیاری)"}),(0,s.jsx)(l.Input,{type:"number",min:"0",value:S||"",onChange:e=>I(e.target.value?parseFloat(e.target.value):void 0),placeholder:"قیمت واحد از تامین‌کننده"})]})]}),(0,s.jsxs)(y.DialogFooter,{children:[(0,s.jsx)(i.Button,{variant:"outline",onClick:()=>{g(""),N(0),I(void 0),h(null),o(!1)},children:"انصراف"}),(0,s.jsx)(i.Button,{onClick:()=>{if(!j||f<=0)return void c({title:"خطا",description:"لطفاً محصول و تعداد را وارد کنید",variant:"destructive"});let e=a.find(e=>e.id===j);if(!e)return;let s={productId:e.id,productName:e.name,category:e.category||"",quantity:f,unitPrice:S||void 0};m?(t(H.map(e=>e.productId===m.productId?s:e)),c({title:"موفق",description:"محصول به‌روزرسانی شد"})):(t([...H,s]),c({title:"موفق",description:"محصول اضافه شد"})),g(""),N(0),I(void 0),h(null),o(!1)},children:m?"ذخیره تغییرات":"افزودن"})]})]})})]})}let I=r.object({name:r.string().min(1,"نام تامین‌کننده الزامی است"),phone:r.string().min(1,"شماره تماس الزامی است"),email:r.string().email("ایمیل معتبر نیست").optional().or(r.literal("")),categories:r.array(r.string()).min(1,"حداقل یک دسته‌بندی الزامی است"),notes:r.string().optional(),isActive:r.boolean(),lowStockThreshold:r.number().min(0).optional()});function R({supplier:e,onSuccess:r}){let v=(0,h.useRouter)(),{addSupplier:y,updateSupplier:w}=(0,m.useSupplierStore)(),{getActiveCategories:C,loadCategoriesFromDB:D}=(0,x.useCategoryStore)(),{toast:k}=(0,u.useToast)(),T=C(),[R,P]=(0,p.useState)(e?.categories||[]);(0,p.useEffect)(()=>{(async()=>{try{await D()}catch(e){console.error("Error loading categories:",e)}})()},[D]);let[M,H]=(0,p.useState)(e?.products||[]),{register:A,handleSubmit:B,formState:{errors:L,isSubmitting:F},setValue:q,watch:z}=(0,t.useForm)({resolver:(0,a.zodResolver)(I),defaultValues:e?{name:e.name,phone:e.phone,email:e.email||"",categories:e.categories,notes:e.notes||"",isActive:e.isActive,lowStockThreshold:e.lowStockThreshold||10}:{name:"",phone:"",email:"",categories:[],notes:"",isActive:!0,lowStockThreshold:10}}),E=z("isActive"),V=e=>{let s=R.includes(e)?R.filter(s=>s!==e):[...R,e];P(s),q("categories",s)},O=async s=>{try{if(0===R.length)return void k({title:"خطا",description:"حداقل یک دسته‌بندی باید انتخاب شود",variant:"destructive"});let t={...s,categories:R,products:M,email:s.email||void 0,notes:s.notes||void 0};e?(w(e.id,t),k({title:"موفق",description:"تامین‌کننده با موفقیت به‌روزرسانی شد"})):(y(t),k({title:"موفق",description:"تامین‌کننده با موفقیت اضافه شد"})),r?.(),v.push("/admin/suppliers")}catch(e){k({title:"خطا",description:"خطایی رخ داد. لطفاً دوباره تلاش کنید.",variant:"destructive"})}};return(0,s.jsxs)("form",{onSubmit:B(O),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(o.Card,{className:"shadow-sm",children:[(0,s.jsx)(o.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(o.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(f.Phone,{className:"h-5 w-5 text-primary"}),"اطلاعات تماس"]})}),(0,s.jsxs)(o.CardContent,{className:"space-y-4 pt-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"name",children:"نام تامین‌کننده *"}),(0,s.jsx)(l.Input,{id:"name",...A("name"),placeholder:"نام تامین‌کننده"}),L.name&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:L.name.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"phone",children:"شماره تماس *"}),(0,s.jsx)(l.Input,{id:"phone",...A("phone"),placeholder:"09123456789",type:"tel"}),L.phone&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:L.phone.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"email",children:"ایمیل"}),(0,s.jsx)(l.Input,{id:"email",...A("email"),placeholder:"example@email.com",type:"email"}),L.email&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:L.email.message})]})]})]}),(0,s.jsxs)(o.Card,{className:"shadow-sm",children:[(0,s.jsx)(o.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(o.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(N.Package,{className:"h-5 w-5 text-primary"}),"دسته‌بندی‌ها و تنظیمات"]})}),(0,s.jsxs)(o.CardContent,{className:"space-y-4 pt-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"دسته‌بندی محصولات *"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 p-3 border border-border/30 rounded-lg min-h-[120px]",children:T.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>V(e.name),className:`
                      p-2 rounded text-sm text-right transition-colors
                      ${R.includes(e.name)?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}
                    `,children:e.name},e.id))}),R.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:R.map(e=>(0,s.jsxs)(b.Badge,{variant:"default",className:"gap-1",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>V(e),className:"ml-1 hover:opacity-70",children:(0,s.jsx)(j.X,{className:"h-3 w-3"})})]},e))}),L.categories&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:L.categories.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"lowStockThreshold",children:"حد آستانه موجودی کم (عدد)"}),(0,s.jsx)(l.Input,{id:"lowStockThreshold",type:"number",...A("lowStockThreshold",{valueAsNumber:!0}),placeholder:"10"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"وقتی موجودی محصولات به این عدد یا کمتر برسد، هشدار نمایش داده می‌شود"})]})]})]})]}),(0,s.jsxs)(o.Card,{className:"shadow-sm",children:[(0,s.jsx)(o.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsx)(o.CardTitle,{children:"یادداشت‌ها"})}),(0,s.jsx)(o.CardContent,{className:"pt-6",children:(0,s.jsx)(c.Textarea,{...A("notes"),placeholder:"یادداشت‌های اضافی درباره این تامین‌کننده...",rows:4})})]}),(0,s.jsxs)(o.Card,{className:"shadow-sm",children:[(0,s.jsx)(o.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(o.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(N.Package,{className:"h-5 w-5 text-primary"}),"مدیریت محصولات"]})}),(0,s.jsx)(o.CardContent,{className:"pt-6",children:(0,s.jsx)(S,{supplier:{...e,categories:R,products:M},onUpdate:H})})]}),(0,s.jsxs)(o.Card,{className:"shadow-sm",children:[(0,s.jsx)(o.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsx)(o.CardTitle,{children:"وضعیت"})}),(0,s.jsx)(o.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(n.Label,{children:"فعال"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"تامین‌کننده فعال است و می‌تواند محصولات را تامین کند"})]}),(0,s.jsx)(d.Switch,{checked:E,onCheckedChange:e=>q("isActive",e)})]})})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t border-border/30",children:[(0,s.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>v.back(),size:"lg",children:"انصراف"}),(0,s.jsx)(i.Button,{type:"submit",disabled:F,size:"lg",className:"min-w-[140px]",children:F?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Loader2,{className:"ml-2 h-4 w-4 animate-spin"}),"در حال ذخیره..."]}):e?"ذخیره تغییرات":"افزودن تامین‌کننده"})]})]})}e.s(["SupplierForm",()=>R],10524)},4270,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),r=e.i(10524),i=e.i(24327),l=e.i(67881),n=e.i(94179),c=e.i(30374),d=e.i(53145),o=e.i(94814),m=e.i(65638),x=e.i(23750),u=e.i(10708),h=e.i(84762),p=e.i(62870),j=e.i(70065),g=e.i(36361),f=e.i(20682),N=e.i(7233),b=e.i(31278),v=e.i(88844),y=e.i(27612);let w=m.object({items:m.array(m.object({productId:m.string().min(1,"محصول الزامی است"),productName:m.string().min(1,"نام محصول الزامی است"),quantity:m.number().min(1,"تعداد باید بیشتر از صفر باشد"),unitPrice:m.number().min(0,"قیمت واحد باید مثبت باشد")})).min(1,"حداقل یک محصول الزامی است"),totalAmount:m.number().min(0,"مبلغ کل باید مثبت باشد"),paymentMethod:m.enum(["cash","check"]),checkDetails:m.object({checkNumber:m.string().min(1,"شماره چک الزامی است"),bankName:m.string().min(1,"نام بانک الزامی است"),dueDate:m.string().min(1,"تاریخ سررسید الزامی است")}).optional(),orderDate:m.string().min(1,"تاریخ سفارش الزامی است"),deliveryDate:m.string().min(1,"تاریخ تحویل الزامی است"),paymentDate:m.string().optional(),notes:m.string().optional()}).refine(e=>"check"!==e.paymentMethod||e.checkDetails?.checkNumber&&e.checkDetails?.bankName&&e.checkDetails?.dueDate,{message:"در صورت انتخاب پرداخت چکی، جزئیات چک الزامی است",path:["checkDetails"]});function C({supplierId:e,transaction:a,onSuccess:r,onCancel:i}){let{products:n}=(0,g.useProductStore)(),{toast:c}=(0,f.useToast)(),[m,C]=(0,t.useState)(!1),{register:D,handleSubmit:k,formState:{errors:T},control:S,watch:I,setValue:R}=(0,d.useForm)({resolver:(0,o.zodResolver)(w),defaultValues:a?{items:a.items.map(e=>({productId:e.productId,productName:e.productName,quantity:e.quantity,unitPrice:e.unitPrice})),totalAmount:a.totalAmount,paymentMethod:a.paymentMethod,checkDetails:a.checkDetails?{checkNumber:a.checkDetails.checkNumber,bankName:a.checkDetails.bankName,dueDate:"string"==typeof a.checkDetails.dueDate?a.checkDetails.dueDate.split("T")[0]:new Date(a.checkDetails.dueDate).toISOString().split("T")[0]}:void 0,orderDate:"string"==typeof a.orderDate?a.orderDate.split("T")[0]:new Date(a.orderDate).toISOString().split("T")[0],deliveryDate:"string"==typeof a.deliveryDate?a.deliveryDate.split("T")[0]:new Date(a.deliveryDate).toISOString().split("T")[0],paymentDate:a.paymentDate?"string"==typeof a.paymentDate?a.paymentDate.split("T")[0]:new Date(a.paymentDate).toISOString().split("T")[0]:"",notes:a.notes||""}:{items:[{productId:"",productName:"",quantity:1,unitPrice:0}],totalAmount:0,paymentMethod:"cash",orderDate:new Date().toISOString().split("T")[0],deliveryDate:new Date().toISOString().split("T")[0],notes:""}}),{fields:P,append:M,remove:H}=(0,d.useFieldArray)({control:S,name:"items"}),A=I("paymentMethod"),B=I("items"),L=()=>{let e=B.reduce((e,s)=>e+(s.quantity||0)*(s.unitPrice||0),0);return R("totalAmount",e),e},F=async e=>{C(!0);try{let s={items:e.items.map(e=>({productId:e.productId,productName:e.productName,quantity:e.quantity,unitPrice:e.unitPrice})),totalAmount:e.totalAmount,paymentMethod:e.paymentMethod,checkDetails:"check"===e.paymentMethod&&e.checkDetails?{checkNumber:e.checkDetails.checkNumber,bankName:e.checkDetails.bankName,dueDate:new Date(e.checkDetails.dueDate)}:void 0,orderDate:new Date(e.orderDate),deliveryDate:new Date(e.deliveryDate),paymentDate:e.paymentDate?new Date(e.paymentDate):void 0,notes:e.notes||void 0};r(s)}catch(e){c({title:"خطا",description:"خطایی در ذخیره تراکنش رخ داد",variant:"destructive"})}finally{C(!1)}};return(0,s.jsxs)("form",{onSubmit:k(F),className:"space-y-6",children:[(0,s.jsxs)(j.Card,{className:"shadow-sm",children:[(0,s.jsx)(j.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(j.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Package,{className:"h-5 w-5 text-primary"}),"محصولات تحویل‌شده"]})}),(0,s.jsxs)(j.CardContent,{className:"pt-6 space-y-4",children:[P.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-4 p-4 border border-border/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"col-span-12 md:col-span-4 space-y-2",children:[(0,s.jsx)(u.Label,{children:"محصول *"}),(0,s.jsxs)(p.Select,{value:B[t]?.productId||"",onValueChange:e=>{let s;(s=n.find(s=>s.id===e))&&(R(`items.${t}.productId`,s.id),R(`items.${t}.productName`,s.name),R(`items.${t}.unitPrice`,s.price||0),L())},children:[(0,s.jsx)(p.SelectTrigger,{children:(0,s.jsx)(p.SelectValue,{placeholder:"انتخاب محصول"})}),(0,s.jsx)(p.SelectContent,{children:n.map(e=>(0,s.jsx)(p.SelectItem,{value:e.id,children:e.name},e.id))})]}),T.items?.[t]?.productId&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.items[t]?.productId?.message})]}),(0,s.jsxs)("div",{className:"col-span-6 md:col-span-3 space-y-2",children:[(0,s.jsx)(u.Label,{children:"تعداد *"}),(0,s.jsx)(x.Input,{type:"number",min:"1",...D(`items.${t}.quantity`,{valueAsNumber:!0,onChange:()=>L()})}),T.items?.[t]?.quantity&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.items[t]?.quantity?.message})]}),(0,s.jsxs)("div",{className:"col-span-6 md:col-span-3 space-y-2",children:[(0,s.jsx)(u.Label,{children:"قیمت واحد (تومان) *"}),(0,s.jsx)(x.Input,{type:"number",min:"0",step:"0.01",...D(`items.${t}.unitPrice`,{valueAsNumber:!0,onChange:()=>L()})}),T.items?.[t]?.unitPrice&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.items[t]?.unitPrice?.message})]}),(0,s.jsx)("div",{className:"col-span-12 md:col-span-2 flex items-end",children:P.length>1&&(0,s.jsx)(l.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>{H(t),L()},className:"text-destructive",children:(0,s.jsx)(y.Trash2,{className:"h-4 w-4"})})})]},e.id)),(0,s.jsxs)(l.Button,{type:"button",variant:"outline",onClick:()=>M({productId:"",productName:"",quantity:1,unitPrice:0}),className:"w-full",children:[(0,s.jsx)(N.Plus,{className:"ml-2 h-4 w-4"}),"افزودن محصول"]})]})]}),(0,s.jsxs)(j.Card,{className:"shadow-sm",children:[(0,s.jsx)(j.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsx)(j.CardTitle,{children:"مبلغ کل"})}),(0,s.jsx)(j.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"مبلغ کل (تومان) *"}),(0,s.jsx)(x.Input,{type:"number",min:"0",step:"0.01",...D("totalAmount",{valueAsNumber:!0}),readOnly:!0,className:"text-lg font-bold"}),T.totalAmount&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.totalAmount.message})]})})]}),(0,s.jsxs)(j.Card,{className:"shadow-sm",children:[(0,s.jsx)(j.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsx)(j.CardTitle,{children:"روش پرداخت"})}),(0,s.jsxs)(j.CardContent,{className:"pt-6 space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"نوع پرداخت *"}),(0,s.jsxs)(p.Select,{value:A,onValueChange:e=>R("paymentMethod",e),children:[(0,s.jsx)(p.SelectTrigger,{children:(0,s.jsx)(p.SelectValue,{})}),(0,s.jsxs)(p.SelectContent,{children:[(0,s.jsx)(p.SelectItem,{value:"cash",children:"نقدی"}),(0,s.jsx)(p.SelectItem,{value:"check",children:"چکی"})]})]}),T.paymentMethod&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.paymentMethod.message})]}),"check"===A&&(0,s.jsxs)("div",{className:"space-y-4 p-4 border border-border/30 rounded-lg bg-muted/30",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"شماره چک *"}),(0,s.jsx)(x.Input,{...D("checkDetails.checkNumber"),placeholder:"مثال: 123456"}),T.checkDetails?.checkNumber&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.checkDetails.checkNumber.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"نام بانک *"}),(0,s.jsx)(x.Input,{...D("checkDetails.bankName"),placeholder:"مثال: بانک ملی"}),T.checkDetails?.bankName&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.checkDetails.bankName.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"تاریخ سررسید چک *"}),(0,s.jsx)(x.Input,{type:"date",...D("checkDetails.dueDate")}),T.checkDetails?.dueDate&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.checkDetails.dueDate.message})]})]})]})]}),(0,s.jsxs)(j.Card,{className:"shadow-sm",children:[(0,s.jsx)(j.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsx)(j.CardTitle,{children:"تاریخ‌ها"})}),(0,s.jsx)(j.CardContent,{className:"pt-6 space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"تاریخ سفارش *"}),(0,s.jsx)(x.Input,{type:"date",...D("orderDate")}),T.orderDate&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.orderDate.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"تاریخ تحویل *"}),(0,s.jsx)(x.Input,{type:"date",...D("deliveryDate")}),T.deliveryDate&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.deliveryDate.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"تاریخ پرداخت"}),(0,s.jsx)(x.Input,{type:"date",...D("paymentDate")}),T.paymentDate&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:T.paymentDate.message})]})]})})]}),(0,s.jsxs)(j.Card,{className:"shadow-sm",children:[(0,s.jsx)(j.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsx)(j.CardTitle,{children:"یادداشت‌ها"})}),(0,s.jsx)(j.CardContent,{className:"pt-6",children:(0,s.jsx)(h.Textarea,{...D("notes"),placeholder:"یادداشت‌های اضافی درباره این تراکنش...",rows:4})})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t border-border/30",children:[i&&(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:i,size:"lg",children:"انصراف"}),(0,s.jsx)(l.Button,{type:"submit",disabled:m,size:"lg",className:"min-w-[140px]",children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.Loader2,{className:"ml-2 h-4 w-4 animate-spin"}),"در حال ذخیره..."]}):a?"ذخیره تغییرات":"افزودن تراکنش"})]})]})}var D=e.i(63415),k=e.i(41071),T=e.i(88511),S=e.i(87316),I=e.i(12426),R=e.i(75254);let P=(0,R.default)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var M=e.i(61659);let H=(0,R.default)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);var A=e.i(45919),B=e.i(29865);function L({transaction:e,onEdit:a,onDelete:r}){let[i,c]=(0,t.useState)(!1),d=e=>{try{return(0,A.format)(new Date(e),"yyyy/MM/dd",{locale:B.faIR})}catch{return"-"}},o=e=>new Intl.NumberFormat("fa-IR").format(e),m=e.items.reduce((e,s)=>e+s.quantity,0);return(0,s.jsxs)(j.Card,{className:"hover:shadow-md transition-shadow border-border/30",children:[(0,s.jsx)(j.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("div",{className:"flex-1 space-y-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(P,{className:"h-5 w-5 text-primary"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["تراکنش #",e.id.slice(-8)]}),(0,s.jsx)(n.Badge,{variant:"cash"===e.paymentMethod?"success":"warning",className:"text-xs",children:"cash"===e.paymentMethod?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(H,{className:"h-3 w-3 ml-1"}),"نقدی"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.CreditCard,{className:"h-3 w-3 ml-1"}),"چکی"]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-xs text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.Calendar,{className:"h-3 w-3"}),"تحویل: ",d(e.deliveryDate)]}),e.paymentDate&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.Calendar,{className:"h-3 w-3"}),"پرداخت: ",d(e.paymentDate)]})]})]})]})}),(0,s.jsxs)(D.DropdownMenu,{children:[(0,s.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,s.jsx)(k.MoreHorizontal,{className:"h-4 w-4"})})}),(0,s.jsxs)(D.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(D.DropdownMenuLabel,{children:"عملیات"}),(0,s.jsx)(D.DropdownMenuSeparator,{}),(0,s.jsxs)(D.DropdownMenuItem,{onClick:()=>a(e),children:[(0,s.jsx)(T.Edit,{className:"ml-2 h-4 w-4"}),"ویرایش"]}),(0,s.jsx)(D.DropdownMenuSeparator,{}),(0,s.jsxs)(D.DropdownMenuItem,{className:"text-destructive",onClick:()=>r(e.id),children:[(0,s.jsx)(y.Trash2,{className:"ml-2 h-4 w-4"}),"حذف"]})]})]})]})}),(0,s.jsxs)(j.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(I.DollarSign,{className:"h-5 w-5 text-primary"}),(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"مبلغ کل"})]}),(0,s.jsxs)("span",{className:"text-xl font-bold",children:[o(e.totalAmount)," تومان"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(v.Package,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"تعداد محصولات"})]}),(0,s.jsx)("div",{className:"text-lg font-semibold",children:e.items.length})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(v.Package,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"تعداد کل"})]}),(0,s.jsxs)("div",{className:"text-lg font-semibold",children:[o(m)," عدد"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"محصولات"}),e.items.length>3&&(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>c(!i),children:i?"بستن":"مشاهده همه"})]}),(0,s.jsx)("div",{className:"space-y-2",children:e.items.slice(0,i?e.items.length:3).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,s.jsx)(v.Package,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm",children:e.productName})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(n.Badge,{variant:"outline",className:"text-xs",children:[o(e.quantity)," عدد"]}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[o(e.unitPrice)," تومان"]})]})]},t))})]}),"check"===e.paymentMethod&&e.checkDetails&&(0,s.jsxs)("div",{className:"pt-3 border-t border-border/30 space-y-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground block",children:"جزئیات چک:"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"شماره چک:"}),(0,s.jsx)("div",{className:"font-medium",children:e.checkDetails.checkNumber})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"بانک:"}),(0,s.jsx)("div",{className:"font-medium",children:e.checkDetails.bankName})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"تاریخ سررسید:"}),(0,s.jsxs)("div",{className:"flex items-center gap-1 font-medium",children:[(0,s.jsx)(S.Calendar,{className:"h-3 w-3"}),d(e.checkDetails.dueDate)]})]})]})]}),(0,s.jsx)("div",{className:"pt-3 border-t border-border/30",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground block mb-1",children:"تاریخ سفارش"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.Calendar,{className:"h-3 w-3"}),d(e.orderDate)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground block mb-1",children:"تاریخ تحویل"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(S.Calendar,{className:"h-3 w-3"}),d(e.deliveryDate)]})]})]})}),e.notes&&(0,s.jsxs)("div",{className:"pt-3 border-t border-border/30",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground block mb-1",children:"یادداشت:"}),(0,s.jsx)("p",{className:"text-sm",children:e.notes})]})]})]})}function F({supplier:e,onUpdate:a}){let{addSupplierTransaction:r,updateSupplierTransaction:d,deleteSupplierTransaction:o}=(0,i.useSupplierStore)(),{toast:m}=(0,f.useToast)(),[x,u]=(0,t.useState)(!1),[h,p]=(0,t.useState)(null),[j,g]=(0,t.useState)(!1),[b,v]=(0,t.useState)(null),y=e.transactions||[],w=()=>{p(null),u(!0)},D=e=>{p(e),u(!0)},k=e=>{v(e),g(!0)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P,{className:"h-5 w-5 text-primary"}),(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"تراکنش‌های تامین"}),y.length>0&&(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:y.length})]}),(0,s.jsxs)(l.Button,{onClick:w,size:"sm",children:[(0,s.jsx)(N.Plus,{className:"ml-2 h-4 w-4"}),"افزودن تراکنش"]})]}),0===y.length?(0,s.jsxs)("div",{className:"text-center py-12 border border-dashed border-border/30 rounded-lg",children:[(0,s.jsx)(P,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4 opacity-50"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"تراکنشی ثبت نشده است"}),(0,s.jsxs)(l.Button,{onClick:w,variant:"outline",size:"sm",className:"mt-4",children:[(0,s.jsx)(N.Plus,{className:"ml-2 h-4 w-4"}),"افزودن اولین تراکنش"]})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:y.sort((e,s)=>new Date(s.deliveryDate).getTime()-new Date(e.deliveryDate).getTime()).map(e=>(0,s.jsx)(L,{transaction:e,onEdit:D,onDelete:k},e.id))})]}),(0,s.jsx)(c.Dialog,{open:x,onOpenChange:u,children:(0,s.jsxs)(c.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsx)(c.DialogTitle,{children:h?"ویرایش تراکنش":"افزودن تراکنش جدید"}),(0,s.jsx)(c.DialogDescription,{children:h?"اطلاعات تراکنش را ویرایش کنید":"اطلاعات تراکنش جدید را وارد کنید"})]}),(0,s.jsx)(C,{supplierId:e.id,transaction:h||void 0,onSuccess:s=>{h?d(e.id,h.id,s):r(e.id,s),h?m({title:"موفق",description:"تراکنش با موفقیت به‌روزرسانی شد"}):m({title:"موفق",description:"تراکنش با موفقیت افزوده شد"}),u(!1),p(null),a?.()},onCancel:()=>u(!1)})]})}),(0,s.jsx)(c.Dialog,{open:j,onOpenChange:g,children:(0,s.jsxs)(c.DialogContent,{children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsx)(c.DialogTitle,{children:"حذف تراکنش"}),(0,s.jsx)(c.DialogDescription,{children:"آیا از حذف این تراکنش اطمینان دارید؟ این عمل قابل بازگشت نیست."})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 pt-4",children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>g(!1),children:"انصراف"}),(0,s.jsx)(l.Button,{variant:"destructive",onClick:()=>{b&&(o(e.id,b),m({title:"موفق",description:"تراکنش با موفقیت حذف شد"}),g(!1),v(null),a?.())},children:"حذف"})]})]})})]})}var q=e.i(27341),z=e.i(72520),E=e.i(84614),V=e.i(43432),O=e.i(63488),$=e.i(22016);function U({params:e}){let{id:c}=(0,t.use)(e);(0,a.useRouter)();let d=(0,i.useSupplierStore)(e=>e.getSupplier(c)),[o,m]=(0,t.useState)(0);if(!d)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] space-y-4",children:[(0,s.jsx)(b.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"در حال بارگذاری..."})]});let x=d.transactions||[],u=x.length;x.reduce((e,s)=>e+s.totalAmount,0);let h=d.products?.length||0;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:d.name}),(0,s.jsx)(n.Badge,{variant:d.isActive?"success":"secondary",children:d.isActive?"فعال":"غیرفعال"})]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"مدیریت اطلاعات و تراکنش‌های تامین‌کننده"})]}),(0,s.jsx)(l.Button,{variant:"outline",asChild:!0,children:(0,s.jsxs)($.default,{href:"/admin/suppliers",children:[(0,s.jsx)(z.ArrowRight,{className:"ml-2 h-4 w-4"}),"بازگشت به لیست"]})})]}),(0,s.jsxs)(j.Card,{children:[(0,s.jsx)(j.CardHeader,{children:(0,s.jsxs)(j.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(E.User,{className:"h-5 w-5 text-primary"}),"اطلاعات تامین‌کننده"]})}),(0,s.jsx)(j.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"تماس"}),(0,s.jsxs)("div",{className:"mt-1.5 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(V.Phone,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("a",{href:`tel:${d.phone}`,className:"text-sm hover:text-primary transition-colors",children:d.phone})]}),d.email&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(O.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("a",{href:`mailto:${d.email}`,className:"text-sm hover:text-primary transition-colors",children:d.email})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"دسته‌بندی‌ها"}),(0,s.jsx)("div",{className:"mt-1.5 flex flex-wrap gap-1.5",children:d.categories.map(e=>(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:e},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"محصولات"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Package,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-lg font-semibold",children:h})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"تراکنش‌ها"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(P,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-lg font-semibold",children:u})]})]})]}),d.notes&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"یادداشت‌ها"}),(0,s.jsx)("p",{className:"mt-1.5 text-sm text-foreground",children:d.notes})]})]})]})})]}),(0,s.jsx)(j.Card,{children:(0,s.jsx)(j.CardContent,{className:"pt-6",children:(0,s.jsxs)(q.Tabs,{defaultValue:"info",className:"w-full",children:[(0,s.jsxs)(q.TabsList,{className:"grid w-full grid-cols-2 lg:grid-cols-2",children:[(0,s.jsxs)(q.TabsTrigger,{value:"info",className:"flex items-center gap-2",children:[(0,s.jsx)(E.User,{className:"h-4 w-4"}),"اطلاعات پایه"]}),(0,s.jsxs)(q.TabsTrigger,{value:"transactions",className:"flex items-center gap-2",children:[(0,s.jsx)(P,{className:"h-4 w-4"}),"تراکنش‌ها",u>0&&(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:u})]})]}),(0,s.jsx)(q.TabsContent,{value:"info",className:"mt-6",children:(0,s.jsx)(r.SupplierForm,{supplier:d})}),(0,s.jsx)(q.TabsContent,{value:"transactions",className:"mt-6",children:(0,s.jsx)(F,{supplier:d,onUpdate:()=>{m(e=>e+1)}},o)})]})})})]})}e.s(["default",()=>U],4270)}]);