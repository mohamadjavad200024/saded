(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,17513,e=>{"use strict";var t=e.i(6344),r=e.i(73493);let a=(0,t.create)((e,t)=>({categories:[],setCategories:t=>e({categories:t}),addCategory:t=>e(e=>{let r=e.categories.findIndex(e=>e.id===t.id);if(r>=0){let a=[...e.categories];return a[r]=t,{categories:a}}return{categories:[...e.categories,t]}}),updateCategory:t=>e(e=>{let r=e.categories.findIndex(e=>e.id===t.id);if(r>=0){let a=[...e.categories];return a[r]=t,{categories:a}}return e}),deleteCategory:t=>e(e=>({categories:e.categories.filter(e=>e.id!==t)})),toggleCategory:t=>e(e=>({categories:e.categories.map(e=>e.id===t?{...e,isActive:!e.isActive}:e)})),getCategory:e=>t().categories.find(t=>t.id===e),getActiveCategories:()=>t().categories.filter(e=>e.isActive&&e.enabled),getEnabledCategories:()=>t().categories.filter(e=>e.enabled),loadCategoriesFromDB:async(e=!1)=>{try{let r=await fetch(e?"/api/categories?all=true":"/api/categories");if(!r.ok)throw Error("خطا در بارگذاری دسته‌بندی‌ها");let a=(await r.json()).data||[];t().setCategories(a)}catch(e){r.logger.error("Error loading categories from DB:",e)}}}));e.s(["useCategoryStore",0,a])},70065,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(47163);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",e),...r}));s.displayName="Card";let l=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...r}));l.displayName="CardHeader";let i=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));i.displayName="CardTitle";let n=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",e),...r}));n.displayName="CardDescription";let c=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent",r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>c,"CardDescription",()=>n,"CardHeader",()=>l,"CardTitle",()=>i])},99682,e=>{"use strict";var t=e.i(71645);function r(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}e.s(["usePrevious",()=>r])},97548,e=>{"use strict";let t=(0,e.i(75254).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);e.s(["Filter",()=>t],97548)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},88511,e=>{"use strict";let t=(0,e.i(75254).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],88511)},47627,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(47163);let s=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,a.cn)("w-full caption-bottom text-sm",e),...r})}));s.displayName="Table";let l=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("thead",{ref:s,className:(0,a.cn)("[&_tr]:border-b border-border/30",e),...r}));l.displayName="TableHeader";let i=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("tbody",{ref:s,className:(0,a.cn)("[&_tr:last-child]:border-0",e),...r}));i.displayName="TableBody",r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("tfoot",{ref:s,className:(0,a.cn)("border-t border-border/30 bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...r})).displayName="TableFooter";let n=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("tr",{ref:s,className:(0,a.cn)("border-b border-border/30 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...r}));n.displayName="TableRow";let c=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("th",{ref:s,className:(0,a.cn)("h-12 px-4 text-right align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...r}));c.displayName="TableHead";let o=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("td",{ref:s,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...r}));o.displayName="TableCell",r.forwardRef(({className:e,...r},s)=>(0,t.jsx)("caption",{ref:s,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",e),...r})).displayName="TableCaption",e.s(["Table",()=>s,"TableBody",()=>i,"TableCell",()=>o,"TableHead",()=>c,"TableHeader",()=>l,"TableRow",()=>n])},41071,e=>{"use strict";let t=(0,e.i(75254).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>t],41071)},40160,e=>{"use strict";let t=(0,e.i(75254).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>t],40160)},41867,e=>{"use strict";var t=e.i(6344),r=e.i(36361),a=e.i(17513),s=e.i(73493);let l={siteName:"ساد",siteDescription:"فروشگاه آنلاین قطعات خودرو وارداتی",maintenanceMode:!1,allowRegistration:!0,emailNotifications:!0,lowStockThreshold:10,itemsPerPage:10,showNotifications:!0,theme:"system"},i={totalProducts:0,activeProducts:0,totalStock:0,lowStockProducts:0,totalCategories:0,activeCategories:0,totalOrders:0,pendingOrders:0,totalRevenue:0,averagePrice:0},n=(0,t.create)((e,t)=>({stats:null,isLoading:!1,settings:l,refreshStats:async()=>{e({isLoading:!0});try{let l=r.useProductStore.getState(),i=a.useCategoryStore.getState(),n=l.products,c=i.categories,o=n.filter(e=>e.enabled),d=o.reduce((e,t)=>e+(t.price||0),0),u=o.length>0?d/o.length:0,h={totalProducts:n.length,activeProducts:o.length,totalStock:n.reduce((e,t)=>e+t.stockCount,0),lowStockProducts:n.filter(e=>e.stockCount<t().settings.lowStockThreshold).length,totalCategories:c.length,activeCategories:c.filter(e=>e.isActive&&e.enabled).length,totalOrders:0,pendingOrders:0,totalRevenue:0,averagePrice:Math.round(u)};try{let e=await fetch("/api/orders",{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();if(t.success&&t.data){let e=t.data;h.totalOrders=e.length,h.pendingOrders=e.filter(e=>"pending"===e.status||"pending"===e.paymentStatus).length,h.totalRevenue=e.filter(e=>"paid"===e.paymentStatus).reduce((e,t)=>e+(t.total||0),0)}}}catch(e){s.logger.warn("Could not fetch order stats:",e)}e({stats:h,isLoading:!1})}catch(t){s.logger.error("Error refreshing stats:",t),e({stats:i,isLoading:!1})}},updateSettings:t=>e(e=>({settings:{...e.settings,...t}})),resetSettings:()=>e({settings:l})}));e.s(["useAdminStore",0,n])},86536,e=>{"use strict";let t=(0,e.i(75254).default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],86536)},25959,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(20783),s=e.i(30030),l=e.i(81140),i=e.i(69340),n=e.i(99682),c=e.i(35804),o=e.i(96626),d=e.i(48425),u="Checkbox",[h,m]=(0,s.createContextScope)(u),[x,f]=h(u);function g(e){let{__scopeCheckbox:a,checked:s,children:l,defaultChecked:n,disabled:c,form:o,name:d,onCheckedChange:h,required:m,value:f="on",internal_do_not_use_render:g}=e,[p,j]=(0,i.useControllableState)({prop:s,defaultProp:n??!1,onChange:h,caller:u}),[b,v]=r.useState(null),[y,C]=r.useState(null),w=r.useRef(!1),k=!b||!!o||!!b.closest("form"),T={checked:p,disabled:c,setChecked:j,control:b,setControl:v,name:d,form:o,value:f,hasConsumerStoppedPropagationRef:w,required:m,defaultChecked:!N(n)&&n,isFormControl:k,bubbleInput:y,setBubbleInput:C};return(0,t.jsx)(x,{scope:a,...T,children:"function"==typeof g?g(T):l})}var p="CheckboxTrigger",j=r.forwardRef(({__scopeCheckbox:e,onKeyDown:s,onClick:i,...n},c)=>{let{control:o,value:u,disabled:h,checked:m,required:x,setControl:g,setChecked:j,hasConsumerStoppedPropagationRef:b,isFormControl:v,bubbleInput:y}=f(p,e),C=(0,a.useComposedRefs)(c,g),w=r.useRef(m);return r.useEffect(()=>{let e=o?.form;if(e){let t=()=>j(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[o,j]),(0,t.jsx)(d.Primitive.button,{type:"button",role:"checkbox","aria-checked":N(m)?"mixed":m,"aria-required":x,"data-state":k(m),"data-disabled":h?"":void 0,disabled:h,value:u,...n,ref:C,onKeyDown:(0,l.composeEventHandlers)(s,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,l.composeEventHandlers)(i,e=>{j(e=>!!N(e)||!e),y&&v&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})})});j.displayName=p;var b=r.forwardRef((e,r)=>{let{__scopeCheckbox:a,name:s,checked:l,defaultChecked:i,required:n,disabled:c,value:o,onCheckedChange:d,form:u,...h}=e;return(0,t.jsx)(g,{__scopeCheckbox:a,checked:l,defaultChecked:i,disabled:c,required:n,onCheckedChange:d,name:s,form:u,value:o,internal_do_not_use_render:({isFormControl:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j,{...h,ref:r,__scopeCheckbox:a}),e&&(0,t.jsx)(w,{__scopeCheckbox:a})]})})});b.displayName=u;var v="CheckboxIndicator",y=r.forwardRef((e,r)=>{let{__scopeCheckbox:a,forceMount:s,...l}=e,i=f(v,a);return(0,t.jsx)(o.Presence,{present:s||N(i.checked)||!0===i.checked,children:(0,t.jsx)(d.Primitive.span,{"data-state":k(i.checked),"data-disabled":i.disabled?"":void 0,...l,ref:r,style:{pointerEvents:"none",...e.style}})})});y.displayName=v;var C="CheckboxBubbleInput",w=r.forwardRef(({__scopeCheckbox:e,...s},l)=>{let{control:i,hasConsumerStoppedPropagationRef:o,checked:u,defaultChecked:h,required:m,disabled:x,name:g,value:p,form:j,bubbleInput:b,setBubbleInput:v}=f(C,e),y=(0,a.useComposedRefs)(l,v),w=(0,n.usePrevious)(u),k=(0,c.useSize)(i);r.useEffect(()=>{if(!b)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!o.current;if(w!==u&&e){let r=new Event("click",{bubbles:t});b.indeterminate=N(u),e.call(b,!N(u)&&u),b.dispatchEvent(r)}},[b,w,u,o]);let T=r.useRef(!N(u)&&u);return(0,t.jsx)(d.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:h??T.current,required:m,disabled:x,name:g,value:p,form:j,...s,tabIndex:-1,ref:y,style:{...s.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function N(e){return"indeterminate"===e}function k(e){return N(e)?"indeterminate":e?"checked":"unchecked"}w.displayName=C;var T=e.i(43531),S=e.i(47163);let R=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)(b,{ref:a,className:(0,S.cn)("peer h-4 w-4 shrink-0 rounded-sm border-[0.25px] border-primary/30 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...r,children:(0,t.jsx)(y,{className:(0,S.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(T.Check,{className:"h-4 w-4"})})}));R.displayName=b.displayName,e.s(["Checkbox",()=>R],25959)},48380,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(47627),s=e.i(67881),l=e.i(94179),i=e.i(25959),n=e.i(63415),c=e.i(41071),o=e.i(88511),d=e.i(27612),u=e.i(86536);let h=(0,e.i(75254).default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var m=e.i(36361),x=e.i(20682),f=e.i(22016),g=e.i(30374);function p({products:e,onRefresh:p}){let[j,b]=(0,r.useState)([]),[v,y]=(0,r.useState)(!1),[C,w]=(0,r.useState)(null),{deleteProduct:N,toggleProduct:k,deleteProducts:T,toggleProducts:S}=(0,m.useProductStore)(),{toast:R}=(0,x.useToast)(),E=async()=>{if(C)try{await N(C),R({title:"موفق",description:"محصول با موفقیت حذف شد"}),y(!1),w(null),p?.()}catch(e){R({title:"خطا",description:e instanceof Error?e.message:"خطا در حذف محصول",variant:"destructive"})}},P=async()=>{if(j.length>0)try{await T(j),R({title:"موفق",description:`${j.length} محصول حذف شد`}),b([]),p?.()}catch(e){R({title:"خطا",description:e instanceof Error?e.message:"خطا در حذف محصولات",variant:"destructive"})}},D=async e=>{try{await k(e),R({title:"موفق",description:"وضعیت محصول تغییر کرد"}),p?.()}catch(e){R({title:"خطا",description:e instanceof Error?e.message:"خطا در تغییر وضعیت محصول",variant:"destructive"})}},H=async e=>{if(j.length>0)try{await S(j,e),R({title:"موفق",description:`${j.length} محصول ${e?"فعال":"غیرفعال"} شد`}),b([]),p?.()}catch(e){R({title:"خطا",description:e instanceof Error?e.message:"خطا در تغییر وضعیت محصولات",variant:"destructive"})}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-4",children:[j.length>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:[j.length," محصول انتخاب شده"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(s.Button,{variant:"outline",size:"sm",onClick:()=>H(!0),children:[(0,t.jsx)(u.Eye,{className:"ml-2 h-4 w-4"}),"فعال کردن"]}),(0,t.jsxs)(s.Button,{variant:"outline",size:"sm",onClick:()=>H(!1),children:[(0,t.jsx)(h,{className:"ml-2 h-4 w-4"}),"غیرفعال کردن"]}),(0,t.jsxs)(s.Button,{variant:"destructive",size:"sm",onClick:P,children:[(0,t.jsx)(d.Trash2,{className:"ml-2 h-4 w-4"}),"حذف"]})]})]}),(0,t.jsx)("div",{className:"rounded-lg border border-border/30 shadow-sm overflow-hidden",children:(0,t.jsxs)(a.Table,{children:[(0,t.jsx)(a.TableHeader,{className:"bg-muted/50",children:(0,t.jsxs)(a.TableRow,{children:[(0,t.jsx)(a.TableHead,{className:"w-12",children:(0,t.jsx)(i.Checkbox,{checked:e.length>0&&j.length===e.length,onCheckedChange:t=>{t?b(e.map(e=>e.id)):b([])}})}),(0,t.jsx)(a.TableHead,{children:"تصویر"}),(0,t.jsx)(a.TableHead,{children:"نام"}),(0,t.jsx)(a.TableHead,{children:"برند"}),(0,t.jsx)(a.TableHead,{children:"دسته‌بندی"}),(0,t.jsx)(a.TableHead,{children:"قیمت"}),(0,t.jsx)(a.TableHead,{children:"موجودی"}),(0,t.jsx)(a.TableHead,{children:"وضعیت"}),(0,t.jsx)(a.TableHead,{className:"text-left",children:"عملیات"})]})}),(0,t.jsx)(a.TableBody,{children:0===e.length?(0,t.jsx)(a.TableRow,{children:(0,t.jsx)(a.TableCell,{colSpan:9,className:"text-center py-8",children:"محصولی یافت نشد"})}):e.map(e=>{let r;return(0,t.jsxs)(a.TableRow,{children:[(0,t.jsx)(a.TableCell,{children:(0,t.jsx)(i.Checkbox,{checked:j.includes(e.id),onCheckedChange:t=>{var r;return r=e.id,void(t?b([...j,r]):b(j.filter(e=>e!==r)))}})}),(0,t.jsx)(a.TableCell,{children:(0,t.jsx)("div",{className:"relative w-14 h-14 rounded-lg overflow-hidden border-2 border-border/30 shadow-sm group",children:e.images&&e.images.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:e.images[0],alt:e.name,className:"w-full h-full object-cover transition-transform group-hover:scale-110"}),e.images.length>1&&(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-xs px-1 py-0.5 text-center",children:["+",e.images.length-1]})]}):(0,t.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-muted to-muted/50 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-xs text-muted-foreground font-medium",children:"بدون تصویر"})})})}),(0,t.jsx)(a.TableCell,{className:"font-medium",children:e.name}),(0,t.jsx)(a.TableCell,{children:e.brand}),(0,t.jsx)(a.TableCell,{children:e.category}),(0,t.jsxs)(a.TableCell,{children:[(r=e.price,new Intl.NumberFormat("fa-IR").format(r))," تومان"]}),(0,t.jsx)(a.TableCell,{children:(0,t.jsx)(l.Badge,{variant:e.stockCount<10?"warning":"success",children:e.stockCount})}),(0,t.jsx)(a.TableCell,{children:(0,t.jsx)(l.Badge,{variant:e.enabled?"success":"secondary",children:e.enabled?"فعال":"غیرفعال"})}),(0,t.jsx)(a.TableCell,{children:(0,t.jsxs)(n.DropdownMenu,{children:[(0,t.jsx)(n.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(c.MoreHorizontal,{className:"h-4 w-4"})})}),(0,t.jsxs)(n.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(n.DropdownMenuLabel,{children:"عملیات"}),(0,t.jsx)(n.DropdownMenuSeparator,{}),(0,t.jsx)(n.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)(f.default,{href:`/admin/products/${e.id}`,children:[(0,t.jsx)(o.Edit,{className:"ml-2 h-4 w-4"}),"ویرایش"]})}),(0,t.jsx)(n.DropdownMenuItem,{onClick:()=>D(e.id),children:e.enabled?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{className:"ml-2 h-4 w-4"}),"غیرفعال کردن"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Eye,{className:"ml-2 h-4 w-4"}),"فعال کردن"]})}),(0,t.jsx)(n.DropdownMenuSeparator,{}),(0,t.jsxs)(n.DropdownMenuItem,{className:"text-destructive",onClick:()=>{w(e.id),y(!0)},children:[(0,t.jsx)(d.Trash2,{className:"ml-2 h-4 w-4"}),"حذف"]})]})]})})]},e.id)})})]})})]}),(0,t.jsx)(g.Dialog,{open:v,onOpenChange:y,children:(0,t.jsxs)(g.DialogContent,{children:[(0,t.jsxs)(g.DialogHeader,{children:[(0,t.jsx)(g.DialogTitle,{children:"حذف محصول"}),(0,t.jsx)(g.DialogDescription,{children:"آیا از حذف این محصول اطمینان دارید؟ این عمل قابل بازگشت نیست."})]}),(0,t.jsxs)(g.DialogFooter,{children:[(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>y(!1),children:"انصراف"}),(0,t.jsx)(s.Button,{variant:"destructive",onClick:E,children:"حذف"})]})]})})]})}var j=e.i(23750),b=e.i(70065),v=e.i(62870),y=e.i(7233),C=e.i(55436),w=e.i(40160),N=e.i(97548),k=e.i(41867),T=e.i(18566);function S(){let{products:e,setFilters:a,clearFilters:l,filters:i,loadProductsFromDB:n}=(0,m.useProductStore)(),{refreshStats:c}=(0,k.useAdminStore)(),o=(0,T.usePathname)(),[d,u]=(0,r.useState)(i.search||""),[h,x]=(0,r.useState)(i.categories?.[0]||"all"),[g,S]=(0,r.useState)("all"),[R,E]=(0,r.useState)(!0),[P,D]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{E(!0);try{await n(!0)}catch(e){console.error("Error loading products:",e)}finally{E(!1)}})()},[n,o]),(0,r.useEffect)(()=>{c()},[c,e]);let H=(0,r.useMemo)(()=>{let t=e;if(t=t.filter(e=>{let t=e.name.toLowerCase();return!(t.includes("test")||t.includes("تست"))}),d){let e=d.toLowerCase();t=t.filter(t=>t.name.toLowerCase().includes(e)||t.brand?.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e))}return"all"!==h&&(t=t.filter(e=>e.category===h)),"active"===g?t=t.filter(e=>e.enabled):"inactive"===g&&(t=t.filter(e=>!e.enabled)),t},[e,d,h,g]),M=Array.from(new Set(e.map(e=>e.category).filter(e=>!!e)));return(0,t.jsxs)("div",{className:"space-y-6",children:[P&&(0,t.jsxs)(b.Card,{className:"shadow-sm",children:[(0,t.jsx)(b.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,t.jsx)(b.CardTitle,{children:"فیلترها و جستجو"})}),(0,t.jsxs)(b.CardContent,{children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"جستجو"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(C.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(j.Input,{placeholder:"جستجو در محصولات...",value:d,onChange:e=>{var t;u(t=e.target.value),t?a({search:t}):l()},className:"pr-10"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"دسته‌بندی"}),(0,t.jsxs)(v.Select,{value:h,onValueChange:x,children:[(0,t.jsx)(v.SelectTrigger,{children:(0,t.jsx)(v.SelectValue,{placeholder:"همه دسته‌بندی‌ها"})}),(0,t.jsxs)(v.SelectContent,{children:[(0,t.jsx)(v.SelectItem,{value:"all",children:"همه دسته‌بندی‌ها"}),M.map(e=>(0,t.jsx)(v.SelectItem,{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"وضعیت"}),(0,t.jsxs)(v.Select,{value:g,onValueChange:S,children:[(0,t.jsx)(v.SelectTrigger,{children:(0,t.jsx)(v.SelectValue,{placeholder:"همه وضعیت‌ها"})}),(0,t.jsxs)(v.SelectContent,{children:[(0,t.jsx)(v.SelectItem,{value:"all",children:"همه وضعیت‌ها"}),(0,t.jsx)(v.SelectItem,{value:"active",children:"فعال"}),(0,t.jsx)(v.SelectItem,{value:"inactive",children:"غیرفعال"})]})]})]})]}),(d||"all"!==h||"all"!==g)&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(s.Button,{variant:"ghost",size:"sm",onClick:()=>{u(""),x("all"),S("all"),l()},children:"پاک کردن فیلترها"})})]})]}),(0,t.jsxs)(b.Card,{className:"shadow-sm",children:[(0,t.jsx)(b.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(b.CardTitle,{children:["محصولات (",H.length,")"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(s.Button,{variant:P?"default":"outline",onClick:()=>D(!P),size:"sm",children:[(0,t.jsx)(N.Filter,{className:"ml-2 h-4 w-4"}),"فیلتر"]}),(0,t.jsxs)(s.Button,{variant:"outline",onClick:()=>{let e=new Blob([[["نام","برند","دسته‌بندی","قیمت","موجودی","وضعیت"],...H.map(e=>[e.name,e.brand,e.category,e.price.toString(),e.stockCount.toString(),e.enabled?"فعال":"غیرفعال"])].map(e=>e.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`products-${new Date().toISOString()}.csv`,t.click()},size:"sm",children:[(0,t.jsx)(w.Download,{className:"ml-2 h-4 w-4"}),"خروجی CSV"]}),(0,t.jsx)(s.Button,{asChild:!0,size:"sm",children:(0,t.jsxs)(f.default,{href:"/admin/products/new",children:[(0,t.jsx)(y.Plus,{className:"ml-2 h-4 w-4"}),"محصول جدید"]})})]})]})}),(0,t.jsx)(b.CardContent,{children:R?(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"در حال بارگذاری محصولات..."})}):(0,t.jsx)(p,{products:H,onRefresh:async()=>{await n(!0),c()}})})]})]})}e.s(["default",()=>S],48380)}]);