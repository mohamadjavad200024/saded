(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,93226,e=>{"use strict";var t=e.i(6344),a=e.i(79473);let s=(0,t.create)()((0,a.persist)((e,t)=>({user:null,isAuthenticated:!1,isCheckingAuth:!1,hasCheckedAuth:!1,register:async(t,a,s)=>{let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:t,phone:a,password:s})}),i=await r.json();if(!i.success)throw Error(i.error||i.message||"خطا در ثبت‌نام");e({user:{id:i.data.user.id,name:i.data.user.name,phone:i.data.user.phone,role:i.data.user.role||"user",createdAt:i.data.user.createdAt},isAuthenticated:!0,hasCheckedAuth:!0})},login:async(t,a)=>{let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({phone:t,password:a})}),r=await s.json();return!!r.success&&(e({user:{id:r.data.user.id,name:r.data.user.name,phone:r.data.user.phone,role:r.data.user.role||"user",createdAt:r.data.user.createdAt},isAuthenticated:!0,hasCheckedAuth:!0}),!0)},logout:async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}finally{e({user:null,isAuthenticated:!1,hasCheckedAuth:!0})}},checkAuth:async()=>{let{isCheckingAuth:a,hasCheckedAuth:s}=t();if(!a){e({isCheckingAuth:!0});try{let t=await fetch("/api/auth/me",{credentials:"include"}),a=await t.json().catch(()=>null);if(t.ok&&a?.success&&a?.data?.user){let t=a.data.user;e({user:{id:t.id,name:t.name,phone:t.phone,role:t.role||"user",createdAt:t.createdAt},isAuthenticated:!0,hasCheckedAuth:!0})}else e({user:null,isAuthenticated:!1,hasCheckedAuth:!0})}catch{s||e({hasCheckedAuth:!0})}finally{e({isCheckingAuth:!1})}}},updateUser:a=>{let{user:s}=t();s&&e({user:{...s,...a}})}}),{name:"saded_auth",storage:(0,a.createJSONStorage)(()=>localStorage),partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})}));e.s(["useAuthStore",0,s])},70065,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(47163);let r=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",e),...a}));r.displayName="Card";let i=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));i.displayName="CardHeader";let d=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("h3",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));d.displayName="CardTitle";let c=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...a}));c.displayName="CardDescription";let n=a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));n.displayName="CardContent",a.forwardRef(({className:e,...a},r)=>(0,t.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>n,"CardDescription",()=>c,"CardHeader",()=>i,"CardTitle",()=>d])},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},37496,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(93226),i=e.i(31278);function d({children:e,requireAuth:d=!0,requireAdmin:c=!1}){let n=(0,s.useRouter)(),{isAuthenticated:l,user:u,checkAuth:o,isCheckingAuth:h,hasCheckedAuth:m}=(0,r.useAuthStore)();return((0,a.useEffect)(()=>{!d||m||h||o()},[d,m,h,o]),(0,a.useEffect)(()=>{if(d&&m&&!h){if(!l)return void n.push("/auth?redirect="+encodeURIComponent(window.location.pathname));c&&u?.role!=="admin"&&n.push("/")}},[l,u,d,c,n,m,h]),d&&(!m||h))?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-primary"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"در حال بررسی دسترسی..."})]})}):c&&(!l||u?.role!=="admin")?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"flex flex-col items-center gap-4",children:(0,t.jsx)("p",{className:"text-destructive",children:"شما دسترسی به این بخش را ندارید"})})}):(0,t.jsx)(t.Fragment,{children:e})}e.s(["ProtectedRoute",()=>d])},2153,e=>{"use strict";var t=e.i(43476),a=e.i(22016),s=e.i(37496),r=e.i(93226),i=e.i(67881),d=e.i(70065);function c(){let{user:e,logout:s}=(0,r.useAuthStore)();return(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,t.jsxs)(d.Card,{children:[(0,t.jsx)(d.CardHeader,{children:(0,t.jsx)(d.CardTitle,{children:"پروفایل"})}),(0,t.jsxs)(d.CardContent,{className:"space-y-2",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"نام"}),(0,t.jsx)("div",{className:"font-medium",children:e?.name||"-"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground mt-4",children:"شماره تماس"}),(0,t.jsx)("div",{className:"font-medium",children:e?.phone||"-"})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,t.jsx)(i.Button,{asChild:!0,children:(0,t.jsx)(a.default,{href:"/orders",children:"سفارش‌های من"})}),(0,t.jsx)(i.Button,{variant:"outline",asChild:!0,children:(0,t.jsx)(a.default,{href:"/chat",children:"پشتیبانی (چت)"})}),(0,t.jsx)(i.Button,{variant:"destructive",onClick:()=>{s()},children:"خروج"})]})]})})}function n(){return(0,t.jsx)(s.ProtectedRoute,{requireAuth:!0,children:(0,t.jsx)(c,{})})}e.s(["default",()=>n])}]);