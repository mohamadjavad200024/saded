(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23787,e=>{"use strict";var s=e.i(43476),t=e.i(53145),a=e.i(94814),i=e.i(65638),r=e.i(67881),n=e.i(23750),l=e.i(10708),c=e.i(84762),o=e.i(62870),d=e.i(19036),p=e.i(70065),m=e.i(36361),h=e.i(17513),x=e.i(33488),g=e.i(20682),u=e.i(18566),b=e.i(71645),j=e.i(37727),y=e.i(7233),f=e.i(88844),v=e.i(39616),N=e.i(73708),S=e.i(75254);let C=(0,S.default)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var w=e.i(78583),k=e.i(31278),E=e.i(71757),I=e.i(40392);let T=(0,S.default)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var F=e.i(12426),P=e.i(94179),A=e.i(69074),L=e.i(48106),O=e.i(47163);function B({images:e,onChange:t,maxImages:a=5,className:i}){let[n,l]=(0,b.useState)(null),c=(0,b.useRef)(null),{toast:o}=(0,g.useToast)(),d=async s=>{let i=s.target.files;if(!i||0===i.length)return;let r=a-e.length;if(r<=0)return void o({title:"خطا",description:`حداکثر ${a} تصویر می‌توانید آپلود کنید`,variant:"destructive"});let n=Array.from(i).slice(0,r);for(let s=0;s<n.length;s++){let a=n[s];if(!a.type.startsWith("image/")){o({title:"خطا",description:"فقط فایل‌های تصویری مجاز هستند",variant:"destructive"});continue}if(a.size>5242880){o({title:"خطا",description:"حجم فایل باید کمتر از 5 مگابایت باشد",variant:"destructive"});continue}l(s);try{let s=await p(a),i=[...e,s];t(i),o({title:"موفق",description:"تصویر با موفقیت آپلود شد"})}catch(e){o({title:"خطا",description:"خطا در آپلود تصویر",variant:"destructive"})}finally{l(null)}}c.current&&(c.current.value="")},p=async e=>{if(e.type.startsWith("image/"))try{return await ((e,s=1920,t=.9)=>new Promise((a,i)=>{let r=new FileReader;r.readAsDataURL(e),r.onload=e=>{let r=new Image;r.onload=()=>{let e=document.createElement("canvas"),n=r.width,l=r.height;n>s&&(l=l*s/n,n=s),e.width=n,e.height=l;let c=e.getContext("2d");c?(c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high",c.drawImage(r,0,0,n,l),a(e.toDataURL("image/jpeg",t))):i(Error("Failed to get canvas context"))},r.onerror=()=>i(Error("Failed to load image")),r.src=e.target?.result},r.onerror=e=>i(e)}))(e,1920,.92)}catch(e){console.warn("Image compression failed, using original:",e)}return new Promise((s,t)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>s(a.result),a.onerror=e=>t(e)})},m=()=>{c.current?.click()};return(0,s.jsxs)("div",{className:(0,O.cn)("space-y-4",i),children:[(0,s.jsxs)("div",{onClick:m,className:(0,O.cn)("relative border-2 border-dashed rounded-lg transition-all cursor-pointer","hover:border-primary/50 hover:bg-primary/5",null!==n?"border-muted-foreground/30 bg-muted/30 cursor-not-allowed":"border-border/30 bg-muted/20",e.length>0&&"border-primary/30 bg-primary/5"),children:[(0,s.jsx)("input",{ref:c,type:"file",accept:"image/*",multiple:!0,onChange:d,className:"hidden"}),0===e.length?(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:null!==n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.Loader2,{className:"h-12 w-12 animate-spin text-primary mb-4"}),(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:"در حال آپلود..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative mb-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-primary/10 rounded-full blur-xl"}),(0,s.jsx)("div",{className:"relative bg-primary/10 rounded-full p-4",children:(0,s.jsx)(A.Upload,{className:"h-10 w-10 text-primary"})})]}),(0,s.jsx)("p",{className:"text-base font-semibold text-foreground mb-1",children:"آپلود تصاویر محصول"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground text-center mb-4",children:"تصاویر را اینجا بکشید یا کلیک کنید"}),(0,s.jsxs)(r.Button,{type:"button",variant:"default",size:"lg",className:"gap-2",children:[(0,s.jsx)(N.Image,{className:"h-4 w-4"}),"انتخاب تصاویر"]})]})}):(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 mb-4",children:[e.map((a,i)=>(0,s.jsxs)("div",{className:"relative group aspect-square rounded-lg border-2 border-border/30 overflow-hidden bg-muted shadow-sm hover:shadow-md transition-all",children:[(0,s.jsx)(L.SafeImage,{src:a,alt:`تصویر ${i+1}`,fill:!0,className:"object-cover",priority:!0,loading:"eager"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:(0,s.jsx)(r.Button,{type:"button",variant:"destructive",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity h-8 w-8",onClick:s=>{s.stopPropagation(),t(e.filter((e,s)=>s!==i))},children:(0,s.jsx)(j.X,{className:"h-4 w-4"})})}),0===i&&(0,s.jsx)("div",{className:"absolute top-2 right-2",children:(0,s.jsx)("span",{className:"px-2 py-0.5 text-[10px] font-bold rounded-md bg-primary text-primary-foreground shadow-sm",children:"اصلی"})})]},i)),e.length<a&&(0,s.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),m()},disabled:null!==n,className:(0,O.cn)("aspect-square rounded-lg border-2 border-dashed border-border/30 bg-muted/50 hover:bg-muted hover:border-primary/30 transition-all flex flex-col items-center justify-center gap-2 group",null!==n&&"opacity-50 cursor-not-allowed"),children:null!==n?(0,s.jsx)(k.Loader2,{className:"h-5 w-5 animate-spin text-muted-foreground"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Upload,{className:"h-5 w-5 text-muted-foreground group-hover:text-primary transition-colors"}),(0,s.jsx)("span",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors",children:"افزودن"})]})})]}),e.length<a&&(0,s.jsx)("div",{className:"flex items-center justify-center pt-2 border-t border-border/20",children:(0,s.jsxs)(r.Button,{type:"button",variant:"outline",onClick:e=>{e.stopPropagation(),m()},disabled:null!==n,className:"gap-2",children:[(0,s.jsx)(A.Upload,{className:"h-4 w-4"}),"افزودن تصویر بیشتر (",e.length,"/",a,")"]})})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-2 text-xs text-muted-foreground bg-muted/30 p-3 rounded-lg",children:[(0,s.jsx)(N.Image,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium mb-1",children:"راهنمای آپلود:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-0.5 text-[11px]",children:[(0,s.jsxs)("li",{children:["می‌توانید تا ",a," تصویر آپلود کنید"]}),(0,s.jsx)("li",{children:"فرمت‌های مجاز: JPG, PNG, WebP"}),(0,s.jsx)("li",{children:"حداکثر حجم هر فایل: 5 مگابایت"}),(0,s.jsx)("li",{children:"اولین تصویر به عنوان تصویر اصلی نمایش داده می‌شود"})]})]})]})]})}var D=e.i(62530);let V=i.object({name:i.string().min(1,"نام محصول الزامی است"),description:i.string().min(1,"توضیحات الزامی است"),price:i.number().min(0,"قیمت باید مثبت باشد"),originalPrice:i.number().optional().nullable(),brand:i.string().min(1,"برند الزامی است"),category:i.string().min(1,"دسته‌بندی الزامی است"),vehicle:i.string().optional().nullable(),model:i.string().optional().nullable(),vin:i.string().optional(),vinEnabled:i.boolean(),airShippingEnabled:i.boolean(),seaShippingEnabled:i.boolean(),airShippingCost:i.preprocess(e=>{if(""===e||null==e||"boolean"==typeof e||"number"==typeof e&&isNaN(e))return null;if("string"==typeof e){let s=parseFloat(e);return isNaN(s)?null:s}return"number"==typeof e?e:null},i.union([i.number().min(0,"هزینه ارسال باید مثبت باشد"),i.null()]).optional()),seaShippingCost:i.preprocess(e=>{if(""===e||null==e||"boolean"==typeof e||"number"==typeof e&&isNaN(e))return null;if("string"==typeof e){let s=parseFloat(e);return isNaN(s)?null:s}return"number"==typeof e?e:null},i.union([i.number().min(0,"هزینه ارسال باید مثبت باشد"),i.null()]).optional()),stockCount:i.number().min(0,"موجودی باید مثبت باشد"),inStock:i.boolean(),enabled:i.boolean(),images:i.array(i.string()).min(1,"حداقل یک تصویر الزامی است"),tags:i.array(i.string()).optional(),specifications:i.record(i.string()).optional()}).refine(e=>(!e.vinEnabled||!!e.vin&&0!==e.vin.length&&17===e.vin.length&&!!/^[A-HJ-NPR-Z0-9]{17}$/.test(e.vin))&&!0,{message:"VIN باید دقیقاً 17 کاراکتر (حروف بزرگ انگلیسی و اعداد، بدون I, O, Q) باشد",path:["vin"]});function z({product:e,onSuccess:i}){let S=(0,u.useRouter)(),{addProduct:A,updateProduct:L,loadProductsFromDB:O}=(0,m.useProductStore)(),{getActiveCategories:z,loadCategoriesFromDB:R}=(0,h.useCategoryStore)(),{getEnabledVehicles:H,loadVehiclesFromDB:J}=(0,x.useVehicleStore)(),{toast:U}=(0,g.useToast)(),K=z(),M=H(),[G,X]=(0,b.useState)(e?.images||[]);(0,b.useEffect)(()=>{(async()=>{try{await Promise.all([R(),J()])}catch(e){console.error("Error loading form data:",e)}})()},[R,J]);let[$,q]=(0,b.useState)(()=>{if(!e?.tags)return[];if(Array.isArray(e.tags))return e.tags;if("string"==typeof e.tags)try{let s=JSON.parse(e.tags);return Array.isArray(s)?s:[]}catch{}return[]}),[W,Q]=(0,b.useState)(""),[Z,Y]=(0,b.useState)(()=>{let s=(0,D.normalizeSpecifications)(e?.specifications),t={};for(let[e,a]of Object.entries(s))t[e]="string"==typeof a?a:String(a);return t}),[_,ee]=(0,b.useState)(""),[es,et]=(0,b.useState)(""),[ea,ei]=(0,b.useState)(!1),[er,en]=(0,b.useState)(e?.vinEnabled??!1),{register:el,handleSubmit:ec,formState:{errors:eo,isSubmitting:ed},setValue:ep,watch:em}=(0,t.useForm)({resolver:(0,a.zodResolver)(V),mode:"onChange",shouldUnregister:!1,defaultValues:(()=>{if(!e)return{name:"",description:"",price:0,originalPrice:void 0,brand:"",category:"",vehicle:"",model:"",vin:"",vinEnabled:!1,airShippingEnabled:!0,seaShippingEnabled:!0,airShippingCost:null,seaShippingCost:null,stockCount:0,inStock:!0,enabled:!0,images:[],tags:[],specifications:{}};let s=void 0===e.airShippingEnabled||!!e.airShippingEnabled,t=void 0===e.seaShippingEnabled||!!e.seaShippingEnabled,a=void 0===e.inStock||!!e.inStock,i=void 0===e.enabled||!!e.enabled;return fetch("http://127.0.0.1:7242/ingest/6e2493c0-cc8b-4c0b-9456-c04638b7e615",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"product-form.tsx:193",message:"Setting defaultValues from product",data:{airShippingEnabledRaw:e.airShippingEnabled,airShippingEnabledType:typeof e.airShippingEnabled,airShippingEnabledConverted:s,airShippingEnabledConvertedType:typeof s,seaShippingEnabledRaw:e.seaShippingEnabled,seaShippingEnabledType:typeof e.seaShippingEnabled,seaShippingEnabledConverted:t,seaShippingEnabledConvertedType:typeof t,inStockRaw:e.inStock,inStockType:typeof e.inStock,inStockConverted:a,inStockConvertedType:typeof a,enabledRaw:e.enabled,enabledType:typeof e.enabled,enabledConverted:i,enabledConvertedType:typeof i},timestamp:Date.now(),sessionId:"debug-session",runId:"post-fix",hypothesisId:"C"})}).catch(()=>{}),{name:e.name,description:e.description??"",price:e.price,originalPrice:e.originalPrice??void 0,brand:e.brand??"",category:e.category??"",vehicle:e.vehicle??"",model:e.model??"",vin:e.vin??"",vinEnabled:void 0!==e.vinEnabled&&!!e.vinEnabled,airShippingEnabled:s,seaShippingEnabled:t,airShippingCost:e.airShippingCost??null,seaShippingCost:e.seaShippingCost??null,stockCount:e.stockCount,inStock:a,enabled:i,images:e.images||[],tags:(()=>{if(!e.tags)return[];if(Array.isArray(e.tags))return e.tags;if("string"==typeof e.tags)try{let s=JSON.parse(e.tags);return Array.isArray(s)?s:[]}catch{}return[]})(),specifications:(()=>{let s=(0,D.normalizeSpecifications)(e.specifications),t={};for(let[e,a]of Object.entries(s))t[e]="string"==typeof a?a:String(a);return t})()}})()}),eh=em("inStock"),ex=em("enabled"),eg=em("airShippingEnabled"),eu=em("seaShippingEnabled"),eb=em("airShippingCost"),ej=em("seaShippingCost"),ey=em("vehicle"),ef=(0,b.useMemo)(()=>{if(ey&&M&&0!==M.length)return M.find(e=>e.id===ey)},[ey,M]),ev=()=>{if(W.trim()&&!$.includes(W.trim())){let e=[...$,W.trim()];q(e),ep("tags",e),Q("")}},eN=async s=>{fetch("http://127.0.0.1:7242/ingest/6e2493c0-cc8b-4c0b-9456-c04638b7e615",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"product-form.tsx:313",message:"onSubmit entry",data:{hasProduct:!!e,productId:e?.id,formDataKeys:Object.keys(s),imagesCount:G.length,tagsCount:$.length,specsCount:Object.keys(Z).length,vinEnabled:er},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"A"})}).catch(()=>{});try{if(0===G.length)return void U({title:"خطا",description:"حداقل یک تصویر الزامی است",variant:"destructive"});let t=null===s.airShippingCost||void 0===s.airShippingCost||"number"==typeof s.airShippingCost&&isNaN(s.airShippingCost)||0===s.airShippingCost?null:Number(s.airShippingCost),a=null===s.seaShippingCost||void 0===s.seaShippingCost||"number"==typeof s.seaShippingCost&&isNaN(s.seaShippingCost)||0===s.seaShippingCost?null:Number(s.seaShippingCost),r={...s,images:G,tags:$,specifications:Z,vin:er?s.vin:void 0,vinEnabled:er,airShippingCost:t,seaShippingCost:a};if(fetch("http://127.0.0.1:7242/ingest/6e2493c0-cc8b-4c0b-9456-c04638b7e615",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"product-form.tsx:350",message:"Before API call",data:{productId:e?.id,productDataKeys:Object.keys(r),airShippingCost:r.airShippingCost,seaShippingCost:r.seaShippingCost,airShippingCostType:typeof r.airShippingCost,seaShippingCostType:typeof r.seaShippingCost,specsType:typeof r.specifications,tagsType:typeof r.tags},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{}),e){let s=await fetch(`/api/products/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(fetch("http://127.0.0.1:7242/ingest/6e2493c0-cc8b-4c0b-9456-c04638b7e615",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"product-form.tsx:362",message:"API response received",data:{status:s.status,statusText:s.statusText,ok:s.ok},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{}),!s.ok){let e=await s.json().catch(()=>({}));throw fetch("http://127.0.0.1:7242/ingest/6e2493c0-cc8b-4c0b-9456-c04638b7e615",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"product-form.tsx:363",message:"API error response",data:{errorData:e,status:s.status},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"B"})}).catch(()=>{}),Error(e.message||"خطا در به‌روزرسانی محصول")}let t=await s.json();L(t.data),await O(!0),localStorage.setItem("product-updated",Date.now().toString()),window.dispatchEvent(new Event("product-updated")),U({title:"موفق",description:"محصول با موفقیت به‌روزرسانی شد"})}else{let e=await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){let s=await e.json().catch(()=>({})),t=s.error||s.message||"خطا در ایجاد محصول";throw console.error("Error creating product:",s),Error(t)}let s=await e.json();console.log("Product created successfully:",s);let t=s.data||s;t&&A(t),await O(!0),localStorage.setItem("product-created",Date.now().toString()),window.dispatchEvent(new Event("product-created")),U({title:"موفق",description:"محصول با موفقیت اضافه شد"})}i?.(),S.push("/admin/products")}catch(e){U({title:"خطا",description:e instanceof Error?e.message:"خطایی رخ داد. لطفاً دوباره تلاش کنید.",variant:"destructive"})}};return(0,s.jsxs)("form",{onSubmit:ec(eN),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(p.Card,{className:"shadow-sm",children:[(0,s.jsx)(p.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(f.Package,{className:"h-5 w-5 text-primary"}),"اطلاعات پایه"]})}),(0,s.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"name",children:"نام محصول *"}),(0,s.jsx)(n.Input,{id:"name",...el("name"),placeholder:"نام محصول"}),eo.name&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:eo.name.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"description",children:"توضیحات *"}),(0,s.jsx)(c.Textarea,{id:"description",...el("description"),placeholder:"توضیحات محصول",rows:4}),eo.description&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:eo.description.message})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"price",children:"قیمت (تومان) *"}),(0,s.jsx)(n.Input,{id:"price",type:"number",...el("price",{valueAsNumber:!0}),placeholder:"0"}),eo.price&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:eo.price.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"originalPrice",children:"قیمت اصلی (تومان)"}),(0,s.jsx)(n.Input,{id:"originalPrice",type:"number",...el("originalPrice",{valueAsNumber:!0}),placeholder:"0"})]})]})]})]}),(0,s.jsxs)(p.Card,{className:"shadow-sm",children:[(0,s.jsx)(p.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Settings,{className:"h-5 w-5 text-primary"}),"دسته‌بندی و برند"]})}),(0,s.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"category",children:"دسته‌بندی *"}),(0,s.jsxs)(o.Select,{value:em("category"),onValueChange:e=>ep("category",e),children:[(0,s.jsx)(o.SelectTrigger,{children:(0,s.jsx)(o.SelectValue,{placeholder:"انتخاب دسته‌بندی"})}),(0,s.jsx)(o.SelectContent,{children:K.map(e=>(0,s.jsx)(o.SelectItem,{value:e.name,children:e.name},e.id))})]}),eo.category&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:eo.category.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"brand",children:"برند *"}),(0,s.jsx)(n.Input,{id:"brand",...el("brand"),placeholder:"نام برند"}),eo.brand&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:eo.brand.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"vehicle",children:"خودرو"}),(0,s.jsxs)(o.Select,{value:em("vehicle")||void 0,onValueChange:e=>{ep("vehicle",e||null),ep("model",null)},children:[(0,s.jsx)(o.SelectTrigger,{children:(0,s.jsx)(o.SelectValue,{placeholder:"انتخاب خودرو (اختیاری)"})}),(0,s.jsx)(o.SelectContent,{children:M.map(e=>(0,s.jsx)(o.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.logo&&(0,s.jsx)("img",{src:e.logo,alt:e.name,className:"h-4 w-4 object-contain"}),(0,s.jsx)("span",{children:e.name})]})},e.id))})]}),em("vehicle")&&(0,s.jsx)(r.Button,{type:"button",variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>{ep("vehicle",null),ep("model",null)},children:"حذف انتخاب"})]}),ef&&ef.models&&ef.models.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"model",children:"مدل"}),(0,s.jsxs)(o.Select,{value:em("model")||void 0,onValueChange:e=>ep("model",e||null),children:[(0,s.jsx)(o.SelectTrigger,{children:(0,s.jsx)(o.SelectValue,{placeholder:"انتخاب مدل (اختیاری)"})}),(0,s.jsx)(o.SelectContent,{children:ef.models.map(e=>(0,s.jsx)(o.SelectItem,{value:e,children:e},e))})]}),em("model")&&(0,s.jsx)(r.Button,{type:"button",variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>ep("model",null),children:"حذف انتخاب"})]}),(0,s.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(l.Label,{htmlFor:"vinEnabled",children:"فعال‌سازی VIN"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"نمایش VIN برای این محصول"})]}),(0,s.jsx)(d.Switch,{id:"vinEnabled",checked:er,onCheckedChange:e=>{en(e),ep("vinEnabled",e),e||ep("vin","")}})]}),(0,s.jsxs)("div",{className:"space-y-1.5 sm:space-y-2",children:[(0,s.jsxs)(l.Label,{htmlFor:"vin",className:"text-[10px] sm:text-xs md:text-sm",children:["VIN ",er&&"*"]}),(0,s.jsx)(n.Input,{id:"vin",...el("vin",{onChange:e=>{let s=e.target.value.toUpperCase();e.target.value=s,ep("vin",s)}}),placeholder:"17 کاراکتر (مثال: 1HGBH41JXMN109186)",maxLength:17,className:"font-mono text-[10px] sm:text-xs md:text-sm h-8 sm:h-9 md:h-10 px-2 sm:px-3"}),eo.vin&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive leading-tight",children:eo.vin.message}),!er&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground leading-tight",children:'برای اعتبارسنجی VIN، ابتدا "فعال‌سازی VIN" را فعال کنید'})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"stockCount",children:"موجودی *"}),(0,s.jsx)(n.Input,{id:"stockCount",type:"number",...el("stockCount",{valueAsNumber:!0}),placeholder:"0"}),eo.stockCount&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:eo.stockCount.message})]})]})]})]}),(0,s.jsxs)(p.Card,{className:"shadow-sm",children:[(0,s.jsx)(p.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(N.Image,{className:"h-5 w-5 text-primary"}),"تصاویر محصول"]})}),(0,s.jsxs)(p.CardContent,{children:[(0,s.jsx)(B,{images:G,onChange:e=>{X(e),ep("images",e)},maxImages:5}),eo.images&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-2",children:eo.images.message})]})]}),(0,s.jsxs)(p.Card,{className:"shadow-sm",children:[(0,s.jsx)(p.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C,{className:"h-5 w-5 text-primary"}),"تگ‌ها"]})}),(0,s.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n.Input,{value:W,onChange:e=>Q(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),ev())},placeholder:"افزودن تگ"}),(0,s.jsx)(r.Button,{type:"button",onClick:ev,children:"افزودن"})]}),$.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2 w-full",children:$.map(e=>(0,s.jsxs)(P.Badge,{variant:"secondary",className:"inline-flex items-center gap-1 max-w-full px-2 py-1",children:[(0,s.jsx)("span",{className:"truncate max-w-[200px]",children:e}),(0,s.jsx)("button",{type:"button",onClick:()=>{let s;q(s=$.filter(s=>s!==e)),ep("tags",s)},className:"hover:text-destructive flex-shrink-0 ml-1","aria-label":"حذف تگ",children:(0,s.jsx)(j.X,{className:"h-3 w-3"})})]},e))})]})]}),(0,s.jsxs)(p.Card,{className:"shadow-sm",children:[(0,s.jsx)(p.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(w.FileText,{className:"h-5 w-5 text-primary"}),"مشخصات"]}),(0,s.jsxs)(r.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>ei(!ea),children:[(0,s.jsx)(y.Plus,{className:"ml-2 h-4 w-4"}),ea?"انصراف":"افزودن مشخصه"]})]})}),(0,s.jsxs)(p.CardContent,{className:"space-y-4",children:[ea&&(0,s.jsxs)("div",{className:"p-4 border border-border/30 rounded-lg bg-muted/30 space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"specKey",children:"کلید مشخصه"}),(0,s.jsx)(n.Input,{id:"specKey",value:_,onChange:e=>ee(e.target.value),placeholder:"مثال: گارانتی"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"specValue",children:"مقدار"}),(0,s.jsx)(n.Input,{id:"specValue",value:es,onChange:e=>et(e.target.value),placeholder:"مثال: 12 ماه"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(r.Button,{type:"button",onClick:()=>{_.trim()&&es.trim()&&(Y({...Z,[_.trim()]:es.trim()}),ee(""),et(""),ei(!1))},size:"sm",children:"افزودن"}),(0,s.jsx)(r.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{ei(!1),ee(""),et("")},children:"انصراف"})]})]}),Object.keys(Z).length>0?(0,s.jsx)("div",{className:"space-y-2 w-full",children:Object.entries(Z).map(([e,t])=>(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3 p-3 border border-border/30 rounded-lg hover:bg-muted/50 transition-colors group w-full",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0 flex flex-col gap-1",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-foreground break-words",children:[e,":"]}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground break-words",children:t})]}),(0,s.jsx)(r.Button,{type:"button",variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0 h-8 w-8",onClick:()=>{let s;return s={...Z},void(delete s[e],Y(s))},"aria-label":"حذف مشخصه",children:(0,s.jsx)(j.X,{className:"h-4 w-4"})})]},e))}):!ea&&(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(w.FileText,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"هیچ مشخصه‌ای اضافه نشده است"})]})]})]}),(0,s.jsxs)(p.Card,{className:"shadow-sm",children:[(0,s.jsx)(p.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Settings,{className:"h-5 w-5 text-primary"}),"وضعیت"]})}),(0,s.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(l.Label,{children:"موجود در انبار"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"محصول در انبار موجود است"})]}),(0,s.jsx)(d.Switch,{id:"inStock",checked:eh,onCheckedChange:e=>ep("inStock",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(l.Label,{children:"فعال"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"محصول در سایت نمایش داده می‌شود"})]}),(0,s.jsx)(d.Switch,{id:"enabled",checked:ex,onCheckedChange:e=>ep("enabled",e)})]})]})]}),(0,s.jsxs)(p.Card,{className:"shadow-sm",children:[(0,s.jsx)(p.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Settings,{className:"h-5 w-5 text-primary"}),"روش‌های ارسال"]})}),(0,s.jsxs)(p.CardContent,{className:"space-y-3 sm:space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)(l.Label,{htmlFor:"airShippingEnabled",className:"flex items-center gap-1.5",children:[(0,s.jsx)(E.Plane,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5"}),"ارسال هوایی"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"امکان ارسال هوایی برای این محصول"})]}),(0,s.jsx)(d.Switch,{id:"airShippingEnabled",checked:eg,onCheckedChange:e=>{ep("airShippingEnabled",e),e||ep("airShippingCost",null)}})]}),eg&&(0,s.jsxs)("div",{className:"space-y-3 pr-4 sm:pr-6 pt-3 border-t border-border/30",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)(l.Label,{htmlFor:"airShippingCost",className:"text-[10px] sm:text-xs md:text-sm font-medium flex items-center gap-1.5",children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5 text-muted-foreground"}),"هزینه ارسال هوایی"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(P.Badge,{variant:null===eb||0===eb?"success":"default",className:"flex items-center gap-1.5 px-3 py-1.5 text-[10px] sm:text-xs font-semibold shadow-sm",children:null===eb||0===eb?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"رایگان"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"پولی"})]})}),(0,s.jsx)(d.Switch,{id:"airShippingCostToggle",checked:null!==eb&&0!==eb,onCheckedChange:e=>{e?ep("airShippingCost",eb&&eb>0?eb:5e4):ep("airShippingCost",null)}})]})]}),null!==eb&&0!==eb&&(0,s.jsxs)("div",{className:"space-y-2 bg-muted/30 p-3 rounded-lg border border-border/20",children:[(0,s.jsx)(n.Input,{id:"airShippingCost",type:"number",...el("airShippingCost",{valueAsNumber:!0,setValueAs:e=>{if(""===e||null==e)return null;let s="string"==typeof e?parseFloat(e):Number(e);return isNaN(s)?null:s}}),placeholder:"مثال: 50000",min:1,className:"text-[11px] sm:text-xs md:text-sm bg-background"}),(0,s.jsxs)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(F.DollarSign,{className:"h-3 w-3"}),"هزینه ارسال به تومان"]})]}),eo.airShippingCost&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive flex items-center gap-1",children:eo.airShippingCost.message})]})]}),(0,s.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)(l.Label,{htmlFor:"seaShippingEnabled",className:"flex items-center gap-1.5",children:[(0,s.jsx)(I.Ship,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5"}),"ارسال دریایی"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"امکان ارسال دریایی برای این محصول"})]}),(0,s.jsx)(d.Switch,{id:"seaShippingEnabled",checked:eu,onCheckedChange:e=>{ep("seaShippingEnabled",e),e||ep("seaShippingCost",null)}})]}),eu&&(0,s.jsxs)("div",{className:"space-y-3 pr-4 sm:pr-6 pt-3 border-t border-border/30",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)(l.Label,{htmlFor:"seaShippingCost",className:"text-[10px] sm:text-xs md:text-sm font-medium flex items-center gap-1.5",children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5 text-muted-foreground"}),"هزینه ارسال دریایی"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(P.Badge,{variant:null===ej||0===ej?"success":"default",className:"flex items-center gap-1.5 px-3 py-1.5 text-[10px] sm:text-xs font-semibold shadow-sm",children:null===ej||0===ej?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"رایگان"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"پولی"})]})}),(0,s.jsx)(d.Switch,{id:"seaShippingCostToggle",checked:null!==ej&&0!==ej,onCheckedChange:e=>{e?ep("seaShippingCost",ej&&ej>0?ej:5e4):ep("seaShippingCost",null)}})]})]}),null!==ej&&0!==ej&&(0,s.jsxs)("div",{className:"space-y-2 bg-muted/30 p-3 rounded-lg border border-border/20",children:[(0,s.jsx)(n.Input,{id:"seaShippingCost",type:"number",...el("seaShippingCost",{valueAsNumber:!0,setValueAs:e=>{if(""===e||null==e)return null;let s="string"==typeof e?parseFloat(e):Number(e);return isNaN(s)?null:s}}),placeholder:"مثال: 50000",min:1,className:"text-[11px] sm:text-xs md:text-sm bg-background"}),(0,s.jsxs)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(F.DollarSign,{className:"h-3 w-3"}),"هزینه ارسال به تومان"]})]}),eo.seaShippingCost&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive flex items-center gap-1",children:eo.seaShippingCost.message})]})]}),eo.airShippingEnabled&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive leading-tight",children:eo.airShippingEnabled.message})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t border-border/30",children:[(0,s.jsx)(r.Button,{type:"button",variant:"outline",onClick:()=>S.back(),size:"lg",children:"انصراف"}),(0,s.jsx)(r.Button,{type:"submit",disabled:ed,size:"lg",className:"min-w-[140px]",children:ed?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.Loader2,{className:"ml-2 h-4 w-4 animate-spin"}),"در حال ذخیره..."]}):e?"ذخیره تغییرات":"افزودن محصول"})]})]})}e.s(["ProductForm",()=>z],23787)}]);