(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let l=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>l],7233)},88511,e=>{"use strict";let l=(0,e.i(75254).default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>l],88511)},47627,e=>{"use strict";var l=e.i(43476),s=e.i(71645),a=e.i(47163);let r=s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:r,className:(0,a.cn)("w-full caption-bottom text-sm",e),...s})}));r.displayName="Table";let t=s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("thead",{ref:r,className:(0,a.cn)("[&_tr]:border-b border-border/30",e),...s}));t.displayName="TableHeader";let i=s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("tbody",{ref:r,className:(0,a.cn)("[&_tr:last-child]:border-0",e),...s}));i.displayName="TableBody",s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("tfoot",{ref:r,className:(0,a.cn)("border-t border-border/30 bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let d=s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("tr",{ref:r,className:(0,a.cn)("border-b border-border/30 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));d.displayName="TableRow";let o=s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("th",{ref:r,className:(0,a.cn)("h-12 px-4 text-right align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));o.displayName="TableHead";let n=s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("td",{ref:r,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));n.displayName="TableCell",s.forwardRef(({className:e,...s},r)=>(0,l.jsx)("caption",{ref:r,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption",e.s(["Table",()=>r,"TableBody",()=>i,"TableCell",()=>n,"TableHead",()=>o,"TableHeader",()=>t,"TableRow",()=>d])},41071,e=>{"use strict";let l=(0,e.i(75254).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>l],41071)},33488,e=>{"use strict";var l=e.i(6344),s=e.i(73493);let a={},r=(0,l.create)((e,l)=>({vehicles:[],filters:a,isLoading:!1,setVehicles:l=>e({vehicles:l}),addVehicle:l=>e(e=>{let s=e.vehicles.findIndex(e=>e.id===l.id);if(s>=0){let a=[...e.vehicles];return a[s]=l,{vehicles:a}}return{vehicles:[...e.vehicles,l]}}),updateVehicle:(l,s)=>e(e=>{let a=e.vehicles.findIndex(e=>e.id===l);if(a>=0){let l=[...e.vehicles];return l[a]={...l[a],...s,updatedAt:new Date},{vehicles:l}}return e}),deleteVehicle:l=>e(e=>({vehicles:e.vehicles.filter(e=>e.id!==l)})),getVehicle:e=>l().vehicles.find(l=>l.id===e),getEnabledVehicles:()=>l().vehicles.filter(e=>e.enabled),setFilters:l=>e(e=>({filters:{...e.filters,...l}})),clearFilters:()=>e({filters:a}),loadVehiclesFromDB:async()=>{e({isLoading:!0});try{let l=await fetch("/api/vehicles");if(!l.ok)throw Error("Failed to load vehicles");let s=await l.json();if(s.success&&s.data){let l=s.data.map(e=>({...e,models:Array.isArray(e.models)?e.models:e.models?JSON.parse(e.models):[],createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));e({vehicles:l,isLoading:!1})}else throw Error(s.error||"Failed to load vehicles")}catch(l){throw s.logger.error("Error loading vehicles:",l),e({isLoading:!1}),l}}}));e.s(["useVehicleStore",0,r])},31042,e=>{"use strict";var l=e.i(43476),s=e.i(71645),a=e.i(5125),r=e.i(47163);let t={sm:"h-6 w-6",md:"h-8 w-8",lg:"h-12 w-12"};function i({logo:e,alt:i,className:d,size:o="md",fallbackIcon:n=!0}){let[c,h]=(0,s.useState)(!1),[m,u]=(0,s.useState)(!1);return!(e&&"string"==typeof e&&e.trim().length>0&&(e.startsWith("data:image")||e.startsWith("data:")||e.startsWith("/")||e.startsWith("http")))||c?n?(0,l.jsx)("div",{className:(0,r.cn)("flex items-center justify-center bg-muted rounded-full",t[o],d),children:(0,l.jsx)(a.Car,{className:(0,r.cn)("text-muted-foreground",t[o])})}):null:(0,l.jsxs)("div",{className:(0,r.cn)("relative flex items-center justify-center overflow-hidden rounded-full bg-background border border-border/30",t[o],d),children:[(0,l.jsx)("img",{src:e,alt:i,className:(0,r.cn)("object-contain w-full h-full rounded-full",!m&&"opacity-0"),onLoad:()=>{u(!0),h(!1)},onError:l=>{console.warn(`[VehicleLogo] Failed to load logo for ${i}:`,{logoLength:e?.length,logoStart:e?.substring(0,50)}),h(!0),u(!1)},style:{display:c?"none":"block"}}),!m&&!c&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-muted animate-pulse",children:(0,l.jsx)(a.Car,{className:(0,r.cn)("text-muted-foreground",t[o])})})]})}e.s(["VehicleLogo",()=>i])},16474,e=>{"use strict";var l=e.i(43476),s=e.i(71645),a=e.i(47627),r=e.i(67881),t=e.i(94179),i=e.i(63415),d=e.i(41071),o=e.i(88511),n=e.i(27612),c=e.i(33488),h=e.i(20682),m=e.i(22016),u=e.i(30374),x=e.i(31042);function f({vehicles:e,onRefresh:f}){let{deleteVehicle:b,loadVehiclesFromDB:j}=(0,c.useVehicleStore)(),{toast:g}=(0,h.useToast)(),[p,v]=(0,s.useState)(!1),[w,y]=(0,s.useState)(null),N=async e=>{try{let l=await fetch(`/api/vehicles/${e}`,{method:"DELETE"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"خطا در حذف خودرو")}b(e),await j(),g({title:"موفق",description:"خودرو با موفقیت حذف شد"}),v(!1),y(null),f?.()}catch(e){g({title:"خطا",description:e instanceof Error?e.message:"خطا در حذف خودرو",variant:"destructive"})}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"rounded-lg border border-border/30 shadow-sm overflow-hidden",children:(0,l.jsxs)(a.Table,{children:[(0,l.jsx)(a.TableHeader,{className:"bg-muted/50",children:(0,l.jsxs)(a.TableRow,{children:[(0,l.jsx)(a.TableHead,{children:"لوگو"}),(0,l.jsx)(a.TableHead,{children:"نام"}),(0,l.jsx)(a.TableHead,{children:"مدل‌ها"}),(0,l.jsx)(a.TableHead,{children:"وضعیت"}),(0,l.jsx)(a.TableHead,{className:"text-left",children:"عملیات"})]})}),(0,l.jsx)(a.TableBody,{children:0===e.length?(0,l.jsx)(a.TableRow,{children:(0,l.jsx)(a.TableCell,{colSpan:5,className:"text-center py-8",children:"خودرویی یافت نشد"})},"empty-state"):e.map((e,s)=>(0,l.jsxs)(a.TableRow,{children:[(0,l.jsx)(a.TableCell,{children:(0,l.jsx)(x.VehicleLogo,{logo:e.logo,alt:e.name,size:"md"})}),(0,l.jsx)(a.TableCell,{className:"font-medium",children:e.name}),(0,l.jsx)(a.TableCell,{className:"text-muted-foreground",children:e.models&&e.models.length>0?(0,l.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.models.slice(0,3).map((e,s)=>(0,l.jsx)(t.Badge,{variant:"outline",className:"text-xs",children:e},s)),e.models.length>3&&(0,l.jsxs)(t.Badge,{variant:"outline",className:"text-xs",children:["+",e.models.length-3]})]}):"-"}),(0,l.jsx)(a.TableCell,{children:(0,l.jsx)(t.Badge,{variant:e.enabled?"default":"secondary",children:e.enabled?"فعال":"غیرفعال"})}),(0,l.jsx)(a.TableCell,{children:(0,l.jsxs)(i.DropdownMenu,{children:[(0,l.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,l.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,l.jsx)(d.MoreHorizontal,{className:"h-4 w-4"})})}),(0,l.jsxs)(i.DropdownMenuContent,{align:"end",children:[(0,l.jsx)(i.DropdownMenuLabel,{children:"عملیات"}),(0,l.jsx)(i.DropdownMenuSeparator,{}),(0,l.jsx)(i.DropdownMenuItem,{asChild:!0,children:(0,l.jsxs)(m.default,{href:`/admin/vehicles/${e.id}`,children:[(0,l.jsx)(o.Edit,{className:"ml-2 h-4 w-4"}),"ویرایش"]})}),(0,l.jsx)(i.DropdownMenuSeparator,{}),(0,l.jsxs)(i.DropdownMenuItem,{className:"text-destructive",onClick:()=>{y(e.id),v(!0)},children:[(0,l.jsx)(n.Trash2,{className:"ml-2 h-4 w-4"}),"حذف"]})]})]})})]},e.id||`vehicle-${s}`))})]})}),(0,l.jsx)(u.Dialog,{open:p,onOpenChange:v,children:(0,l.jsxs)(u.DialogContent,{children:[(0,l.jsxs)(u.DialogHeader,{children:[(0,l.jsx)(u.DialogTitle,{children:"حذف خودرو"}),(0,l.jsx)(u.DialogDescription,{children:"آیا از حذف این خودرو اطمینان دارید؟ این عمل قابل بازگشت نیست."})]}),(0,l.jsxs)(u.DialogFooter,{children:[(0,l.jsx)(r.Button,{variant:"outline",onClick:()=>v(!1),children:"انصراف"}),(0,l.jsx)(r.Button,{variant:"destructive",onClick:()=>{w&&N(w)},children:"حذف"})]})]})})]})}var b=e.i(70065),j=e.i(7233),g=e.i(5125),p=e.i(18566);function v(){let{vehicles:e,loadVehiclesFromDB:a}=(0,c.useVehicleStore)(),[t,i]=(0,s.useState)(!0),d=(0,p.usePathname)();return(0,s.useEffect)(()=>{(async()=>{i(!0);try{await a()}catch(e){console.error("Error loading vehicles:",e)}finally{i(!1)}})()},[a,d]),(0,l.jsx)("div",{className:"space-y-6",children:(0,l.jsxs)(b.Card,{className:"shadow-sm",children:[(0,l.jsx)(b.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)(b.CardTitle,{className:"flex items-center gap-2",children:[(0,l.jsx)(g.Car,{className:"h-5 w-5 text-primary"}),"خودروها (",e.length,")"]}),(0,l.jsx)(r.Button,{asChild:!0,size:"sm",children:(0,l.jsxs)(m.default,{href:"/admin/vehicles/new",children:[(0,l.jsx)(j.Plus,{className:"ml-2 h-4 w-4"}),"افزودن خودرو"]})})]})}),(0,l.jsx)(b.CardContent,{children:t?(0,l.jsx)("div",{className:"text-center py-8",children:"در حال بارگذاری..."}):(0,l.jsx)(f,{vehicles:e,onRefresh:()=>a()})})]})})}e.s(["default",()=>v],16474)}]);