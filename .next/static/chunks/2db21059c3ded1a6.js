(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69638,e=>{"use strict";let s=(0,e.i(75254).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],69638)},99440,e=>{"use strict";var s=e.i(6344),a=e.i(73493);let l={},r=(0,s.create)((e,s)=>({users:[],filters:l,isLoading:!1,setUsers:s=>e({users:s}),addUser:s=>e(e=>{let a=e.users.findIndex(e=>e.id===s.id);if(a>=0){let l=[...e.users];return l[a]=s,{users:l}}return{users:[...e.users,s]}}),updateUser:(s,a)=>e(e=>{let l=e.users.findIndex(e=>e.id===s);if(l>=0){let s=[...e.users];return s[l]={...s[l],...a,updatedAt:new Date},{users:s}}return e}),updateUserStatus:(s,a)=>e(e=>({users:e.users.map(e=>e.id===s?{...e,status:a,updatedAt:new Date}:e)})),updateUserRole:(s,a)=>e(e=>({users:e.users.map(e=>e.id===s?{...e,role:a,updatedAt:new Date}:e)})),deleteUser:s=>e(e=>({users:e.users.filter(e=>e.id!==s)})),getUser:e=>s().users.find(s=>s.id===e),setFilters:s=>e(e=>({filters:{...e.filters,...s}})),clearFilters:()=>e({filters:l}),loadUsersFromDB:async()=>{e({isLoading:!0});try{let e=await fetch("/api/users?limit=1000",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!e.ok){let s=await e.json().catch(()=>({})),a=s.error||s.message||"خطا در بارگذاری کاربران";throw Error(a)}let l=await e.json();if(l.success&&l.data){let e=l.data.map(e=>({id:e.id,name:e.name,email:e.email,phone:e.phone||void 0,role:e.role||"user",status:e.status||(1===e.enabled||!0===e.enabled?"active":"inactive"),avatar:e.avatar||void 0,ordersCount:e.ordersCount||void 0,totalSpent:e.totalSpent||void 0,createdAt:e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),updatedAt:e.updatedAt instanceof Date?e.updatedAt:new Date(e.updatedAt)}));s().setUsers(e),a.logger.info(`✅ Loaded ${e.length} users from database`)}else s().setUsers([]),a.logger.info("No users found in database")}catch(e){a.logger.error("Error loading users from DB:",e),s().setUsers([])}finally{e({isLoading:!1})}}}));e.s(["useUserStore",0,r])},47627,e=>{"use strict";var s=e.i(43476),a=e.i(71645),l=e.i(47163);let r=a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,l.cn)("w-full caption-bottom text-sm",e),...a})}));r.displayName="Table";let t=a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("thead",{ref:r,className:(0,l.cn)("[&_tr]:border-b border-border/30",e),...a}));t.displayName="TableHeader";let i=a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("tbody",{ref:r,className:(0,l.cn)("[&_tr:last-child]:border-0",e),...a}));i.displayName="TableBody",a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("tfoot",{ref:r,className:(0,l.cn)("border-t border-border/30 bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...a})).displayName="TableFooter";let d=a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("tr",{ref:r,className:(0,l.cn)("border-b border-border/30 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...a}));d.displayName="TableRow";let n=a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("th",{ref:r,className:(0,l.cn)("h-12 px-4 text-right align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...a}));n.displayName="TableHead";let c=a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("td",{ref:r,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...a}));c.displayName="TableCell",a.forwardRef(({className:e,...a},r)=>(0,s.jsx)("caption",{ref:r,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",e),...a})).displayName="TableCaption",e.s(["Table",()=>r,"TableBody",()=>i,"TableCell",()=>c,"TableHead",()=>n,"TableHeader",()=>t,"TableRow",()=>d])},41071,e=>{"use strict";let s=(0,e.i(75254).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>s],41071)},97548,e=>{"use strict";let s=(0,e.i(75254).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);e.s(["Filter",()=>s],97548)},40160,e=>{"use strict";let s=(0,e.i(75254).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>s],40160)},98919,e=>{"use strict";let s=(0,e.i(75254).default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);e.s(["Shield",()=>s],98919)},51364,e=>{"use strict";var s=e.i(43476),a=e.i(71645),l=e.i(47627),r=e.i(67881),t=e.i(94179),i=e.i(63415),d=e.i(41071),n=e.i(84614),c=e.i(98919),o=e.i(23622),u=e.i(69638),h=e.i(99440),m=e.i(20682),x=e.i(30374);let j={admin:"مدیر",user:"کاربر",moderator:"ناظر"},p={active:"فعال",inactive:"غیرفعال",suspended:"معلق"},f={admin:"destructive",user:"default",moderator:"secondary"},b={active:"success",inactive:"secondary",suspended:"warning"};function v({users:e,onRefresh:v}){let{updateUserStatus:g,updateUserRole:y,deleteUser:w}=(0,h.useUserStore)(),{toast:N}=(0,m.useToast)(),[C,T]=(0,a.useState)(!1),[S,D]=(0,a.useState)(null);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"rounded-lg border border-border/30 shadow-sm overflow-hidden",children:(0,s.jsxs)(l.Table,{children:[(0,s.jsx)(l.TableHeader,{className:"bg-muted/50",children:(0,s.jsxs)(l.TableRow,{children:[(0,s.jsx)(l.TableHead,{children:"نام"}),(0,s.jsx)(l.TableHead,{children:"ایمیل"}),(0,s.jsx)(l.TableHead,{children:"تلفن"}),(0,s.jsx)(l.TableHead,{children:"نقش"}),(0,s.jsx)(l.TableHead,{children:"وضعیت"}),(0,s.jsx)(l.TableHead,{children:"سفارشات"}),(0,s.jsx)(l.TableHead,{children:"خرید کل"}),(0,s.jsx)(l.TableHead,{className:"text-left",children:"عملیات"})]})}),(0,s.jsx)(l.TableBody,{children:0===e.length?(0,s.jsx)(l.TableRow,{children:(0,s.jsx)(l.TableCell,{colSpan:8,className:"text-center py-8",children:"کاربری یافت نشد"})}):e.map(e=>{let a;return(0,s.jsxs)(l.TableRow,{children:[(0,s.jsx)(l.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.avatar?(0,s.jsx)("img",{src:e.avatar,alt:e.name,className:"w-10 h-10 rounded-full"}):(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:(0,s.jsx)(n.User,{className:"h-5 w-5 text-primary"})}),(0,s.jsx)("span",{className:"font-medium",children:e.name})]})}),(0,s.jsx)(l.TableCell,{children:e.email}),(0,s.jsx)(l.TableCell,{children:e.phone||"-"}),(0,s.jsx)(l.TableCell,{children:(0,s.jsx)(t.Badge,{variant:f[e.role],children:j[e.role]})}),(0,s.jsx)(l.TableCell,{children:(0,s.jsx)(t.Badge,{variant:b[e.status],children:p[e.status]})}),(0,s.jsx)(l.TableCell,{children:e.ordersCount||0}),(0,s.jsxs)(l.TableCell,{children:[e.totalSpent?(a=e.totalSpent,new Intl.NumberFormat("fa-IR").format(a)):"0"," تومان"]}),(0,s.jsx)(l.TableCell,{children:(0,s.jsxs)(i.DropdownMenu,{children:[(0,s.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(d.MoreHorizontal,{className:"h-4 w-4"})})}),(0,s.jsxs)(i.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(i.DropdownMenuLabel,{children:"عملیات"}),(0,s.jsx)(i.DropdownMenuSeparator,{}),(0,s.jsx)(i.DropdownMenuLabel,{children:"تغییر نقش"}),Object.entries(j).map(([a,l])=>(0,s.jsxs)(i.DropdownMenuItem,{onClick:()=>{y(e.id,a),N({title:"موفق",description:"نقش کاربر به‌روزرسانی شد"}),v?.()},disabled:e.role===a,children:[(0,s.jsx)(c.Shield,{className:"ml-2 h-4 w-4"}),l]},a)),(0,s.jsx)(i.DropdownMenuSeparator,{}),(0,s.jsx)(i.DropdownMenuLabel,{children:"تغییر وضعیت"}),Object.entries(p).map(([a,l])=>(0,s.jsxs)(i.DropdownMenuItem,{onClick:()=>{g(e.id,a),N({title:"موفق",description:"وضعیت کاربر به‌روزرسانی شد"}),v?.()},disabled:e.status===a,children:["active"===a?(0,s.jsx)(u.CheckCircle,{className:"ml-2 h-4 w-4"}):(0,s.jsx)(o.Ban,{className:"ml-2 h-4 w-4"}),l]},a)),(0,s.jsx)(i.DropdownMenuSeparator,{}),(0,s.jsx)(i.DropdownMenuItem,{className:"text-destructive",onClick:()=>{D(e.id),T(!0)},children:"حذف کاربر"})]})]})})]},e.id)})})]})}),(0,s.jsx)(x.Dialog,{open:C,onOpenChange:T,children:(0,s.jsxs)(x.DialogContent,{children:[(0,s.jsxs)(x.DialogHeader,{children:[(0,s.jsx)(x.DialogTitle,{children:"حذف کاربر"}),(0,s.jsx)(x.DialogDescription,{children:"آیا از حذف این کاربر اطمینان دارید؟ این عمل قابل بازگشت نیست."})]}),(0,s.jsxs)(x.DialogFooter,{children:[(0,s.jsx)(r.Button,{variant:"outline",onClick:()=>T(!1),children:"انصراف"}),(0,s.jsx)(r.Button,{variant:"destructive",onClick:()=>{S&&(w(S),N({title:"موفق",description:"کاربر با موفقیت حذف شد"}),T(!1),D(null),v?.())},children:"حذف"})]})]})})]})}var g=e.i(23750),y=e.i(70065),w=e.i(62870),N=e.i(55436);let C=(0,e.i(75254).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var T=e.i(40160),S=e.i(97548);function D(){let{users:e,setFilters:l,clearFilters:t,filters:i}=(0,h.useUserStore)(),[d,c]=(0,a.useState)(i.search||""),[o,u]=(0,a.useState)("all"),[m,x]=(0,a.useState)("all"),[j,p]=(0,a.useState)(!1),f=(0,a.useMemo)(()=>{let s=e;if(d){let e=d.toLowerCase();s=s.filter(s=>s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e)||s.phone?.includes(e))}return"all"!==o&&(s=s.filter(e=>e.role===o)),"all"!==m&&(s=s.filter(e=>e.status===m)),s},[e,d,o,m]);return(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)(y.Card,{className:"shadow-sm",children:[(0,s.jsxs)(y.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(y.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(n.User,{className:"h-5 w-5 text-primary"}),"کاربران (",f.length,")"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(r.Button,{variant:j?"default":"outline",onClick:()=>p(!j),size:"sm",children:[(0,s.jsx)(S.Filter,{className:"ml-2 h-4 w-4"}),"فیلتر"]}),(0,s.jsxs)(r.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(T.Download,{className:"ml-2 h-4 w-4"}),"خروجی CSV"]}),(0,s.jsxs)(r.Button,{size:"sm",children:[(0,s.jsx)(C,{className:"ml-2 h-4 w-4"}),"افزودن کاربر"]})]})]}),j&&(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-border/20",children:[(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"جستجو"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(N.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(g.Input,{placeholder:"جستجو در کاربران...",value:d,onChange:e=>{var s;c(s=e.target.value),s?l({search:s}):t()},className:"pr-10"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"نقش"}),(0,s.jsxs)(w.Select,{value:o,onValueChange:e=>u(e),children:[(0,s.jsx)(w.SelectTrigger,{children:(0,s.jsx)(w.SelectValue,{placeholder:"همه نقش‌ها"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"all",children:"همه نقش‌ها"}),(0,s.jsx)(w.SelectItem,{value:"admin",children:"مدیر"}),(0,s.jsx)(w.SelectItem,{value:"moderator",children:"ناظر"}),(0,s.jsx)(w.SelectItem,{value:"user",children:"کاربر"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"وضعیت"}),(0,s.jsxs)(w.Select,{value:m,onValueChange:e=>x(e),children:[(0,s.jsx)(w.SelectTrigger,{children:(0,s.jsx)(w.SelectValue,{placeholder:"همه وضعیت‌ها"})}),(0,s.jsxs)(w.SelectContent,{children:[(0,s.jsx)(w.SelectItem,{value:"all",children:"همه وضعیت‌ها"}),(0,s.jsx)(w.SelectItem,{value:"active",children:"فعال"}),(0,s.jsx)(w.SelectItem,{value:"inactive",children:"غیرفعال"}),(0,s.jsx)(w.SelectItem,{value:"suspended",children:"معلق"})]})]})]})]}),(d||"all"!==o||"all"!==m)&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:()=>{c(""),u("all"),x("all"),t()},children:[(0,s.jsx)(S.Filter,{className:"ml-2 h-4 w-4"}),"پاک کردن فیلترها"]})})]})]}),(0,s.jsx)(y.CardContent,{children:(0,s.jsx)(v,{users:f})})]})})}e.s(["default",()=>D],51364)}]);