(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let s=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},70065,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(47163);let r=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",e),...t}));r.displayName="Card";let l=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let i=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));i.displayName="CardTitle";let n=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));n.displayName="CardDescription";let c=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>c,"CardDescription",()=>n,"CardHeader",()=>l,"CardTitle",()=>i])},20682,e=>{"use strict";var s=e.i(71645);let t=0,a=new Map,r=e=>{if(a.has(e))return;let s=setTimeout(()=>{a.delete(e),n({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,s)},l=[],i={toasts:[]};function n(e){i=((e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?r(t):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}})(i,e),l.forEach(e=>{e(i)})}function c({...e}){let s=(t=(t+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>n({type:"DISMISS_TOAST",toastId:s});return n({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>n({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function d(){let[e,t]=s.useState(i);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>n({type:"DISMISS_TOAST",toastId:e})}}e.s(["useToast",()=>d])},27612,e=>{"use strict";let s=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>s],27612)},71757,40392,e=>{"use strict";var s=e.i(75254);let t=(0,s.default)("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);e.s(["Plane",()=>t],71757);let a=(0,s.default)("Ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]);e.s(["Ship",()=>a],40392)},93226,e=>{"use strict";var s=e.i(6344),t=e.i(79473);let a=(0,s.create)()((0,t.persist)((e,s)=>({user:null,isAuthenticated:!1,register:async(s,t,a)=>{let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s,phone:t,password:a})}),l=await r.json();if(!l.success)throw Error(l.error||"خطا در ثبت‌نام");e({user:{id:l.data.user.id,name:l.data.user.name,phone:l.data.user.phone,createdAt:l.data.user.createdAt},isAuthenticated:!0})},login:async(s,t)=>{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:s,password:t})}),r=await a.json();return!!r.success&&(e({user:{id:r.data.user.id,name:r.data.user.name,phone:r.data.user.phone,role:r.data.user.role,createdAt:r.data.user.createdAt},isAuthenticated:!0}),!0)},logout:()=>{e({user:null,isAuthenticated:!1})},updateUser:t=>{let{user:a}=s();a&&e({user:{...a,...t}})},loadUser:async s=>{try{let t=await fetch(`/api/auth/me?userId=${s}`),a=await t.json();a.success&&a.data.user&&e({user:{id:a.data.user.id,name:a.data.user.name,phone:a.data.user.phone,role:a.data.user.role,createdAt:a.data.user.createdAt},isAuthenticated:!0})}catch(e){console.error("Error loading user:",e)}}}),{name:"saded_auth",storage:(0,t.createJSONStorage)(()=>localStorage),partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})}));e.s(["useAuthStore",0,a])},39616,e=>{"use strict";let s=(0,e.i(75254).default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Settings",()=>s],39616)},92161,92270,e=>{"use strict";var s=e.i(75254);let t=(0,s.default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);e.s(["Menu",()=>t],92161);let a=(0,s.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);e.s(["LogOut",()=>a],92270)},5125,95116,83086,e=>{"use strict";var s=e.i(75254);let t=(0,s.default)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);e.s(["Car",()=>t],5125);let a=(0,s.default)("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);e.s(["Wrench",()=>a],95116);let r=(0,s.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);e.s(["Sparkles",()=>r],83086)},49786,e=>{"use strict";var s=e.i(43476),t=e.i(22016),a=e.i(55436),r=e.i(1928),l=e.i(84614),i=e.i(92161),n=e.i(37727),c=e.i(92270),d=e.i(67881),o=e.i(23750),m=e.i(18566),h=e.i(47163),x=e.i(5125),u=e.i(95116),p=e.i(83086),f=e.i(39616);let g=[{name:"خانه",href:"/",icon:x.Car},{name:"محصولات",href:"/products",icon:u.Wrench},{name:"دسته‌بندی‌ها",href:"/categories",icon:p.Sparkles},{name:"خدمات",href:"/services",icon:f.Settings}];function j({mobile:e=!1,onNavigate:a}){let r=(0,m.usePathname)();return e?(0,s.jsx)("nav",{className:"flex flex-col space-y-2",children:g.map(e=>{let l=e.icon,i=r===e.href;return(0,s.jsxs)(t.default,{href:e.href,onClick:a,className:(0,h.cn)("flex items-center space-x-3 space-x-reverse px-4 py-3 rounded-lg text-base font-medium transition-colors",i?"bg-primary text-primary-foreground":"text-foreground hover:bg-accent hover:text-accent-foreground"),children:[(0,s.jsx)(l,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:e.name})]},e.href)})}):(0,s.jsx)("nav",{className:"hidden lg:flex items-center space-x-1 space-x-reverse",children:g.map(e=>{let a=e.icon,l=r===e.href;return(0,s.jsxs)(t.default,{href:e.href,className:(0,h.cn)("flex items-center space-x-2 space-x-reverse px-3 xl:px-4 py-2 rounded-md text-sm font-medium transition-colors",l?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[(0,s.jsx)(a,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden xl:inline",children:e.name})]},e.href)})})}var y=e.i(61180),N=e.i(93226),v=e.i(71645),b=e.i(75254);let w=(0,b.default)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),k=(0,b.default)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);var S=e.i(63178);function C(){let{theme:e,setTheme:t,resolvedTheme:a}=(0,S.useTheme)(),[r,l]=v.useState(!1);if(v.useEffect(()=>{l(!0)},[]),!r)return(0,s.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"h-9 w-9",children:[(0,s.jsx)(k,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"تغییر تم"})]});let i="dark"===a||"dark"===e;return(0,s.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 relative",onClick:()=>{t("dark"===(a||("system"===e?"light":e))?"light":"dark")},type:"button",children:[(0,s.jsx)(k,{className:`h-5 w-5 absolute transition-all duration-300 ${i?"rotate-90 scale-0 opacity-0":"rotate-0 scale-100 opacity-100"}`}),(0,s.jsx)(w,{className:`h-5 w-5 absolute transition-all duration-300 ${i?"rotate-0 scale-100 opacity-100":"-rotate-90 scale-0 opacity-0"}`}),(0,s.jsx)("span",{className:"sr-only",children:"تغییر تم"})]})}var M=e.i(52917),T=e.i(63415);function A(){let[e,m]=(0,v.useState)(""),[h,x]=(0,v.useState)(!1),[u,p]=(0,v.useState)(!1),[f,g]=(0,v.useState)(!1),{getItemCount:b,initializeSession:w,loadFromDatabase:k,items:S}=(0,y.useCartStore)(),{user:A,isAuthenticated:z,logout:E}=(0,N.useAuthStore)(),O=S.reduce((e,s)=>e+s.quantity,0);return(0,v.useEffect)(()=>{g(!0),(async()=>{try{w(),await k()}catch(e){console.error("Error initializing cart in header:",e)}})()},[w,k]),(0,s.jsxs)("header",{className:"sticky top-0 z-50 w-full border-b-[0.25px] border-border/30 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,s.jsxs)("div",{className:"container flex h-14 sm:h-16 items-center justify-between px-3 sm:px-4",children:[(0,s.jsx)(t.default,{href:"/",className:"flex items-center space-x-1.5 space-x-reverse min-w-0 flex-shrink-0",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-primary leading-tight",children:"ساد"}),(0,s.jsx)("span",{className:"hidden sm:block text-[10px] sm:text-xs text-muted-foreground leading-tight",children:"قطعات خودرو وارداتی"})]})}),(0,s.jsx)("div",{className:"hidden lg:block",children:(0,s.jsx)(j,{})}),(0,s.jsx)("div",{className:"hidden lg:flex flex-1 max-w-xl mx-8",children:(0,s.jsxs)("div",{className:"relative w-full",children:[(0,s.jsx)(a.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,s.jsx)(o.Input,{type:"search",placeholder:"جستجوی قطعه، برند یا شماره VIN...",value:e,onChange:e=>m(e.target.value),className:"pr-10 w-full h-9"})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 space-x-reverse flex-shrink-0",children:[(0,s.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"lg:hidden h-9 w-9",onClick:()=>p(!u),children:[(0,s.jsx)(a.Search,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"جستجو"})]}),(0,s.jsx)(C,{}),z&&A?(0,s.jsxs)(T.DropdownMenu,{children:[(0,s.jsx)(T.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"hidden md:flex h-9 w-9",children:[(0,s.jsx)(l.User,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"حساب کاربری"})]})}),(0,s.jsxs)(T.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,s.jsxs)("div",{className:"px-2 py-1.5",children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:A.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:A.phone})]}),(0,s.jsx)(T.DropdownMenuSeparator,{}),(0,s.jsx)(T.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)(t.default,{href:"/profile",className:"cursor-pointer",children:[(0,s.jsx)(l.User,{className:"ml-2 h-4 w-4"}),"پروفایل"]})}),(0,s.jsx)(T.DropdownMenuSeparator,{}),(0,s.jsxs)(T.DropdownMenuItem,{onClick:()=>{E()},className:"cursor-pointer text-destructive focus:text-destructive",children:[(0,s.jsx)(c.LogOut,{className:"ml-2 h-4 w-4"}),"خروج"]})]})]}):(0,s.jsx)(t.default,{href:"/auth",children:(0,s.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"hidden md:flex h-9 w-9",children:[(0,s.jsx)(l.User,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"حساب کاربری"})]})}),(0,s.jsx)(t.default,{href:"/cart","aria-label":f?`سبد خرید با ${O} آیتم`:"سبد خرید",children:(0,s.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"relative h-9 w-9","aria-label":f&&O>0?`سبد خرید (${O} آیتم)`:"سبد خرید",children:[(0,s.jsx)(r.ShoppingCart,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"سبد خرید"}),f&&O>0&&(0,s.jsx)("span",{className:"absolute -top-0.5 -left-0.5 h-4 w-4 sm:h-5 sm:w-5 rounded-full bg-secondary text-secondary-foreground text-[10px] sm:text-xs font-bold flex items-center justify-center","aria-label":`${O} آیتم در سبد خرید`,children:O>99?"99+":O})]})}),(0,s.jsxs)(M.Sheet,{open:h,onOpenChange:x,children:[(0,s.jsx)(M.SheetTrigger,{asChild:!0,children:(0,s.jsxs)(d.Button,{variant:"ghost",size:"icon",className:"lg:hidden h-9 w-9",children:[(0,s.jsx)(i.Menu,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"منو"})]})}),(0,s.jsxs)(M.SheetContent,{side:"right",className:"w-[280px] sm:w-[320px]",children:[(0,s.jsx)(M.SheetHeader,{children:(0,s.jsx)(M.SheetTitle,{children:"منو"})}),(0,s.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,s.jsx)(j,{mobile:!0,onNavigate:()=>x(!1)}),(0,s.jsxs)("div",{className:"pt-4 border-t-[0.25px] border-border/30 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"تم"}),(0,s.jsx)(C,{})]}),z&&A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"px-2 py-1.5 border-b border-border/30",children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:A.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:A.phone})]}),(0,s.jsx)(t.default,{href:"/profile",children:(0,s.jsxs)(d.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>x(!1),children:[(0,s.jsx)(l.User,{className:"h-4 w-4 ml-2"}),"پروفایل"]})}),(0,s.jsxs)(d.Button,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive",onClick:()=>{E(),x(!1)},children:[(0,s.jsx)(c.LogOut,{className:"h-4 w-4 ml-2"}),"خروج"]})]}):(0,s.jsx)(t.default,{href:"/auth",children:(0,s.jsxs)(d.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>x(!1),children:[(0,s.jsx)(l.User,{className:"h-4 w-4 ml-2"}),"حساب کاربری"]})})]})]})]})]})]})]}),u&&(0,s.jsx)("div",{className:"lg:hidden border-t-[0.25px] border-border/30 px-3 py-2 bg-background animate-in slide-in-from-top",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(a.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,s.jsx)(o.Input,{type:"search",placeholder:"جستجو...",value:e,onChange:e=>m(e.target.value),className:"pr-10 h-9",autoFocus:!0}),(0,s.jsx)(d.Button,{variant:"ghost",size:"icon",className:"absolute left-1 top-1/2 transform -translate-y-1/2 h-7 w-7",onClick:()=>p(!1),children:(0,s.jsx)(n.X,{className:"h-4 w-4"})})]})})]})}e.s(["Header",()=>A],49786)},88251,e=>{"use strict";e.i(47167);var s=e.i(43476),t=e.i(71645),a=e.i(61180),r=e.i(36361),l=e.i(70065),i=e.i(67881),n=e.i(27612),c=e.i(7233);let d=(0,e.i(75254).default)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var o=e.i(50965),m=e.i(71757),h=e.i(40392),x=e.i(57688),u=e.i(22016),p=e.i(20682);function f(){let{items:e,updateQuantity:f,removeItem:g,getTotal:j,clearCart:y,shippingMethod:N,setShippingMethod:v,initializeSession:b,loadFromDatabase:w}=(0,a.useCartStore)(),{getProduct:k,loadProductsFromDB:S}=(0,r.useProductStore)(),{toast:C}=(0,p.useToast)(),[M,T]=(0,t.useState)(N),[A,z]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(async()=>{z(!0);try{b(),await S(),await w()}catch(e){console.error("Error initializing cart:",e)}finally{z(!1)}})()},[b,w,S]);let E=e=>{if(e.image&&""!==e.image.trim()&&(!e.image.startsWith("data:image")||!(e.image.length>5e4)))return e.image;let s=k(e.id);return s&&s.images&&s.images.length>0?(console.log("Using product image for cart item:",{itemId:e.id,productImage:s.images[0]?.substring(0,50)}),s.images[0]):null},O=(e,s)=>{try{f(e,s)}catch(e){e?.name==="QuotaExceededError"||e?.message?.includes("quota")?C({title:"خطا در ذخیره",description:"فضای ذخیره‌سازی پر شده است. لطفاً برخی از محصولات را از سبد خرید حذف کنید.",variant:"destructive"}):C({title:"خطا",description:"خطایی در به‌روزرسانی تعداد محصول رخ داد. لطفاً دوباره تلاش کنید.",variant:"destructive"})}};(0,t.useEffect)(()=>{N&&T(N)},[N]);let I=N||M,B=e=>{T(e),v(e)},D=e.reduce((e,s)=>{let t=k(s.id);return t?(t.airShippingEnabled?e.air=(e.air??!0)&&!0:e.air=!1,t.seaShippingEnabled?e.sea=(e.sea??!0)&&!0:e.sea=!1):(e.air=e.air??!0,e.sea=e.sea??!0),e},{air:void 0,sea:void 0}),L=!0===D.air,q=!0===D.sea;if((0,t.useEffect)(()=>{0!==e.length&&(I?"air"!==I||L?"sea"!==I||q||(L?(T("air"),v("air")):(T(null),v(null))):q?(T("sea"),v("sea")):(T(null),v(null)):(L||q)&&(L?(T("air"),v("air")):q&&(T("sea"),v("sea"))))},[L,q,I,v,e.length]),A)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 sm:py-20 px-4",children:[(0,s.jsx)("div",{className:"h-12 w-12 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"}),(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold mb-2 text-center",children:"در حال بارگذاری سبد خرید..."})]});if(0===e.length)return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 sm:py-20 px-4",children:[(0,s.jsx)(o.ShoppingBag,{className:"h-16 w-16 sm:h-24 sm:w-24 text-muted-foreground mb-4"}),(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold mb-2 text-center",children:"سبد خرید شما خالی است"}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground mb-6 text-center",children:"محصولات مورد نظر خود را به سبد خرید اضافه کنید"}),(0,s.jsx)(u.default,{href:"/products",children:(0,s.jsx)(i.Button,{size:"lg",className:"h-11 sm:h-12",children:"مشاهده محصولات"})})]});let R=j(),$=(()=>{if(!I||0===e.length)return 0;let s=0;for(let t of e){let e=k(t.id);if(e){let t="air"===I?e.airShippingCost??null:e.seaShippingCost??null;null!==t&&t>s&&(s=t)}}return 0===s?R>5e5?0:5e4:s})(),P=R+$;return(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2 space-y-0",children:e.map((t,a)=>(0,s.jsx)("div",{className:`p-3 sm:p-4 md:p-6 ${a<e.length-1?"border-b-[0.25px] border-border/30":""}`,children:(0,s.jsxs)("div",{className:"flex gap-3 sm:gap-4",children:[(0,s.jsx)("div",{className:"relative w-20 h-20 sm:w-24 sm:h-24 bg-muted rounded-lg overflow-hidden flex-shrink-0",children:E(t)?(0,s.jsx)(x.default,{src:E(t),alt:`${t.name} - سبد خرید`,fill:!0,className:"object-cover",onError:e=>{let s=e.target;s.style.display="none";let t=s.parentElement;if(t&&!t.querySelector(".image-placeholder")){let e=document.createElement("div");e.className="image-placeholder w-full h-full flex items-center justify-center text-muted-foreground",e.innerHTML='<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>',t.appendChild(e)}}}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:(0,s.jsx)(o.ShoppingBag,{className:"h-8 w-8"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2 text-sm sm:text-base line-clamp-2",children:t.name}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center border-[0.25px] border-border/30 rounded-md",children:[(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 sm:h-9 sm:w-9",onClick:()=>O(t.id,t.quantity-1),children:(0,s.jsx)(d,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})}),(0,s.jsx)("span",{className:"w-10 sm:w-12 text-center text-sm sm:text-base",children:t.quantity}),(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 sm:h-9 sm:w-9",onClick:()=>O(t.id,t.quantity+1),children:(0,s.jsx)(c.Plus,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]}),(0,s.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>g(t.id),className:"text-destructive h-8 w-8 sm:h-9 sm:w-9",children:(0,s.jsx)(n.Trash2,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"text-base sm:text-lg font-bold",children:[(t.price*t.quantity).toLocaleString("fa-IR")," ","تومان"]})]})]})]})},t.id))}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)(l.Card,{className:"sticky top-20 sm:top-24",children:[(0,s.jsx)(l.CardHeader,{className:"p-4 sm:p-6 pb-3 sm:pb-4",children:(0,s.jsx)(l.CardTitle,{className:"text-lg sm:text-xl",children:"خلاصه سفارش"})}),(0,s.jsxs)(l.CardContent,{className:"space-y-3 sm:space-y-4 p-4 sm:p-6 pt-0",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm sm:text-base",children:[(0,s.jsx)("span",{children:"جمع کل:"}),(0,s.jsxs)("span",{className:"font-semibold",children:[R.toLocaleString("fa-IR")," تومان"]})]}),(L||q)&&(0,s.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,s.jsx)("div",{className:"text-sm sm:text-base font-medium",children:"روش ارسال:"}),(0,s.jsxs)("div",{className:`grid gap-2 sm:gap-3 ${L&&q?"grid-cols-2":"grid-cols-1"}`,children:[L&&(0,s.jsxs)("button",{onClick:()=>B("air"),className:`flex flex-col items-center justify-center gap-2 p-3 sm:p-4 rounded-lg border-[0.25px] transition-all ${"air"===I?"border-primary/30 bg-primary/5":"border-border/30 hover:border-primary/20"}`,children:[(0,s.jsx)(m.Plane,{className:`h-5 w-5 sm:h-6 sm:w-6 ${"air"===I?"text-primary":"text-muted-foreground"}`}),(0,s.jsx)("span",{className:`text-xs sm:text-sm font-medium ${"air"===I?"text-primary":"text-foreground"}`,children:"هوایی"})]}),q&&(0,s.jsxs)("button",{onClick:()=>B("sea"),className:`flex flex-col items-center justify-center gap-2 p-3 sm:p-4 rounded-lg border-[0.25px] transition-all ${"sea"===I?"border-primary/30 bg-primary/5":"border-border/30 hover:border-primary/20"}`,children:[(0,s.jsx)(h.Ship,{className:`h-5 w-5 sm:h-6 sm:w-6 ${"sea"===I?"text-primary":"text-muted-foreground"}`}),(0,s.jsx)("span",{className:`text-xs sm:text-sm font-medium ${"sea"===I?"text-primary":"text-foreground"}`,children:"دریایی"})]})]})]}),!L&&!q&&(0,s.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,s.jsx)("div",{className:"text-sm sm:text-base font-medium",children:"روش ارسال:"}),(0,s.jsx)("div",{className:"p-3 sm:p-4 rounded-lg border-[0.25px] border-border/30 bg-muted/30",children:(0,s.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground text-center",children:"روش ارسال برای محصولات موجود در سبد خرید توسط مدیر در زمان ارسال مشخص خواهد شد"})})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm sm:text-base",children:[(0,s.jsx)("span",{children:"هزینه ارسال:"}),(0,s.jsx)("span",{className:"font-semibold",children:0===$?(0,s.jsx)("span",{className:"text-green-600",children:"رایگان"}):`${$.toLocaleString("fa-IR")} تومان`})]}),$>0&&5e4===$&&R<5e5&&(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground leading-relaxed",children:["برای ارسال رایگان، ",(5e5-R).toLocaleString("fa-IR")," تومان دیگر به سبد خرید خود اضافه کنید"]}),(0,s.jsxs)("div",{className:"border-t-[0.25px] border-border/30 pt-3 sm:pt-4 flex justify-between text-base sm:text-lg font-bold",children:[(0,s.jsx)("span",{children:"مبلغ نهایی:"}),(0,s.jsxs)("span",{children:[P.toLocaleString("fa-IR")," تومان"]})]}),(0,s.jsxs)("div",{className:"flex gap-2 sm:gap-3 min-w-0",children:[(0,s.jsx)(u.default,{href:"/checkout",className:"flex-1 min-w-0",children:(0,s.jsx)(i.Button,{className:"w-full h-11 sm:h-12 text-xs sm:text-sm",size:"lg",children:"ادامه خرید"})}),(0,s.jsx)(i.Button,{variant:"outline",className:"h-11 sm:h-12 text-xs sm:text-sm whitespace-nowrap flex-shrink-0",size:"lg",onClick:()=>{},children:"ارسال فاکتور خرید"})]}),(0,s.jsx)(i.Button,{variant:"outline",className:"w-full h-10 sm:h-11 text-sm sm:text-base",onClick:y,children:"پاک کردن سبد خرید"})]})]})})]})}e.s(["CartContent",()=>f],88251)}]);