(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let s=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},10708,e=>{"use strict";var s=e.i(43476),t=e.i(71645);e.i(74080);var a=e.i(91918),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let i=(0,a.createSlot)(`Primitive.${r}`),l=t.forwardRef((e,t)=>{let{asChild:a,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(a?i:r,{...l,ref:t})});return l.displayName=`Primitive.${r}`,{...e,[r]:l}},{}),i=t.forwardRef((e,t)=>(0,s.jsx)(r.label,{...e,ref:t,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));i.displayName="Label";var l=e.i(25913),n=e.i(47163);let c=(0,l.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(i,{ref:a,className:(0,n.cn)(c(),e),...t}));d.displayName=i.displayName,e.s(["Label",()=>d],10708)},17513,e=>{"use strict";var s=e.i(6344),t=e.i(73493);let a=(0,s.create)((e,s)=>({categories:[],setCategories:s=>e({categories:s}),addCategory:s=>e(e=>{let t=e.categories.findIndex(e=>e.id===s.id);if(t>=0){let a=[...e.categories];return a[t]=s,{categories:a}}return{categories:[...e.categories,s]}}),updateCategory:s=>e(e=>{let t=e.categories.findIndex(e=>e.id===s.id);if(t>=0){let a=[...e.categories];return a[t]=s,{categories:a}}return e}),deleteCategory:s=>e(e=>({categories:e.categories.filter(e=>e.id!==s)})),toggleCategory:s=>e(e=>({categories:e.categories.map(e=>e.id===s?{...e,isActive:!e.isActive}:e)})),getCategory:e=>s().categories.find(s=>s.id===e),getActiveCategories:()=>s().categories.filter(e=>e.isActive&&e.enabled),getEnabledCategories:()=>s().categories.filter(e=>e.enabled),loadCategoriesFromDB:async(e=!1)=>{try{let t=await fetch(e?"/api/categories?all=true":"/api/categories");if(!t.ok)throw Error("خطا در بارگذاری دسته‌بندی‌ها");let a=(await t.json()).data||[];s().setCategories(a)}catch(e){t.logger.error("Error loading categories from DB:",e)}}}));e.s(["useCategoryStore",0,a])},70065,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(47163);let r=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",e),...t}));r.displayName="Card";let i=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let l=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let n=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));n.displayName="CardDescription";let c=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>c,"CardDescription",()=>n,"CardHeader",()=>i,"CardTitle",()=>l])},99682,e=>{"use strict";var s=e.i(71645);function t(e){let t=s.useRef({value:e,previous:e});return s.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}e.s(["usePrevious",()=>t])},19036,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(81140),r=e.i(20783),i=e.i(30030),l=e.i(69340),n=e.i(99682),c=e.i(35804),d=e.i(48425),o="Switch",[m,p]=(0,i.createContextScope)(o),[x,h]=m(o),u=t.forwardRef((e,i)=>{let{__scopeSwitch:n,name:c,checked:m,defaultChecked:p,required:h,disabled:u,value:g="on",onCheckedChange:j,form:v,...y}=e,[N,C]=t.useState(null),w=(0,r.useComposedRefs)(i,e=>C(e)),S=t.useRef(!1),k=!N||v||!!N.closest("form"),[P,E]=(0,l.useControllableState)({prop:m,defaultProp:p??!1,onChange:j,caller:o});return(0,s.jsxs)(x,{scope:n,checked:P,disabled:u,children:[(0,s.jsx)(d.Primitive.button,{type:"button",role:"switch","aria-checked":P,"aria-required":h,"data-state":f(P),"data-disabled":u?"":void 0,disabled:u,value:g,...y,ref:w,onClick:(0,a.composeEventHandlers)(e.onClick,e=>{E(e=>!e),k&&(S.current=e.isPropagationStopped(),S.current||e.stopPropagation())})}),k&&(0,s.jsx)(b,{control:N,bubbles:!S.current,name:c,value:g,checked:P,required:h,disabled:u,form:v,style:{transform:"translateX(-100%)"}})]})});u.displayName=o;var g="SwitchThumb",j=t.forwardRef((e,t)=>{let{__scopeSwitch:a,...r}=e,i=h(g,a);return(0,s.jsx)(d.Primitive.span,{"data-state":f(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:t})});j.displayName=g;var b=t.forwardRef(({__scopeSwitch:e,control:a,checked:i,bubbles:l=!0,...d},o)=>{let m=t.useRef(null),p=(0,r.useComposedRefs)(m,o),x=(0,n.usePrevious)(i),h=(0,c.useSize)(a);return t.useEffect(()=>{let e=m.current;if(!e)return;let s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(x!==i&&s){let t=new Event("click",{bubbles:l});s.call(e,i),e.dispatchEvent(t)}},[x,i,l]),(0,s.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i,...d,tabIndex:-1,ref:p,style:{...d.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function f(e){return e?"checked":"unchecked"}b.displayName="SwitchBubbleInput";var v=e.i(47163);let y=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(u,{className:(0,v.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:a,children:(0,s.jsx)(j,{className:(0,v.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));y.displayName=u.displayName,e.s(["Switch",()=>y],19036)},12426,e=>{"use strict";let s=(0,e.i(75254).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],12426)},71757,40392,e=>{"use strict";var s=e.i(75254);let t=(0,s.default)("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);e.s(["Plane",()=>t],71757);let a=(0,s.default)("Ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]);e.s(["Ship",()=>a],40392)},69074,e=>{"use strict";let s=(0,e.i(75254).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>s],69074)},23787,e=>{"use strict";var s=e.i(43476),t=e.i(53145),a=e.i(94814),r=e.i(65638),i=e.i(67881),l=e.i(23750),n=e.i(10708),c=e.i(84762),d=e.i(62870),o=e.i(19036),m=e.i(70065),p=e.i(36361),x=e.i(17513),h=e.i(20682),u=e.i(18566),g=e.i(71645),j=e.i(37727),b=e.i(7233),f=e.i(88844),v=e.i(39616),y=e.i(73708),N=e.i(75254);let C=(0,N.default)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var w=e.i(78583),S=e.i(31278),k=e.i(71757),P=e.i(40392);let E=(0,N.default)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var F=e.i(12426),I=e.i(94179),L=e.i(69074),R=e.i(47163);function T({images:e,onChange:t,maxImages:a=5,className:r}){let[l,n]=(0,g.useState)(null),c=(0,g.useRef)(null),{toast:d}=(0,h.useToast)(),o=async s=>{let r=s.target.files;if(!r||0===r.length)return;let i=a-e.length;if(i<=0)return void d({title:"خطا",description:`حداکثر ${a} تصویر می‌توانید آپلود کنید`,variant:"destructive"});let l=Array.from(r).slice(0,i);for(let s=0;s<l.length;s++){let a=l[s];if(!a.type.startsWith("image/")){d({title:"خطا",description:"فقط فایل‌های تصویری مجاز هستند",variant:"destructive"});continue}if(a.size>5242880){d({title:"خطا",description:"حجم فایل باید کمتر از 5 مگابایت باشد",variant:"destructive"});continue}n(s);try{let s=await m(a),r=[...e,s];t(r),d({title:"موفق",description:"تصویر با موفقیت آپلود شد"})}catch(e){d({title:"خطا",description:"خطا در آپلود تصویر",variant:"destructive"})}finally{n(null)}}c.current&&(c.current.value="")},m=async e=>{if(e.type.startsWith("image/"))try{return await ((e,s=1920,t=.9)=>new Promise((a,r)=>{let i=new FileReader;i.readAsDataURL(e),i.onload=e=>{let i=new Image;i.onload=()=>{let e=document.createElement("canvas"),l=i.width,n=i.height;l>s&&(n=n*s/l,l=s),e.width=l,e.height=n;let c=e.getContext("2d");c?(c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high",c.drawImage(i,0,0,l,n),a(e.toDataURL("image/jpeg",t))):r(Error("Failed to get canvas context"))},i.onerror=()=>r(Error("Failed to load image")),i.src=e.target?.result},i.onerror=e=>r(e)}))(e,1920,.92)}catch(e){console.warn("Image compression failed, using original:",e)}return new Promise((s,t)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>s(a.result),a.onerror=e=>t(e)})},p=()=>{c.current?.click()};return(0,s.jsxs)("div",{className:(0,R.cn)("space-y-4",r),children:[(0,s.jsxs)("div",{onClick:p,className:(0,R.cn)("relative border-2 border-dashed rounded-lg transition-all cursor-pointer","hover:border-primary/50 hover:bg-primary/5",null!==l?"border-muted-foreground/30 bg-muted/30 cursor-not-allowed":"border-border/30 bg-muted/20",e.length>0&&"border-primary/30 bg-primary/5"),children:[(0,s.jsx)("input",{ref:c,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"}),0===e.length?(0,s.jsx)("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:null!==l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.Loader2,{className:"h-12 w-12 animate-spin text-primary mb-4"}),(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:"در حال آپلود..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative mb-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-primary/10 rounded-full blur-xl"}),(0,s.jsx)("div",{className:"relative bg-primary/10 rounded-full p-4",children:(0,s.jsx)(L.Upload,{className:"h-10 w-10 text-primary"})})]}),(0,s.jsx)("p",{className:"text-base font-semibold text-foreground mb-1",children:"آپلود تصاویر محصول"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground text-center mb-4",children:"تصاویر را اینجا بکشید یا کلیک کنید"}),(0,s.jsxs)(i.Button,{type:"button",variant:"default",size:"lg",className:"gap-2",children:[(0,s.jsx)(y.Image,{className:"h-4 w-4"}),"انتخاب تصاویر"]})]})}):(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 mb-4",children:[e.map((a,r)=>(0,s.jsxs)("div",{className:"relative group aspect-square rounded-lg border-2 border-border/30 overflow-hidden bg-muted shadow-sm hover:shadow-md transition-all",children:[(0,s.jsx)("img",{src:a,alt:`تصویر ${r+1}`,className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:(0,s.jsx)(i.Button,{type:"button",variant:"destructive",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity h-8 w-8",onClick:s=>{s.stopPropagation(),t(e.filter((e,s)=>s!==r))},children:(0,s.jsx)(j.X,{className:"h-4 w-4"})})}),0===r&&(0,s.jsx)("div",{className:"absolute top-2 right-2",children:(0,s.jsx)("span",{className:"px-2 py-0.5 text-[10px] font-bold rounded-md bg-primary text-primary-foreground shadow-sm",children:"اصلی"})})]},r)),e.length<a&&(0,s.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),p()},disabled:null!==l,className:(0,R.cn)("aspect-square rounded-lg border-2 border-dashed border-border/30 bg-muted/50 hover:bg-muted hover:border-primary/30 transition-all flex flex-col items-center justify-center gap-2 group",null!==l&&"opacity-50 cursor-not-allowed"),children:null!==l?(0,s.jsx)(S.Loader2,{className:"h-5 w-5 animate-spin text-muted-foreground"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.Upload,{className:"h-5 w-5 text-muted-foreground group-hover:text-primary transition-colors"}),(0,s.jsx)("span",{className:"text-[10px] text-muted-foreground group-hover:text-primary transition-colors",children:"افزودن"})]})})]}),e.length<a&&(0,s.jsx)("div",{className:"flex items-center justify-center pt-2 border-t border-border/20",children:(0,s.jsxs)(i.Button,{type:"button",variant:"outline",onClick:e=>{e.stopPropagation(),p()},disabled:null!==l,className:"gap-2",children:[(0,s.jsx)(L.Upload,{className:"h-4 w-4"}),"افزودن تصویر بیشتر (",e.length,"/",a,")"]})})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-2 text-xs text-muted-foreground bg-muted/30 p-3 rounded-lg",children:[(0,s.jsx)(y.Image,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium mb-1",children:"راهنمای آپلود:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-0.5 text-[11px]",children:[(0,s.jsxs)("li",{children:["می‌توانید تا ",a," تصویر آپلود کنید"]}),(0,s.jsx)("li",{children:"فرمت‌های مجاز: JPG, PNG, WebP"}),(0,s.jsx)("li",{children:"حداکثر حجم هر فایل: 5 مگابایت"}),(0,s.jsx)("li",{children:"اولین تصویر به عنوان تصویر اصلی نمایش داده می‌شود"})]})]})]})]})}let H=r.object({name:r.string().min(1,"نام محصول الزامی است"),description:r.string().min(1,"توضیحات الزامی است"),price:r.number().min(0,"قیمت باید مثبت باشد"),originalPrice:r.number().optional(),brand:r.string().min(1,"برند الزامی است"),category:r.string().min(1,"دسته‌بندی الزامی است"),vin:r.string().optional(),vinEnabled:r.boolean(),airShippingEnabled:r.boolean(),seaShippingEnabled:r.boolean(),airShippingCost:r.number().min(0,"هزینه ارسال باید مثبت باشد").nullable().optional(),seaShippingCost:r.number().min(0,"هزینه ارسال باید مثبت باشد").nullable().optional(),stockCount:r.number().min(0,"موجودی باید مثبت باشد"),inStock:r.boolean(),enabled:r.boolean(),images:r.array(r.string()).min(1,"حداقل یک تصویر الزامی است"),tags:r.array(r.string()).optional(),specifications:r.record(r.string()).optional()}).refine(e=>(!e.vinEnabled||!!e.vin&&0!==e.vin.length&&17===e.vin.length&&!!/^[A-HJ-NPR-Z0-9]{17}$/.test(e.vin))&&!0,{message:"VIN باید دقیقاً 17 کاراکتر (حروف بزرگ انگلیسی و اعداد، بدون I, O, Q) باشد",path:["vin"]});function D({product:e,onSuccess:r}){let N=(0,u.useRouter)(),{addProduct:L,updateProduct:R,loadProductsFromDB:D}=(0,p.useProductStore)(),{getActiveCategories:B,loadCategoriesFromDB:M}=(0,x.useCategoryStore)(),{toast:A}=(0,h.useToast)(),z=B(),[V,O]=(0,g.useState)(e?.images||[]);(0,g.useEffect)(()=>{(async()=>{try{await M()}catch(e){console.error("Error loading categories:",e)}})()},[M]);let[U,q]=(0,g.useState)(e?.tags||[]),[$,J]=(0,g.useState)(""),[K,X]=(0,g.useState)(()=>{let s=e?.specifications||{},t={};for(let[e,a]of Object.entries(s))t[e]="string"==typeof a?a:String(a);return t}),[G,W]=(0,g.useState)(""),[Q,Z]=(0,g.useState)(""),[Y,_]=(0,g.useState)(!1),[ee,es]=(0,g.useState)(e?.vinEnabled??!1),{register:et,handleSubmit:ea,formState:{errors:er,isSubmitting:ei},setValue:el,watch:en}=(0,t.useForm)({resolver:(0,a.zodResolver)(H),defaultValues:e?{name:e.name,description:e.description??"",price:e.price,originalPrice:e.originalPrice??void 0,brand:e.brand??"",category:e.category??"",vin:e.vin??"",vinEnabled:e.vinEnabled??!1,airShippingEnabled:e.airShippingEnabled??!0,seaShippingEnabled:e.seaShippingEnabled??!0,airShippingCost:e.airShippingCost??null,seaShippingCost:e.seaShippingCost??null,stockCount:e.stockCount,inStock:e.inStock,enabled:e.enabled,images:e.images||[],tags:e.tags,specifications:(()=>{let s=e.specifications||{},t={};for(let[e,a]of Object.entries(s))t[e]="string"==typeof a?a:String(a);return t})()}:{name:"",description:"",price:0,originalPrice:void 0,brand:"",category:"",vin:"",vinEnabled:!1,airShippingEnabled:!0,seaShippingEnabled:!0,airShippingCost:null,seaShippingCost:null,stockCount:0,inStock:!0,enabled:!0,images:[],tags:[],specifications:{}}}),ec=en("inStock"),ed=en("enabled"),eo=en("airShippingEnabled"),em=en("seaShippingEnabled"),ep=en("airShippingCost"),ex=en("seaShippingCost"),eh=()=>{if($.trim()&&!U.includes($.trim())){let e=[...U,$.trim()];q(e),el("tags",e),J("")}},eu=async s=>{try{if(0===V.length)return void A({title:"خطا",description:"حداقل یک تصویر الزامی است",variant:"destructive"});let t={...s,images:V,tags:U,specifications:K,vin:ee?s.vin:void 0,vinEnabled:ee};if(e){let s=await fetch(`/api/products/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.message||"خطا در به‌روزرسانی محصول")}let a=await s.json();R(a.data),A({title:"موفق",description:"محصول با موفقیت به‌روزرسانی شد"})}else{let e=await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){let s=await e.json().catch(()=>({})),t=s.error||s.message||"خطا در ایجاد محصول";throw console.error("Error creating product:",s),Error(t)}let s=await e.json();console.log("Product created successfully:",s);let a=s.data||s;a&&L(a),await D(!0),A({title:"موفق",description:"محصول با موفقیت اضافه شد"})}r?.(),N.push("/admin/products")}catch(e){A({title:"خطا",description:e instanceof Error?e.message:"خطایی رخ داد. لطفاً دوباره تلاش کنید.",variant:"destructive"})}};return(0,s.jsxs)("form",{onSubmit:ea(eu),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(m.Card,{className:"shadow-sm",children:[(0,s.jsx)(m.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(m.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(f.Package,{className:"h-5 w-5 text-primary"}),"اطلاعات پایه"]})}),(0,s.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"name",children:"نام محصول *"}),(0,s.jsx)(l.Input,{id:"name",...et("name"),placeholder:"نام محصول"}),er.name&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:er.name.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"description",children:"توضیحات *"}),(0,s.jsx)(c.Textarea,{id:"description",...et("description"),placeholder:"توضیحات محصول",rows:4}),er.description&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:er.description.message})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"price",children:"قیمت (تومان) *"}),(0,s.jsx)(l.Input,{id:"price",type:"number",...et("price",{valueAsNumber:!0}),placeholder:"0"}),er.price&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:er.price.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"originalPrice",children:"قیمت اصلی (تومان)"}),(0,s.jsx)(l.Input,{id:"originalPrice",type:"number",...et("originalPrice",{valueAsNumber:!0}),placeholder:"0"})]})]})]})]}),(0,s.jsxs)(m.Card,{className:"shadow-sm",children:[(0,s.jsx)(m.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(m.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Settings,{className:"h-5 w-5 text-primary"}),"دسته‌بندی و برند"]})}),(0,s.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"category",children:"دسته‌بندی *"}),(0,s.jsxs)(d.Select,{value:en("category"),onValueChange:e=>el("category",e),children:[(0,s.jsx)(d.SelectTrigger,{children:(0,s.jsx)(d.SelectValue,{placeholder:"انتخاب دسته‌بندی"})}),(0,s.jsx)(d.SelectContent,{children:z.map(e=>(0,s.jsx)(d.SelectItem,{value:e.name,children:e.name},e.id))})]}),er.category&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:er.category.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"brand",children:"برند *"}),(0,s.jsx)(l.Input,{id:"brand",...et("brand"),placeholder:"نام برند"}),er.brand&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:er.brand.message})]}),(0,s.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 sm:gap-4",children:[(0,s.jsxs)("div",{className:"space-y-0.5 flex-1 min-w-0",children:[(0,s.jsx)(n.Label,{className:"text-[10px] sm:text-xs md:text-sm",children:"فعال‌سازی VIN"}),(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground leading-tight",children:"نمایش VIN برای این محصول"})]}),(0,s.jsx)(o.Switch,{checked:ee,onCheckedChange:e=>{es(e),el("vinEnabled",e),e||el("vin","")},className:"flex-shrink-0"})]}),(0,s.jsxs)("div",{className:"space-y-1.5 sm:space-y-2",children:[(0,s.jsxs)(n.Label,{htmlFor:"vin",className:"text-[10px] sm:text-xs md:text-sm",children:["VIN ",ee&&"*"]}),(0,s.jsx)(l.Input,{id:"vin",...et("vin",{onChange:e=>{let s=e.target.value.toUpperCase();e.target.value=s,el("vin",s)}}),placeholder:"17 کاراکتر (مثال: 1HGBH41JXMN109186)",maxLength:17,className:"font-mono text-[10px] sm:text-xs md:text-sm h-8 sm:h-9 md:h-10 px-2 sm:px-3"}),er.vin&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive leading-tight",children:er.vin.message}),!ee&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground leading-tight",children:'برای اعتبارسنجی VIN، ابتدا "فعال‌سازی VIN" را فعال کنید'})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"stockCount",children:"موجودی *"}),(0,s.jsx)(l.Input,{id:"stockCount",type:"number",...et("stockCount",{valueAsNumber:!0}),placeholder:"0"}),er.stockCount&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:er.stockCount.message})]})]})]})]}),(0,s.jsxs)(m.Card,{className:"shadow-sm",children:[(0,s.jsx)(m.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(m.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(y.Image,{className:"h-5 w-5 text-primary"}),"تصاویر محصول"]})}),(0,s.jsxs)(m.CardContent,{children:[(0,s.jsx)(T,{images:V,onChange:e=>{O(e),el("images",e)},maxImages:5}),er.images&&(0,s.jsx)("p",{className:"text-sm text-destructive mt-2",children:er.images.message})]})]}),(0,s.jsxs)(m.Card,{className:"shadow-sm",children:[(0,s.jsx)(m.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(m.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(C,{className:"h-5 w-5 text-primary"}),"تگ‌ها"]})}),(0,s.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.Input,{value:$,onChange:e=>J(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),eh())},placeholder:"افزودن تگ"}),(0,s.jsx)(i.Button,{type:"button",onClick:eh,children:"افزودن"})]}),U.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:U.map(e=>(0,s.jsxs)(I.Badge,{variant:"secondary",className:"gap-1",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>{let s;q(s=U.filter(s=>s!==e)),el("tags",s)},className:"ml-1 hover:text-destructive",children:(0,s.jsx)(j.X,{className:"h-3 w-3"})})]},e))})]})]}),(0,s.jsxs)(m.Card,{className:"shadow-sm",children:[(0,s.jsx)(m.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(m.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(w.FileText,{className:"h-5 w-5 text-primary"}),"مشخصات"]}),(0,s.jsxs)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>_(!Y),children:[(0,s.jsx)(b.Plus,{className:"ml-2 h-4 w-4"}),Y?"انصراف":"افزودن مشخصه"]})]})}),(0,s.jsxs)(m.CardContent,{className:"space-y-4",children:[Y&&(0,s.jsxs)("div",{className:"p-4 border border-border/30 rounded-lg bg-muted/30 space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"specKey",children:"کلید مشخصه"}),(0,s.jsx)(l.Input,{id:"specKey",value:G,onChange:e=>W(e.target.value),placeholder:"مثال: گارانتی"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"specValue",children:"مقدار"}),(0,s.jsx)(l.Input,{id:"specValue",value:Q,onChange:e=>Z(e.target.value),placeholder:"مثال: 12 ماه"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.Button,{type:"button",onClick:()=>{G.trim()&&Q.trim()&&(X({...K,[G.trim()]:Q.trim()}),W(""),Z(""),_(!1))},size:"sm",children:"افزودن"}),(0,s.jsx)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{_(!1),W(""),Z("")},children:"انصراف"})]})]}),Object.keys(K).length>0?(0,s.jsx)("div",{className:"space-y-2",children:Object.entries(K).map(([e,t])=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border border-border/30 rounded-lg hover:bg-muted/50 transition-colors group",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-foreground",children:[e,":"]}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground mr-2",children:t})]}),(0,s.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{let s;return s={...K},void(delete s[e],X(s))},children:(0,s.jsx)(j.X,{className:"h-4 w-4"})})]},e))}):!Y&&(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(w.FileText,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"هیچ مشخصه‌ای اضافه نشده است"})]})]})]}),(0,s.jsxs)(m.Card,{className:"shadow-sm",children:[(0,s.jsx)(m.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(m.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Settings,{className:"h-5 w-5 text-primary"}),"وضعیت"]})}),(0,s.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(n.Label,{children:"موجود در انبار"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"محصول در انبار موجود است"})]}),(0,s.jsx)(o.Switch,{checked:ec,onCheckedChange:e=>el("inStock",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(n.Label,{children:"فعال"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"محصول در سایت نمایش داده می‌شود"})]}),(0,s.jsx)(o.Switch,{checked:ed,onCheckedChange:e=>el("enabled",e)})]})]})]}),(0,s.jsxs)(m.Card,{className:"shadow-sm",children:[(0,s.jsx)(m.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,s.jsxs)(m.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Settings,{className:"h-5 w-5 text-primary"}),"روش‌های ارسال"]})}),(0,s.jsxs)(m.CardContent,{className:"space-y-3 sm:space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 sm:gap-4",children:[(0,s.jsxs)("div",{className:"space-y-0.5 flex-1 min-w-0",children:[(0,s.jsxs)(n.Label,{className:"text-[10px] sm:text-xs md:text-sm flex items-center gap-1.5",children:[(0,s.jsx)(k.Plane,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5"}),"ارسال هوایی"]}),(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground leading-tight",children:"امکان ارسال هوایی برای این محصول"})]}),(0,s.jsx)(o.Switch,{checked:eo,onCheckedChange:e=>{el("airShippingEnabled",e),e||el("airShippingCost",null)},className:"flex-shrink-0"})]}),eo&&(0,s.jsxs)("div",{className:"space-y-3 pr-4 sm:pr-6 pt-3 border-t border-border/30",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)(n.Label,{htmlFor:"airShippingCost",className:"text-[10px] sm:text-xs md:text-sm font-medium flex items-center gap-1.5",children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5 text-muted-foreground"}),"هزینه ارسال هوایی"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(I.Badge,{variant:null===ep||0===ep?"success":"default",className:"flex items-center gap-1.5 px-3 py-1.5 text-[10px] sm:text-xs font-semibold shadow-sm",children:null===ep||0===ep?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"رایگان"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"پولی"})]})}),(0,s.jsx)(o.Switch,{checked:null!==ep&&0!==ep,onCheckedChange:e=>{e?el("airShippingCost",ep&&ep>0?ep:5e4):el("airShippingCost",null)},className:"flex-shrink-0"})]})]}),null!==ep&&0!==ep&&(0,s.jsxs)("div",{className:"space-y-2 bg-muted/30 p-3 rounded-lg border border-border/20",children:[(0,s.jsx)(l.Input,{id:"airShippingCost",type:"number",...et("airShippingCost",{valueAsNumber:!0}),placeholder:"مثال: 50000",min:1,className:"text-[11px] sm:text-xs md:text-sm bg-background"}),(0,s.jsxs)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(F.DollarSign,{className:"h-3 w-3"}),"هزینه ارسال به تومان"]})]}),er.airShippingCost&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive flex items-center gap-1",children:er.airShippingCost.message})]})]}),(0,s.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 sm:gap-4",children:[(0,s.jsxs)("div",{className:"space-y-0.5 flex-1 min-w-0",children:[(0,s.jsxs)(n.Label,{className:"text-[10px] sm:text-xs md:text-sm flex items-center gap-1.5",children:[(0,s.jsx)(P.Ship,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5"}),"ارسال دریایی"]}),(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground leading-tight",children:"امکان ارسال دریایی برای این محصول"})]}),(0,s.jsx)(o.Switch,{checked:em,onCheckedChange:e=>{el("seaShippingEnabled",e),e||el("seaShippingCost",null)},className:"flex-shrink-0"})]}),em&&(0,s.jsxs)("div",{className:"space-y-3 pr-4 sm:pr-6 pt-3 border-t border-border/30",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,s.jsxs)(n.Label,{htmlFor:"seaShippingCost",className:"text-[10px] sm:text-xs md:text-sm font-medium flex items-center gap-1.5",children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5 text-muted-foreground"}),"هزینه ارسال دریایی"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(I.Badge,{variant:null===ex||0===ex?"success":"default",className:"flex items-center gap-1.5 px-3 py-1.5 text-[10px] sm:text-xs font-semibold shadow-sm",children:null===ex||0===ex?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"رایگان"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.DollarSign,{className:"h-3.5 w-3.5"}),(0,s.jsx)("span",{children:"پولی"})]})}),(0,s.jsx)(o.Switch,{checked:null!==ex&&0!==ex,onCheckedChange:e=>{e?el("seaShippingCost",ex&&ex>0?ex:5e4):el("seaShippingCost",null)},className:"flex-shrink-0"})]})]}),null!==ex&&0!==ex&&(0,s.jsxs)("div",{className:"space-y-2 bg-muted/30 p-3 rounded-lg border border-border/20",children:[(0,s.jsx)(l.Input,{id:"seaShippingCost",type:"number",...et("seaShippingCost",{valueAsNumber:!0}),placeholder:"مثال: 50000",min:1,className:"text-[11px] sm:text-xs md:text-sm bg-background"}),(0,s.jsxs)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(F.DollarSign,{className:"h-3 w-3"}),"هزینه ارسال به تومان"]})]}),er.seaShippingCost&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive flex items-center gap-1",children:er.seaShippingCost.message})]})]}),er.airShippingEnabled&&(0,s.jsx)("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-destructive leading-tight",children:er.airShippingEnabled.message})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t border-border/30",children:[(0,s.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>N.back(),size:"lg",children:"انصراف"}),(0,s.jsx)(i.Button,{type:"submit",disabled:ei,size:"lg",className:"min-w-[140px]",children:ei?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.Loader2,{className:"ml-2 h-4 w-4 animate-spin"}),"در حال ذخیره..."]}):e?"ذخیره تغییرات":"افزودن محصول"})]})]})}e.s(["ProductForm",()=>D],23787)},36185,e=>{"use strict";var s=e.i(43476),t=e.i(23787),a=e.i(70065),r=e.i(17513),i=e.i(71645);function l(){let{loadCategoriesFromDB:e}=(0,r.useCategoryStore)();return(0,i.useEffect)(()=>{e()},[e]),(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)(a.Card,{children:[(0,s.jsx)(a.CardHeader,{children:(0,s.jsx)(a.CardTitle,{children:"فرم محصول"})}),(0,s.jsx)(a.CardContent,{children:(0,s.jsx)(t.ProductForm,{})})]})})}e.s(["default",()=>l])}]);