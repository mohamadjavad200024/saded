module.exports=[25173,a=>{"use strict";var b=a.i(33915),c=a.i(62435);let d=(0,b.create)()((0,c.persist)((a,b)=>({user:null,isAuthenticated:!1,register:async(b,c,d)=>{let e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b,phone:c,password:d})}),f=await e.json();if(!f.success)throw Error(f.error||"خطا در ثبت‌نام");a({user:{id:f.data.user.id,name:f.data.user.name,phone:f.data.user.phone,createdAt:f.data.user.createdAt},isAuthenticated:!0})},login:async(b,c)=>{let d=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:b,password:c})}),e=await d.json();return!!e.success&&(a({user:{id:e.data.user.id,name:e.data.user.name,phone:e.data.user.phone,role:e.data.user.role,createdAt:e.data.user.createdAt},isAuthenticated:!0}),!0)},logout:()=>{a({user:null,isAuthenticated:!1})},updateUser:c=>{let{user:d}=b();d&&a({user:{...d,...c}})},loadUser:async b=>{try{let c=await fetch(`/api/auth/me?userId=${b}`),d=await c.json();d.success&&d.data.user&&a({user:{id:d.data.user.id,name:d.data.user.name,phone:d.data.user.phone,role:d.data.user.role,createdAt:d.data.user.createdAt},isAuthenticated:!0})}catch(a){console.error("Error loading user:",a)}}}),{name:"saded_auth",storage:(0,c.createJSONStorage)(()=>localStorage),partialize:a=>({user:a.user,isAuthenticated:a.isAuthenticated})}));a.s(["useAuthStore",0,d])},48464,79808,8406,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);a.s(["Car",()=>c],48464);let d=(0,b.default)("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);a.s(["Wrench",()=>d],79808);let e=(0,b.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);a.s(["Sparkles",()=>e],8406)},45431,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(87532),e=a.i(38784),f=a.i(46842),g=a.i(72692),h=a.i(33508),i=a.i(20005),j=a.i(40695),k=a.i(5522),l=a.i(50944),m=a.i(97895),n=a.i(48464),o=a.i(79808),p=a.i(8406),q=a.i(21161);let r=[{name:"خانه",href:"/",icon:n.Car},{name:"محصولات",href:"/products",icon:o.Wrench},{name:"دسته‌بندی‌ها",href:"/categories",icon:p.Sparkles},{name:"خدمات",href:"/services",icon:q.Settings}];function s({mobile:a=!1,onNavigate:d}){let e=(0,l.usePathname)();return a?(0,b.jsx)("nav",{className:"flex flex-col space-y-2",children:r.map(a=>{let f=a.icon,g=e===a.href;return(0,b.jsxs)(c.default,{href:a.href,onClick:d,className:(0,m.cn)("flex items-center space-x-3 space-x-reverse px-4 py-3 rounded-lg text-base font-medium transition-colors",g?"bg-primary text-primary-foreground":"text-foreground hover:bg-accent hover:text-accent-foreground"),children:[(0,b.jsx)(f,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:a.name})]},a.href)})}):(0,b.jsx)("nav",{className:"hidden lg:flex items-center space-x-1 space-x-reverse",children:r.map(a=>{let d=a.icon,f=e===a.href;return(0,b.jsxs)(c.default,{href:a.href,className:(0,m.cn)("flex items-center space-x-2 space-x-reverse px-3 xl:px-4 py-2 rounded-md text-sm font-medium transition-colors",f?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[(0,b.jsx)(d,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden xl:inline",children:a.name})]},a.href)})})}var t=a.i(82329),u=a.i(25173),v=a.i(72131),w=a.i(70106);let x=(0,w.default)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),y=(0,w.default)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);var z=a.i(13902);function A(){let{theme:a,setTheme:c,resolvedTheme:d}=(0,z.useTheme)(),[e,f]=v.useState(!1);if(v.useEffect(()=>{f(!0)},[]),!e)return(0,b.jsxs)(j.Button,{variant:"ghost",size:"icon",className:"h-9 w-9",children:[(0,b.jsx)(y,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"تغییر تم"})]});let g="dark"===d||"dark"===a;return(0,b.jsxs)(j.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 relative",onClick:()=>{c("dark"===(d||("system"===a?"light":a))?"light":"dark")},type:"button",children:[(0,b.jsx)(y,{className:`h-5 w-5 absolute transition-all duration-300 ${g?"rotate-90 scale-0 opacity-0":"rotate-0 scale-100 opacity-100"}`}),(0,b.jsx)(x,{className:`h-5 w-5 absolute transition-all duration-300 ${g?"rotate-0 scale-100 opacity-100":"-rotate-90 scale-0 opacity-0"}`}),(0,b.jsx)("span",{className:"sr-only",children:"تغییر تم"})]})}var B=a.i(53071),C=a.i(76504);function D(){let[a,l]=(0,v.useState)(""),[m,n]=(0,v.useState)(!1),[o,p]=(0,v.useState)(!1),[q,r]=(0,v.useState)(!1),{getItemCount:w,initializeSession:x,loadFromDatabase:y,items:z}=(0,t.useCartStore)(),{user:D,isAuthenticated:E,logout:F}=(0,u.useAuthStore)(),G=z.reduce((a,b)=>a+b.quantity,0);return(0,v.useEffect)(()=>{r(!0),(async()=>{try{x(),await y()}catch(a){console.error("Error initializing cart in header:",a)}})()},[x,y]),(0,b.jsxs)("header",{className:"sticky top-0 z-50 w-full border-b-[0.25px] border-border/30 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,b.jsxs)("div",{className:"container flex h-14 sm:h-16 items-center justify-between px-3 sm:px-4",children:[(0,b.jsx)(c.default,{href:"/",className:"flex items-center space-x-1.5 space-x-reverse min-w-0 flex-shrink-0",children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xl sm:text-2xl font-bold text-primary leading-tight",children:"ساد"}),(0,b.jsx)("span",{className:"hidden sm:block text-[10px] sm:text-xs text-muted-foreground leading-tight",children:"قطعات خودرو وارداتی"})]})}),(0,b.jsx)("div",{className:"hidden lg:block",children:(0,b.jsx)(s,{})}),(0,b.jsx)("div",{className:"hidden lg:flex flex-1 max-w-xl mx-8",children:(0,b.jsxs)("div",{className:"relative w-full",children:[(0,b.jsx)(d.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,b.jsx)(k.Input,{type:"search",placeholder:"جستجوی قطعه، برند یا شماره VIN...",value:a,onChange:a=>l(a.target.value),className:"pr-10 w-full h-9"})]})}),(0,b.jsxs)("div",{className:"flex items-center space-x-1 space-x-reverse flex-shrink-0",children:[(0,b.jsxs)(j.Button,{variant:"ghost",size:"icon",className:"lg:hidden h-9 w-9",onClick:()=>p(!o),children:[(0,b.jsx)(d.Search,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"جستجو"})]}),(0,b.jsx)(A,{}),E&&D?(0,b.jsxs)(C.DropdownMenu,{children:[(0,b.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(j.Button,{variant:"ghost",size:"icon",className:"hidden md:flex h-9 w-9",children:[(0,b.jsx)(f.User,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"حساب کاربری"})]})}),(0,b.jsxs)(C.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,b.jsxs)("div",{className:"px-2 py-1.5",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:D.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:D.phone})]}),(0,b.jsx)(C.DropdownMenuSeparator,{}),(0,b.jsx)(C.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(c.default,{href:"/profile",className:"cursor-pointer",children:[(0,b.jsx)(f.User,{className:"ml-2 h-4 w-4"}),"پروفایل"]})}),(0,b.jsx)(C.DropdownMenuSeparator,{}),(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>{F()},className:"cursor-pointer text-destructive focus:text-destructive",children:[(0,b.jsx)(i.LogOut,{className:"ml-2 h-4 w-4"}),"خروج"]})]})]}):(0,b.jsx)(c.default,{href:"/auth",children:(0,b.jsxs)(j.Button,{variant:"ghost",size:"icon",className:"hidden md:flex h-9 w-9",children:[(0,b.jsx)(f.User,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"حساب کاربری"})]})}),(0,b.jsx)(c.default,{href:"/cart","aria-label":q?`سبد خرید با ${G} آیتم`:"سبد خرید",children:(0,b.jsxs)(j.Button,{variant:"ghost",size:"icon",className:"relative h-9 w-9","aria-label":q&&G>0?`سبد خرید (${G} آیتم)`:"سبد خرید",children:[(0,b.jsx)(e.ShoppingCart,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"سبد خرید"}),q&&G>0&&(0,b.jsx)("span",{className:"absolute -top-0.5 -left-0.5 h-4 w-4 sm:h-5 sm:w-5 rounded-full bg-secondary text-secondary-foreground text-[10px] sm:text-xs font-bold flex items-center justify-center","aria-label":`${G} آیتم در سبد خرید`,children:G>99?"99+":G})]})}),(0,b.jsxs)(B.Sheet,{open:m,onOpenChange:n,children:[(0,b.jsx)(B.SheetTrigger,{asChild:!0,children:(0,b.jsxs)(j.Button,{variant:"ghost",size:"icon",className:"lg:hidden h-9 w-9",children:[(0,b.jsx)(g.Menu,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"منو"})]})}),(0,b.jsxs)(B.SheetContent,{side:"right",className:"w-[280px] sm:w-[320px]",children:[(0,b.jsx)(B.SheetHeader,{children:(0,b.jsx)(B.SheetTitle,{children:"منو"})}),(0,b.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,b.jsx)(s,{mobile:!0,onNavigate:()=>n(!1)}),(0,b.jsxs)("div",{className:"pt-4 border-t-[0.25px] border-border/30 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"تم"}),(0,b.jsx)(A,{})]}),E&&D?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"px-2 py-1.5 border-b border-border/30",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:D.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:D.phone})]}),(0,b.jsx)(c.default,{href:"/profile",children:(0,b.jsxs)(j.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>n(!1),children:[(0,b.jsx)(f.User,{className:"h-4 w-4 ml-2"}),"پروفایل"]})}),(0,b.jsxs)(j.Button,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive",onClick:()=>{F(),n(!1)},children:[(0,b.jsx)(i.LogOut,{className:"h-4 w-4 ml-2"}),"خروج"]})]}):(0,b.jsx)(c.default,{href:"/auth",children:(0,b.jsxs)(j.Button,{variant:"ghost",className:"w-full justify-start",onClick:()=>n(!1),children:[(0,b.jsx)(f.User,{className:"h-4 w-4 ml-2"}),"حساب کاربری"]})})]})]})]})]})]})]}),o&&(0,b.jsx)("div",{className:"lg:hidden border-t-[0.25px] border-border/30 px-3 py-2 bg-background animate-in slide-in-from-top",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(d.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,b.jsx)(k.Input,{type:"search",placeholder:"جستجو...",value:a,onChange:a=>l(a.target.value),className:"pr-10 h-9",autoFocus:!0}),(0,b.jsx)(j.Button,{variant:"ghost",size:"icon",className:"absolute left-1 top-1/2 transform -translate-y-1/2 h-7 w-7",onClick:()=>p(!1),children:(0,b.jsx)(h.X,{className:"h-4 w-4"})})]})})]})}a.s(["Header",()=>D],45431)},33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},15618,a=>{"use strict";let b=(0,a.i(70106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},81560,a=>{"use strict";let b=(0,a.i(70106).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);a.s(["Trash2",()=>b],81560)},3130,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},77687,a=>{"use strict";var b=a.i(72131);let c=0,d=new Map,e=a=>{if(d.has(a))return;let b=setTimeout(()=>{d.delete(a),h({type:"REMOVE_TOAST",toastId:a})},1e6);d.set(a,b)},f=[],g={toasts:[]};function h(a){g=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":{let{toastId:c}=b;return c?e(c):a.toasts.forEach(a=>{e(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===c||void 0===c?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)}}})(g,a),f.forEach(a=>{a(g)})}function i({...a}){let b=(c=(c+1)%Number.MAX_SAFE_INTEGER).toString(),d=()=>h({type:"DISMISS_TOAST",toastId:b});return h({type:"ADD_TOAST",toast:{...a,id:b,open:!0,onOpenChange:a=>{a||d()}}}),{id:b,dismiss:d,update:a=>h({type:"UPDATE_TOAST",toast:{...a,id:b}})}}function j(){let[a,c]=b.useState(g);return b.useEffect(()=>(f.push(c),()=>{let a=f.indexOf(c);a>-1&&f.splice(a,1)}),[a]),{...a,toast:i,dismiss:a=>h({type:"DISMISS_TOAST",toastId:a})}}a.s(["useToast",()=>j])},60421,a=>{"use strict";var b=a.i(33915),c=a.i(54917);let d={},e=(0,b.create)((a,b)=>({products:[],filters:d,setProducts:b=>a({products:b}),addProduct:b=>a(a=>{let c=a.products.findIndex(a=>a.id===b.id);if(c>=0){let d=[...a.products];return d[c]=b,{products:d}}return{products:[...a.products,b]}}),updateProduct:b=>a(a=>{let c=a.products.findIndex(a=>a.id===b.id);if(c>=0){let d=[...a.products];return d[c]=b,{products:d}}return a}),removeProduct:b=>a(a=>({products:a.products.filter(a=>a.id!==b)})),getProduct:a=>b().products.find(b=>b.id===a),getEnabledProducts:()=>b().products.filter(a=>a.enabled),getFilteredProducts:()=>{let{products:a,filters:c}=b(),d=a.filter(a=>a.enabled);if(c.search){let a=c.search.toLowerCase();d=d.filter(b=>b.name.toLowerCase().includes(a)||b.description?.toLowerCase().includes(a)||b.brand?.toLowerCase().includes(a))}return void 0!==c.minPrice&&(d=d.filter(a=>a.price>=c.minPrice)),void 0!==c.maxPrice&&(d=d.filter(a=>a.price<=c.maxPrice)),c.brands&&c.brands.length>0&&(d=d.filter(a=>a.brand&&c.brands.includes(a.brand))),c.categories&&c.categories.length>0&&(d=d.filter(a=>a.category&&c.categories.includes(a.category))),void 0!==c.inStock&&(d=d.filter(a=>a.inStock===c.inStock)),d},setFilters:b=>a(a=>({filters:{...a.filters,...b}})),clearFilters:()=>a({filters:d}),createProduct:async a=>{let c=await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!c.ok)throw Error((await c.json().catch(()=>({}))).message||"خطا در ایجاد محصول");let d=(await c.json()).data;return b().addProduct(d),d},updateProductInDB:async(a,c)=>{let d=await fetch(`/api/products/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok)throw Error((await d.json().catch(()=>({}))).message||"خطا در به‌روزرسانی محصول");let e=(await d.json()).data;return b().updateProduct(e),e},deleteProductFromDB:async a=>{let c=await fetch(`/api/products/${a}`,{method:"DELETE"});if(!c.ok)throw Error((await c.json().catch(()=>({}))).message||"خطا در حذف محصول");b().removeProduct(a)},loadProductsFromDB:async(a=!1)=>{try{let c=await fetch(a?"/api/products?limit=1000&all=true":"/api/products?limit=1000");if(!c.ok){let a=await c.json().catch(()=>({})),b=a.error||a.message||"خطا در بارگذاری محصولات";throw Error(b)}let d=((await c.json()).data||[]).map(a=>({...a,createdAt:a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt),updatedAt:a.updatedAt instanceof Date?a.updatedAt:new Date(a.updatedAt)}));b().setProducts(d)}catch(a){c.logger.error("Error loading products from DB:",a)}},deleteProduct:async a=>{await b().deleteProductFromDB(a)},deleteProducts:async a=>{await Promise.all(a.map(a=>b().deleteProductFromDB(a)))},toggleProduct:async a=>{let c=b().getProduct(a);c&&await b().updateProductInDB(a,{enabled:!c.enabled})},toggleProducts:async(a,c)=>{await Promise.all(a.map(a=>b().updateProductInDB(a,{enabled:c})))}}));a.s(["useProductStore",0,e])},50180,71081,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);a.s(["Plane",()=>c],50180);let d=(0,b.default)("Ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]);a.s(["Ship",()=>d],71081)},99859,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(82329),e=a.i(60421),f=a.i(3130),g=a.i(40695),h=a.i(81560),i=a.i(15618);let j=(0,a.i(70106).default)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var k=a.i(78987),l=a.i(50180),m=a.i(71081),n=a.i(71987),o=a.i(38246),p=a.i(77687);function q(){let{items:a,updateQuantity:q,removeItem:r,getTotal:s,clearCart:t,shippingMethod:u,setShippingMethod:v,initializeSession:w,loadFromDatabase:x}=(0,d.useCartStore)(),{getProduct:y,loadProductsFromDB:z}=(0,e.useProductStore)(),{toast:A}=(0,p.useToast)(),[B,C]=(0,c.useState)(u),[D,E]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{E(!0);try{w(),await z(),await x()}catch(a){console.error("Error initializing cart:",a)}finally{E(!1)}})()},[w,x,z]);let F=a=>{if(a.image&&""!==a.image.trim()&&(!a.image.startsWith("data:image")||!(a.image.length>5e4)))return a.image;let b=y(a.id);return b&&b.images&&b.images.length>0?(console.log("Using product image for cart item:",{itemId:a.id,productImage:b.images[0]?.substring(0,50)}),b.images[0]):null},G=(a,b)=>{try{q(a,b)}catch(a){a?.name==="QuotaExceededError"||a?.message?.includes("quota")?A({title:"خطا در ذخیره",description:"فضای ذخیره‌سازی پر شده است. لطفاً برخی از محصولات را از سبد خرید حذف کنید.",variant:"destructive"}):A({title:"خطا",description:"خطایی در به‌روزرسانی تعداد محصول رخ داد. لطفاً دوباره تلاش کنید.",variant:"destructive"})}};(0,c.useEffect)(()=>{u&&C(u)},[u]);let H=u||B,I=a=>{C(a),v(a)},J=a.reduce((a,b)=>{let c=y(b.id);return c?(c.airShippingEnabled?a.air=(a.air??!0)&&!0:a.air=!1,c.seaShippingEnabled?a.sea=(a.sea??!0)&&!0:a.sea=!1):(a.air=a.air??!0,a.sea=a.sea??!0),a},{air:void 0,sea:void 0}),K=!0===J.air,L=!0===J.sea;if((0,c.useEffect)(()=>{0!==a.length&&(H?"air"!==H||K?"sea"!==H||L||(K?(C("air"),v("air")):(C(null),v(null))):L?(C("sea"),v("sea")):(C(null),v(null)):(K||L)&&(K?(C("air"),v("air")):L&&(C("sea"),v("sea"))))},[K,L,H,v,a.length]),D)return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 sm:py-20 px-4",children:[(0,b.jsx)("div",{className:"h-12 w-12 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"}),(0,b.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold mb-2 text-center",children:"در حال بارگذاری سبد خرید..."})]});if(0===a.length)return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 sm:py-20 px-4",children:[(0,b.jsx)(k.ShoppingBag,{className:"h-16 w-16 sm:h-24 sm:w-24 text-muted-foreground mb-4"}),(0,b.jsx)("h2",{className:"text-xl sm:text-2xl font-bold mb-2 text-center",children:"سبد خرید شما خالی است"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground mb-6 text-center",children:"محصولات مورد نظر خود را به سبد خرید اضافه کنید"}),(0,b.jsx)(o.default,{href:"/products",children:(0,b.jsx)(g.Button,{size:"lg",className:"h-11 sm:h-12",children:"مشاهده محصولات"})})]});let M=s(),N=(()=>{if(!H||0===a.length)return 0;let b=0;for(let c of a){let a=y(c.id);if(a){let c="air"===H?a.airShippingCost??null:a.seaShippingCost??null;null!==c&&c>b&&(b=c)}}return 0===b?M>5e5?0:5e4:b})(),O=M+N;return(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8",children:[(0,b.jsx)("div",{className:"lg:col-span-2 space-y-0",children:a.map((c,d)=>(0,b.jsx)("div",{className:`p-3 sm:p-4 md:p-6 ${d<a.length-1?"border-b-[0.25px] border-border/30":""}`,children:(0,b.jsxs)("div",{className:"flex gap-3 sm:gap-4",children:[(0,b.jsx)("div",{className:"relative w-20 h-20 sm:w-24 sm:h-24 bg-muted rounded-lg overflow-hidden flex-shrink-0",children:F(c)?(0,b.jsx)(n.default,{src:F(c),alt:`${c.name} - سبد خرید`,fill:!0,className:"object-cover",onError:a=>{let b=a.target;b.style.display="none";let c=b.parentElement;if(c&&!c.querySelector(".image-placeholder")){let a=document.createElement("div");a.className="image-placeholder w-full h-full flex items-center justify-center text-muted-foreground",a.innerHTML='<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>',c.appendChild(a)}}}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:(0,b.jsx)(k.ShoppingBag,{className:"h-8 w-8"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"font-semibold mb-2 text-sm sm:text-base line-clamp-2",children:c.name}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center border-[0.25px] border-border/30 rounded-md",children:[(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 sm:h-9 sm:w-9",onClick:()=>G(c.id,c.quantity-1),children:(0,b.jsx)(j,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})}),(0,b.jsx)("span",{className:"w-10 sm:w-12 text-center text-sm sm:text-base",children:c.quantity}),(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 sm:h-9 sm:w-9",onClick:()=>G(c.id,c.quantity+1),children:(0,b.jsx)(i.Plus,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]}),(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",onClick:()=>r(c.id),className:"text-destructive h-8 w-8 sm:h-9 sm:w-9",children:(0,b.jsx)(h.Trash2,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"text-base sm:text-lg font-bold",children:[(c.price*c.quantity).toLocaleString("fa-IR")," ","تومان"]})]})]})]})},c.id))}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(f.Card,{className:"sticky top-20 sm:top-24",children:[(0,b.jsx)(f.CardHeader,{className:"p-4 sm:p-6 pb-3 sm:pb-4",children:(0,b.jsx)(f.CardTitle,{className:"text-lg sm:text-xl",children:"خلاصه سفارش"})}),(0,b.jsxs)(f.CardContent,{className:"space-y-3 sm:space-y-4 p-4 sm:p-6 pt-0",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm sm:text-base",children:[(0,b.jsx)("span",{children:"جمع کل:"}),(0,b.jsxs)("span",{className:"font-semibold",children:[M.toLocaleString("fa-IR")," تومان"]})]}),(K||L)&&(0,b.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,b.jsx)("div",{className:"text-sm sm:text-base font-medium",children:"روش ارسال:"}),(0,b.jsxs)("div",{className:`grid gap-2 sm:gap-3 ${K&&L?"grid-cols-2":"grid-cols-1"}`,children:[K&&(0,b.jsxs)("button",{onClick:()=>I("air"),className:`flex flex-col items-center justify-center gap-2 p-3 sm:p-4 rounded-lg border-[0.25px] transition-all ${"air"===H?"border-primary/30 bg-primary/5":"border-border/30 hover:border-primary/20"}`,children:[(0,b.jsx)(l.Plane,{className:`h-5 w-5 sm:h-6 sm:w-6 ${"air"===H?"text-primary":"text-muted-foreground"}`}),(0,b.jsx)("span",{className:`text-xs sm:text-sm font-medium ${"air"===H?"text-primary":"text-foreground"}`,children:"هوایی"})]}),L&&(0,b.jsxs)("button",{onClick:()=>I("sea"),className:`flex flex-col items-center justify-center gap-2 p-3 sm:p-4 rounded-lg border-[0.25px] transition-all ${"sea"===H?"border-primary/30 bg-primary/5":"border-border/30 hover:border-primary/20"}`,children:[(0,b.jsx)(m.Ship,{className:`h-5 w-5 sm:h-6 sm:w-6 ${"sea"===H?"text-primary":"text-muted-foreground"}`}),(0,b.jsx)("span",{className:`text-xs sm:text-sm font-medium ${"sea"===H?"text-primary":"text-foreground"}`,children:"دریایی"})]})]})]}),!K&&!L&&(0,b.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,b.jsx)("div",{className:"text-sm sm:text-base font-medium",children:"روش ارسال:"}),(0,b.jsx)("div",{className:"p-3 sm:p-4 rounded-lg border-[0.25px] border-border/30 bg-muted/30",children:(0,b.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground text-center",children:"روش ارسال برای محصولات موجود در سبد خرید توسط مدیر در زمان ارسال مشخص خواهد شد"})})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm sm:text-base",children:[(0,b.jsx)("span",{children:"هزینه ارسال:"}),(0,b.jsx)("span",{className:"font-semibold",children:0===N?(0,b.jsx)("span",{className:"text-green-600",children:"رایگان"}):`${N.toLocaleString("fa-IR")} تومان`})]}),N>0&&5e4===N&&M<5e5&&(0,b.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground leading-relaxed",children:["برای ارسال رایگان، ",(5e5-M).toLocaleString("fa-IR")," تومان دیگر به سبد خرید خود اضافه کنید"]}),(0,b.jsxs)("div",{className:"border-t-[0.25px] border-border/30 pt-3 sm:pt-4 flex justify-between text-base sm:text-lg font-bold",children:[(0,b.jsx)("span",{children:"مبلغ نهایی:"}),(0,b.jsxs)("span",{children:[O.toLocaleString("fa-IR")," تومان"]})]}),(0,b.jsxs)("div",{className:"flex gap-2 sm:gap-3 min-w-0",children:[(0,b.jsx)(o.default,{href:"/checkout",className:"flex-1 min-w-0",children:(0,b.jsx)(g.Button,{className:"w-full h-11 sm:h-12 text-xs sm:text-sm",size:"lg",children:"ادامه خرید"})}),(0,b.jsx)(g.Button,{variant:"outline",className:"h-11 sm:h-12 text-xs sm:text-sm whitespace-nowrap flex-shrink-0",size:"lg",onClick:()=>{},children:"ارسال فاکتور خرید"})]}),(0,b.jsx)(g.Button,{variant:"outline",className:"w-full h-10 sm:h-11 text-sm sm:text-base",onClick:t,children:"پاک کردن سبد خرید"})]})]})})]})}a.s(["CartContent",()=>q],99859)}];

//# sourceMappingURL=_f290d799._.js.map