module.exports=[65066,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(25173),f=a.i(40695),g=a.i(5522),h=a.i(17171),i=a.i(77687),j=a.i(46842),k=a.i(43108),l=a.i(77156),m=a.i(41379),n=a.i(83497),o=a.i(45222),p=a.i(20005),q=a.i(67453),r=a.i(92e3),s=a.i(13749),t=a.i(24987),u=a.i(65733);function v(){let{user:a,logout:v,updateUser:w}=(0,e.useAuthStore)(),{toast:x}=(0,i.useToast)(),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)({name:"",phone:""}),[M,N]=(0,c.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[O,P]=(0,c.useState)({});(0,c.useEffect)(()=>{a&&L({name:a.name||"",phone:a?.phone||""})},[a]);let Q=async()=>{let b;if(b={},K.name.trim()?K.name.trim().length<2&&(b.name="نام باید حداقل 2 کاراکتر باشد"):b.name="نام الزامی است",K.phone.trim()?/^09\d{9}$/.test(K.phone.trim())||(b.phone="شماره تماس باید با 09 شروع شود و 11 رقم باشد"):b.phone="شماره تماس الزامی است",P(b),0!==Object.keys(b).length)return void x({title:"خطا",description:"لطفاً خطاهای فرم را برطرف کنید",variant:"destructive"});if(!a?.id)return void x({title:"خطا",description:"کاربر یافت نشد",variant:"destructive"});D(!0);try{let b=await fetch(`/api/users/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:K.name.trim(),phone:K.phone.trim()})}),c=await b.json();if(!b.ok||!c.success)throw Error(c.error||c.message||"خطا در به‌روزرسانی اطلاعات");w({name:K.name.trim(),phone:K.phone.trim()}),z(!1),x({title:"موفق",description:"اطلاعات با موفقیت به‌روزرسانی شد"})}catch(a){x({title:"خطا",description:a.message||"خطا در به‌روزرسانی اطلاعات",variant:"destructive"})}finally{D(!1)}},R=async()=>{let b;if(b={},M.currentPassword||(b.currentPassword="رمز عبور فعلی الزامی است"),M.newPassword?M.newPassword.length<6&&(b.newPassword="رمز عبور باید حداقل 6 کاراکتر باشد"):b.newPassword="رمز عبور جدید الزامی است",M.confirmPassword?M.newPassword!==M.confirmPassword&&(b.confirmPassword="رمز عبور و تکرار آن یکسان نیستند"):b.confirmPassword="تکرار رمز عبور الزامی است",P(b),0!==Object.keys(b).length)return void x({title:"خطا",description:"لطفاً خطاهای فرم را برطرف کنید",variant:"destructive"});if(!a?.id)return void x({title:"خطا",description:"کاربر یافت نشد",variant:"destructive"});D(!0);try{let b=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({phone:a?.phone,password:M.currentPassword})}),c=await b.json();if(!b.ok||!c.success)throw P({currentPassword:"رمز عبور فعلی اشتباه است"}),Error("رمز عبور فعلی اشتباه است");let d=await fetch(`/api/users/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:M.newPassword})}),e=await d.json();if(!d.ok||!e.success)throw Error(e.error||e.message||"خطا در تغییر رمز عبور");N({currentPassword:"",newPassword:"",confirmPassword:""}),B(!1),F(!1),H(!1),J(!1),x({title:"موفق",description:"رمز عبور با موفقیت تغییر کرد"})}catch(a){"رمز عبور فعلی اشتباه است"!==a.message&&x({title:"خطا",description:a.message||"خطا در تغییر رمز عبور",variant:"destructive"})}finally{D(!1)}};return a?(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("div",{className:"bg-gradient-to-br from-primary via-primary/90 to-primary/80 text-primary-foreground",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-8 sm:py-12",children:(0,b.jsxs)("div",{className:"flex flex-col items-center text-center space-y-4",children:[(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)("div",{className:"w-24 h-24 sm:w-28 sm:h-28 rounded-full bg-primary-foreground/20 backdrop-blur-sm border-4 border-primary-foreground/30 flex items-center justify-center text-3xl sm:text-4xl font-bold text-primary-foreground",children:(a.name||"U").split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold",children:a.name||"کاربر"}),(0,b.jsx)("p",{className:"text-primary-foreground/80 text-sm sm:text-base mt-1",children:a?.phone||"-"})]})]})})}),(0,b.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-2xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h2",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3 px-1",children:"حساب کاربری و امنیت"}),(0,b.jsxs)("div",{className:"bg-card rounded-lg border border-border/30 divide-y divide-border/30",children:[(0,b.jsxs)("button",{onClick:()=>z(!0),className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(j.User,{className:"h-5 w-5 text-primary"})}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"پروفایل"})]}),(0,b.jsx)(s.ChevronLeft,{className:"h-5 w-5 text-muted-foreground"})]}),(0,b.jsxs)(d.default,{href:"/profile/address",className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(t.MapPin,{className:"h-5 w-5 text-primary"})}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"آدرس"})]}),(0,b.jsx)(s.ChevronLeft,{className:"h-5 w-5 text-muted-foreground"})]}),(0,b.jsxs)("button",{onClick:()=>B(!0),className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(k.Lock,{className:"h-5 w-5 text-primary"})}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"رمز عبور"})]}),(0,b.jsx)(s.ChevronLeft,{className:"h-5 w-5 text-muted-foreground"})]})]})]}),(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h2",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3 px-1",children:"تنظیمات"}),(0,b.jsxs)("div",{className:"bg-card rounded-lg border border-border/30 divide-y divide-border/30",children:[(0,b.jsxs)(d.default,{href:"/orders",className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(n.Package,{className:"h-5 w-5 text-primary"})}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"سفارش‌های من"})]}),(0,b.jsx)(s.ChevronLeft,{className:"h-5 w-5 text-muted-foreground"})]}),(0,b.jsxs)(d.default,{href:"/chat",className:"w-full flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(o.MessageCircle,{className:"h-5 w-5 text-primary"})}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"پشتیبانی"})]}),(0,b.jsx)(s.ChevronLeft,{className:"h-5 w-5 text-muted-foreground"})]})]})]}),(0,b.jsxs)("button",{onClick:()=>v(),className:"w-full flex items-center justify-center gap-2 p-4 bg-destructive/10 hover:bg-destructive/20 text-destructive rounded-lg transition-colors font-medium",children:[(0,b.jsx)(p.LogOut,{className:"h-5 w-5"}),"خروج از حساب"]})]}),(0,b.jsx)(u.Dialog,{open:y,onOpenChange:z,children:(0,b.jsxs)(u.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsx)(u.DialogHeader,{children:(0,b.jsx)(u.DialogTitle,{children:"ویرایش پروفایل"})}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"edit-name",children:"نام"}),(0,b.jsx)(g.Input,{id:"edit-name",value:K.name,onChange:a=>{L({...K,name:a.target.value}),O.name&&P({...O,name:void 0})},placeholder:"نام خود را وارد کنید",className:O.name?"border-destructive":""}),O.name&&(0,b.jsxs)("p",{className:"text-xs text-destructive flex items-center gap-1",children:[(0,b.jsx)(r.AlertCircle,{className:"h-3 w-3"}),O.name]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"edit-phone",children:"شماره تماس"}),(0,b.jsx)(g.Input,{id:"edit-phone",type:"tel",value:K.phone,onChange:a=>{let b=a.target.value.replace(/\D/g,"");L({...K,phone:b}),O.phone&&P({...O,phone:void 0})},placeholder:"09123456789",maxLength:11,className:O.phone?"border-destructive":""}),O.phone&&(0,b.jsxs)("p",{className:"text-xs text-destructive flex items-center gap-1",children:[(0,b.jsx)(r.AlertCircle,{className:"h-3 w-3"}),O.phone]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(f.Button,{onClick:Q,disabled:C,className:"flex-1",children:C?"در حال ذخیره...":"ذخیره"}),(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>{a&&L({name:a.name||"",phone:a?.phone||""}),P({}),z(!1)},disabled:C,children:"لغو"})]})]})]})}),(0,b.jsx)(u.Dialog,{open:A,onOpenChange:B,children:(0,b.jsxs)(u.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsx)(u.DialogHeader,{children:(0,b.jsx)(u.DialogTitle,{children:"تغییر رمز عبور"})}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"current-password",children:"رمز عبور فعلی"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(g.Input,{id:"current-password",type:E?"text":"password",value:M.currentPassword,onChange:a=>{N({...M,currentPassword:a.target.value}),O.currentPassword&&P({...O,currentPassword:void 0})},placeholder:"رمز عبور فعلی را وارد کنید",className:`pr-10 ${O.currentPassword?"border-destructive":""}`}),(0,b.jsx)(f.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>F(!E),children:E?(0,b.jsx)(m.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(l.Eye,{className:"h-4 w-4 text-muted-foreground"})})]}),O.currentPassword&&(0,b.jsxs)("p",{className:"text-xs text-destructive flex items-center gap-1",children:[(0,b.jsx)(r.AlertCircle,{className:"h-3 w-3"}),O.currentPassword]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"new-password",children:"رمز عبور جدید"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(g.Input,{id:"new-password",type:G?"text":"password",value:M.newPassword,onChange:a=>{N({...M,newPassword:a.target.value}),O.newPassword&&P({...O,newPassword:void 0})},placeholder:"رمز عبور جدید را وارد کنید",className:`pr-10 ${O.newPassword?"border-destructive":""}`,minLength:6}),(0,b.jsx)(f.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>H(!G),children:G?(0,b.jsx)(m.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(l.Eye,{className:"h-4 w-4 text-muted-foreground"})})]}),O.newPassword&&(0,b.jsxs)("p",{className:"text-xs text-destructive flex items-center gap-1",children:[(0,b.jsx)(r.AlertCircle,{className:"h-3 w-3"}),O.newPassword]}),M.newPassword&&!O.newPassword&&M.newPassword.length>=6&&(0,b.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:[(0,b.jsx)(q.CheckCircle2,{className:"h-3 w-3"}),"رمز عبور معتبر است"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"confirm-password",children:"تکرار رمز عبور جدید"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(g.Input,{id:"confirm-password",type:I?"text":"password",value:M.confirmPassword,onChange:a=>{N({...M,confirmPassword:a.target.value}),O.confirmPassword&&P({...O,confirmPassword:void 0})},placeholder:"رمز عبور جدید را دوباره وارد کنید",className:`pr-10 ${O.confirmPassword?"border-destructive":""}`}),(0,b.jsx)(f.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>J(!I),children:I?(0,b.jsx)(m.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(l.Eye,{className:"h-4 w-4 text-muted-foreground"})})]}),O.confirmPassword&&(0,b.jsxs)("p",{className:"text-xs text-destructive flex items-center gap-1",children:[(0,b.jsx)(r.AlertCircle,{className:"h-3 w-3"}),O.confirmPassword]}),M.confirmPassword&&!O.confirmPassword&&M.newPassword===M.confirmPassword&&M.confirmPassword.length>=6&&(0,b.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1",children:[(0,b.jsx)(q.CheckCircle2,{className:"h-3 w-3"}),"رمز عبورها یکسان هستند"]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(f.Button,{onClick:R,disabled:C,className:"flex-1",children:C?"در حال تغییر...":"تغییر رمز عبور"}),(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>{N({currentPassword:"",newPassword:"",confirmPassword:""}),P({}),B(!1),F(!1),H(!1),J(!1)},disabled:C,children:"لغو"})]})]})]})})]}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center px-4",children:(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"لطفاً ابتدا وارد حساب کاربری خود شوید"}),(0,b.jsx)(f.Button,{asChild:!0,children:(0,b.jsx)(d.default,{href:"/auth",children:"ورود / ثبت‌نام"})})]})})}function w(){return(0,b.jsx)(v,{})}a.s(["default",()=>w])}];

//# sourceMappingURL=app_profile_page_tsx_d7e3fb30._.js.map