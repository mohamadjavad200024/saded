module.exports=[78170,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(50944),e=a.i(97895),f=a.i(70106);let g=(0,f.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var h=a.i(83497),i=a.i(38784),j=a.i(60246),k=a.i(21161);let l=(0,f.default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var m=a.i(33508),n=a.i(10227),o=a.i(54624),p=a.i(48464),q=a.i(40695),r=a.i(46470),s=a.i(53071),t=a.i(72131);let u=[{title:"داشبورد",href:"/admin",icon:g},{title:"محصولات",href:"/admin/products",icon:h.Package},{title:"سفارشات",href:"/admin/orders",icon:i.ShoppingCart,disabled:!1},{title:"کاربران",href:"/admin/users",icon:j.Users,disabled:!1},{title:"تامین‌کنندگان",href:"/admin/suppliers",icon:n.Truck,disabled:!1},{title:"دسته‌بندی‌ها",href:"/admin/categories",icon:o.FolderTree,disabled:!1},{title:"خودروها",href:"/admin/vehicles",icon:p.Car,disabled:!1},{title:"تنظیمات",href:"/admin/settings",icon:k.Settings,disabled:!1}];function v({className:a}){let f=(0,d.usePathname)(),[h,i]=(0,t.useState)(!1),j=()=>(0,b.jsxs)("div",{className:"flex flex-col h-full",children:[(0,b.jsx)("div",{className:"p-6 border-b border-border/30 bg-gradient-to-br from-primary/5 to-primary/10",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-primary text-primary-foreground",children:(0,b.jsx)(g,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-primary",children:"پنل مدیریت"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"فروشگاه ساد"})]})]})}),(0,b.jsx)(r.ScrollArea,{className:"flex-1",children:(0,b.jsx)("nav",{className:"p-4 space-y-1",children:u.map(a=>{let d=a.icon,g=f===a.href||"/admin"!==a.href&&f?.startsWith(a.href),h=a.disabled;return(0,b.jsxs)(c.default,{href:h?"#":a.href,onClick:()=>i(!1),className:(0,e.cn)("flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200",g?"bg-primary text-primary-foreground shadow-sm":"text-foreground hover:bg-accent hover:text-accent-foreground hover:translate-x-[-2px]",h&&"opacity-50 cursor-not-allowed"),children:[(0,b.jsx)(d,{className:"h-5 w-5 flex-shrink-0"}),(0,b.jsx)("span",{children:a.title}),h&&(0,b.jsx)("span",{className:"mr-auto text-xs opacity-60",children:"(به زودی)"})]},a.href)})})}),(0,b.jsx)("div",{className:"p-4 border-t border-border/30",children:(0,b.jsx)(c.default,{href:"/",children:(0,b.jsxs)(q.Button,{variant:"outline",className:"w-full justify-start gap-2",children:[(0,b.jsx)(m.X,{className:"h-4 w-4"}),"بازگشت به سایت"]})})})]});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("aside",{className:(0,e.cn)("hidden lg:flex flex-col w-64 border-l border-border/30 bg-background/95 backdrop-blur",a),children:(0,b.jsx)(j,{})}),(0,b.jsx)(s.Sheet,{open:h,onOpenChange:i,children:(0,b.jsxs)(s.SheetContent,{side:"right",className:"w-64 p-0",children:[(0,b.jsx)(s.SheetHeader,{className:"sr-only",children:(0,b.jsx)(s.SheetTitle,{children:"منوی مدیریت"})}),(0,b.jsx)(j,{})]})}),(0,b.jsx)(q.Button,{variant:"ghost",size:"icon",className:"lg:hidden fixed top-4 left-4 z-50",onClick:()=>i(!0),children:(0,b.jsx)(l,{className:"h-5 w-5"})})]})}var w=a.i(298),x=a.i(76504),y=a.i(65733),z=a.i(46842),A=a.i(20005),B=a.i(23312),C=a.i(87532),D=a.i(43108),E=a.i(45222),F=a.i(77156),G=a.i(41379),H=a.i(67453),I=a.i(96221),J=a.i(5522),K=a.i(17171),L=a.i(77687);function M({onSearch:a}){let[c,d]=(0,t.useState)(!1),[e,f]=(0,t.useState)(!1),[g,h]=(0,t.useState)(0),[i,j]=(0,t.useState)(!1),[k,l]=(0,t.useState)(""),[m,n]=(0,t.useState)(""),[o,p]=(0,t.useState)(""),[r,s]=(0,t.useState)(!1),[u,v]=(0,t.useState)(!1),[M,N]=(0,t.useState)(!1),[O,P]=(0,t.useState)(!1),{toast:Q}=(0,L.useToast)();(0,t.useEffect)(()=>{d(!0)},[]);let R=(0,t.useCallback)(async()=>{try{let a=await fetch("/api/chat/unread-count?all=true");if(a.ok){let b=await a.json();if(b.success&&b.data?.chats){let a=b.data.chats.reduce((a,b)=>a+(b.unreadCount||0),0);h(a)}}}catch(a){console.error("Error fetching unread count:",a)}},[]);(0,t.useEffect)(()=>{R();let a=setInterval(()=>{R()},e?1e4:5e3);return()=>clearInterval(a)},[R,e]),(0,t.useEffect)(()=>{R()},[e,R]);let S=async a=>{if(a.preventDefault(),!m.trim())return void Q({title:"خطا",description:"لطفاً رمز عبور جدید را وارد کنید",variant:"destructive"});if(m.length<6)return void Q({title:"خطا",description:"رمز عبور باید حداقل 6 کاراکتر باشد",variant:"destructive"});if(m!==o)return void Q({title:"خطا",description:"رمز عبور جدید و تأیید آن مطابقت ندارند",variant:"destructive"});P(!0);try{let a=await fetch("/api/admin/password",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:m,currentPassword:k||void 0})}),b=await a.json();b.success?(Q({title:"موفق",description:"رمز عبور با موفقیت تغییر کرد"}),l(""),n(""),p(""),j(!1)):Q({title:"خطا",description:b.error||"خطا در تغییر رمز عبور",variant:"destructive"})}catch(a){Q({title:"خطا",description:a.message||"خطا در اتصال به سرور",variant:"destructive"})}finally{P(!1)}},T=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),window.location.href="/admin/login"}catch(a){console.error("Logout error:",a),window.location.href="/admin/login"}};return(0,b.jsxs)("header",{className:"sticky top-0 z-40 w-full border-b border-border/30 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex h-16 items-center gap-4 px-4 lg:px-6",children:[a&&(0,b.jsx)("div",{className:"flex-1 max-w-md",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(C.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(J.Input,{type:"search",placeholder:"جستجو...",className:"pr-10",onChange:b=>a(b.target.value)})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mr-auto",children:[(0,b.jsxs)(q.Button,{variant:"ghost",size:"icon",onClick:()=>f(!0),className:"relative",title:"چت با کاربران",children:[(0,b.jsx)(E.MessageCircle,{className:"h-5 w-5"}),g>0&&(0,b.jsx)("span",{className:"absolute -top-1 -right-1 h-5 w-5 rounded-full bg-destructive text-white text-xs font-bold flex items-center justify-center border-2 border-background shadow-sm",children:"!"})]}),(0,b.jsxs)(q.Button,{variant:"ghost",size:"icon",className:"relative",children:[(0,b.jsx)(B.Bell,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"absolute top-1 left-1 h-2 w-2 rounded-full bg-destructive"})]}),c?(0,b.jsxs)(x.DropdownMenu,{children:[(0,b.jsx)(x.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(q.Button,{variant:"ghost",size:"icon",className:"rounded-full",children:(0,b.jsx)(z.User,{className:"h-5 w-5"})})}),(0,b.jsxs)(x.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,b.jsx)(x.DropdownMenuLabel,{children:"حساب کاربری"}),(0,b.jsx)(x.DropdownMenuSeparator,{}),(0,b.jsxs)(x.DropdownMenuItem,{onClick:()=>j(!0),children:[(0,b.jsx)(D.Lock,{className:"ml-2 h-4 w-4"}),"تغییر رمز عبور"]}),(0,b.jsx)(x.DropdownMenuSeparator,{}),(0,b.jsxs)(x.DropdownMenuItem,{className:"text-destructive",onClick:T,children:[(0,b.jsx)(A.LogOut,{className:"ml-2 h-4 w-4"}),"خروج"]})]})]}):(0,b.jsx)(q.Button,{variant:"ghost",size:"icon",className:"rounded-full",disabled:!0,children:(0,b.jsx)(z.User,{className:"h-5 w-5"})})]})]}),(0,b.jsx)(w.AdminChat,{isOpen:e,onOpenChange:f}),(0,b.jsx)(y.Dialog,{open:i,onOpenChange:j,children:(0,b.jsxs)(y.DialogContent,{className:"max-w-md",children:[(0,b.jsx)(y.DialogHeader,{children:(0,b.jsxs)(y.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(D.Lock,{className:"h-5 w-5"}),"تغییر رمز عبور ادمین"]})}),(0,b.jsxs)("form",{onSubmit:S,className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(K.Label,{htmlFor:"currentPassword",children:"رمز عبور فعلی (اختیاری برای اولین بار)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(J.Input,{id:"currentPassword",type:r?"text":"password",placeholder:"رمز عبور فعلی را وارد کنید",value:k,onChange:a=>l(a.target.value),disabled:O,className:"pr-10"}),(0,b.jsx)(q.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>s(!r),disabled:O,children:r?(0,b.jsx)(G.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(F.Eye,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(K.Label,{htmlFor:"newPassword",children:["رمز عبور جدید ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(J.Input,{id:"newPassword",type:u?"text":"password",placeholder:"رمز عبور جدید را وارد کنید (حداقل 6 کاراکتر)",value:m,onChange:a=>n(a.target.value),disabled:O,className:"pr-10",minLength:6}),(0,b.jsx)(q.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v(!u),disabled:O,children:u?(0,b.jsx)(G.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(F.Eye,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(K.Label,{htmlFor:"confirmPassword",children:["تأیید رمز عبور جدید ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(J.Input,{id:"confirmPassword",type:M?"text":"password",placeholder:"رمز عبور جدید را دوباره وارد کنید",value:o,onChange:a=>p(a.target.value),disabled:O,className:"pr-10"}),(0,b.jsx)(q.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute left-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>N(!M),disabled:O,children:M?(0,b.jsx)(G.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(F.Eye,{className:"h-4 w-4"})})]}),o&&m!==o&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:"رمز عبور جدید و تأیید آن مطابقت ندارند"}),o&&m===o&&m.length>=6&&(0,b.jsxs)("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[(0,b.jsx)(H.CheckCircle2,{className:"h-4 w-4"}),"رمز عبور جدید معتبر است"]})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,b.jsx)(q.Button,{type:"button",variant:"outline",className:"flex-1",onClick:()=>{j(!1),l(""),n(""),p("")},disabled:O,children:"انصراف"}),(0,b.jsx)(q.Button,{type:"submit",className:"flex-1",disabled:O||!m||m!==o||m.length<6,children:O?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(I.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"در حال تغییر..."]}):"تغییر رمز عبور"})]})]})]})})]})}var N=a.i(92776),O=a.i(60421),P=a.i(410),Q=a.i(65602),R=a.i(54161),S=a.i(73570),T=a.i(11156),U=a.i(13749);function V(){let{suppliers:a}=(0,N.useSupplierStore)(),{products:d}=(0,O.useProductStore)(),{orders:e}=(0,P.useOrderStore)(),[f,g]=(0,t.useState)(new Set),j=(0,t.useMemo)(()=>{let b=[],c=new Date;c.setDate(c.getDate()+2),c.setHours(23,59,59,999);let f=new Date;f.setHours(0,0,0,0);let g=[];a.forEach(a=>{a.transactions?.forEach(b=>{if("check"===b.paymentMethod&&b.checkDetails){let d=new Date(b.checkDetails.dueDate);d.setHours(0,0,0,0),d>=f&&d<=c&&g.push({supplierName:a.name,checkNumber:b.checkDetails.checkNumber,dueDate:b.checkDetails.dueDate,amount:b.totalAmount})}})}),g.length>0&&b.push({id:"upcoming-checks",type:"check",title:"چک‌های نزدیک به سررسید",description:`${g.length} چک در 2 روز آینده سررسید می‌شود`,count:g.length,link:"/admin/suppliers",severity:"high"});let h=d.filter(a=>a.stockCount<=10);h.length>0&&b.push({id:"low-stock",type:"lowStock",title:"موجودی کم",description:`${h.length} محصول موجودی کم دارد`,count:h.length,link:"/admin/products",severity:"high"});let i=new Date;i.setHours(i.getHours()-24);let j=e.filter(a=>new Date(a.createdAt)>=i&&"cancelled"!==a.status);return j.length>0&&b.push({id:"new-orders",type:"newOrder",title:"سفارش‌های جدید",description:`${j.length} سفارش جدید در 24 ساعت گذشته`,count:j.length,link:"/admin/orders",severity:"medium"}),b},[a,d,e]).filter(a=>!f.has(a.id));return 0===j.length?null:(0,b.jsx)("div",{className:"border-b border-border/30 bg-background/95 backdrop-blur",children:(0,b.jsx)("div",{className:"px-4 lg:px-6 py-3 space-y-2",children:j.map(a=>{var d;return(0,b.jsxs)(Q.Alert,{variant:(d=a.severity,"check"===a.type?"warning":"high"===d?"destructive":"default"),className:"flex items-center justify-between gap-4 py-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(a=>{switch(a){case"check":return(0,b.jsx)(T.CreditCard,{className:"h-5 w-5"});case"lowStock":return(0,b.jsx)(h.Package,{className:"h-5 w-5"});case"newOrder":return(0,b.jsx)(i.ShoppingCart,{className:"h-5 w-5"});default:return(0,b.jsx)(S.AlertTriangle,{className:"h-5 w-5"})}})(a.type)}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)(Q.AlertTitle,{className:"flex items-center gap-2 mb-1",children:[a.title,(0,b.jsx)(R.Badge,{variant:"secondary",className:"text-xs",children:a.count})]}),(0,b.jsx)(Q.AlertDescription,{children:a.description})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.link&&(0,b.jsx)(q.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsxs)(c.default,{href:a.link,children:["مشاهده",(0,b.jsx)(U.ChevronLeft,{className:"h-4 w-4 mr-1"})]})}),(0,b.jsx)(q.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{g(b=>new Set(b).add(a.id))},children:(0,b.jsx)(m.X,{className:"h-4 w-4"})})]})]},a.id)})})})}var W=a.i(35112),X=a.i(7554),Y=a.i(70121),Z=a.i(37738),$=a.i(50104),_=a.i(96743),aa=a.i(92616),ab=a.i(77192),ac=a.i(30553),ad=a.i(46872),ae=a.i(25152),af=a.i(72752),ag=a.i(28094),ah="ToastProvider",[ai,aj,ak]=(0,Z.createCollection)("Toast"),[al,am]=(0,$.createContextScope)("Toast",[ak]),[an,ao]=al(ah),ap=a=>{let{__scopeToast:c,label:d="Notification",duration:e=5e3,swipeDirection:f="right",swipeThreshold:g=50,children:h}=a,[i,j]=t.useState(null),[k,l]=t.useState(0),m=t.useRef(!1),n=t.useRef(!1);return d.trim()||console.error(`Invalid prop \`label\` supplied to \`${ah}\`. Expected non-empty \`string\`.`),(0,b.jsx)(ai.Provider,{scope:c,children:(0,b.jsx)(an,{scope:c,label:d,duration:e,swipeDirection:f,swipeThreshold:g,toastCount:k,viewport:i,onViewportChange:j,onToastAdd:t.useCallback(()=>l(a=>a+1),[]),onToastRemove:t.useCallback(()=>l(a=>a-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:n,children:h})})};ap.displayName=ah;var aq="ToastViewport",ar=["F8"],as="toast.viewportPause",at="toast.viewportResume",au=t.forwardRef((a,c)=>{let{__scopeToast:d,hotkey:e=ar,label:f="Notifications ({hotkey})",...g}=a,h=ao(aq,d),i=aj(d),j=t.useRef(null),k=t.useRef(null),l=t.useRef(null),m=t.useRef(null),n=(0,Y.useComposedRefs)(c,m,h.onViewportChange),o=e.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=h.toastCount>0;t.useEffect(()=>{let a=a=>{0!==e.length&&e.every(b=>a[b]||a.code===b)&&m.current?.focus()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[e]),t.useEffect(()=>{let a=j.current,b=m.current;if(p&&a&&b){let c=()=>{if(!h.isClosePausedRef.current){let a=new CustomEvent(as);b.dispatchEvent(a),h.isClosePausedRef.current=!0}},d=()=>{if(h.isClosePausedRef.current){let a=new CustomEvent(at);b.dispatchEvent(a),h.isClosePausedRef.current=!1}},e=b=>{a.contains(b.relatedTarget)||d()},f=()=>{a.contains(document.activeElement)||d()};return a.addEventListener("focusin",c),a.addEventListener("focusout",e),a.addEventListener("pointermove",c),a.addEventListener("pointerleave",f),window.addEventListener("blur",c),window.addEventListener("focus",d),()=>{a.removeEventListener("focusin",c),a.removeEventListener("focusout",e),a.removeEventListener("pointermove",c),a.removeEventListener("pointerleave",f),window.removeEventListener("blur",c),window.removeEventListener("focus",d)}}},[p,h.isClosePausedRef]);let q=t.useCallback(({tabbingDirection:a})=>{let b=i().map(b=>{let c=b.ref.current,d=[c,...function(a){let b=[],c=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{let b="INPUT"===a.tagName&&"hidden"===a.type;return a.disabled||a.hidden||b?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;c.nextNode();)b.push(c.currentNode);return b}(c)];return"forwards"===a?d:d.reverse()});return("forwards"===a?b.reverse():b).flat()},[i]);return t.useEffect(()=>{let a=m.current;if(a){let b=b=>{let c=b.altKey||b.ctrlKey||b.metaKey;if("Tab"===b.key&&!c){let c=document.activeElement,d=b.shiftKey;if(b.target===a&&d)return void k.current?.focus();let e=q({tabbingDirection:d?"backwards":"forwards"}),f=e.findIndex(a=>a===c);aM(e.slice(f+1))?b.preventDefault():d?k.current?.focus():l.current?.focus()}};return a.addEventListener("keydown",b),()=>a.removeEventListener("keydown",b)}},[i,q]),(0,b.jsxs)(_.Branch,{ref:j,role:"region","aria-label":f.replace("{hotkey}",o),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&(0,b.jsx)(aw,{ref:k,onFocusFromOutsideViewport:()=>{aM(q({tabbingDirection:"forwards"}))}}),(0,b.jsx)(ai.Slot,{scope:d,children:(0,b.jsx)(ac.Primitive.ol,{tabIndex:-1,...g,ref:n})}),p&&(0,b.jsx)(aw,{ref:l,onFocusFromOutsideViewport:()=>{aM(q({tabbingDirection:"backwards"}))}})]})});au.displayName=aq;var av="ToastFocusProxy",aw=t.forwardRef((a,c)=>{let{__scopeToast:d,onFocusFromOutsideViewport:e,...f}=a,g=ao(av,d);return(0,b.jsx)(ag.VisuallyHidden,{tabIndex:0,...f,ref:c,style:{position:"fixed"},onFocus:a=>{let b=a.relatedTarget;g.viewport?.contains(b)||e()}})});aw.displayName=av;var ax="Toast",ay=t.forwardRef((a,c)=>{let{forceMount:d,open:e,defaultOpen:f,onOpenChange:g,...h}=a,[i,j]=(0,ae.useControllableState)({prop:e,defaultProp:f??!0,onChange:g,caller:ax});return(0,b.jsx)(ab.Presence,{present:d||i,children:(0,b.jsx)(aB,{open:i,...h,ref:c,onClose:()=>j(!1),onPause:(0,ad.useCallbackRef)(a.onPause),onResume:(0,ad.useCallbackRef)(a.onResume),onSwipeStart:(0,X.composeEventHandlers)(a.onSwipeStart,a=>{a.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:(0,X.composeEventHandlers)(a.onSwipeMove,a=>{let{x:b,y:c}=a.detail.delta;a.currentTarget.setAttribute("data-swipe","move"),a.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${b}px`),a.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${c}px`)}),onSwipeCancel:(0,X.composeEventHandlers)(a.onSwipeCancel,a=>{a.currentTarget.setAttribute("data-swipe","cancel"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),a.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),a.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:(0,X.composeEventHandlers)(a.onSwipeEnd,a=>{let{x:b,y:c}=a.detail.delta;a.currentTarget.setAttribute("data-swipe","end"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),a.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${b}px`),a.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${c}px`),j(!1)})})})});ay.displayName=ax;var[az,aA]=al(ax,{onClose(){}}),aB=t.forwardRef((a,c)=>{let{__scopeToast:d,type:e="foreground",duration:f,open:g,onClose:h,onEscapeKeyDown:i,onPause:j,onResume:k,onSwipeStart:l,onSwipeMove:m,onSwipeCancel:n,onSwipeEnd:o,...p}=a,q=ao(ax,d),[r,s]=t.useState(null),u=(0,Y.useComposedRefs)(c,a=>s(a)),v=t.useRef(null),w=t.useRef(null),x=f||q.duration,y=t.useRef(0),z=t.useRef(x),A=t.useRef(0),{onToastAdd:B,onToastRemove:C}=q,D=(0,ad.useCallbackRef)(()=>{r?.contains(document.activeElement)&&q.viewport?.focus(),h()}),E=t.useCallback(a=>{a&&a!==1/0&&(window.clearTimeout(A.current),y.current=new Date().getTime(),A.current=window.setTimeout(D,a))},[D]);t.useEffect(()=>{let a=q.viewport;if(a){let b=()=>{E(z.current),k?.()},c=()=>{let a=new Date().getTime()-y.current;z.current=z.current-a,window.clearTimeout(A.current),j?.()};return a.addEventListener(as,c),a.addEventListener(at,b),()=>{a.removeEventListener(as,c),a.removeEventListener(at,b)}}},[q.viewport,x,j,k,E]),t.useEffect(()=>{g&&!q.isClosePausedRef.current&&E(x)},[g,x,q.isClosePausedRef,E]),t.useEffect(()=>(B(),()=>C()),[B,C]);let F=t.useMemo(()=>r?function a(b){let c=[];return Array.from(b.childNodes).forEach(b=>{var d;if(b.nodeType===b.TEXT_NODE&&b.textContent&&c.push(b.textContent),(d=b).nodeType===d.ELEMENT_NODE){let d=b.ariaHidden||b.hidden||"none"===b.style.display,e=""===b.dataset.radixToastAnnounceExclude;if(!d)if(e){let a=b.dataset.radixToastAnnounceAlt;a&&c.push(a)}else c.push(...a(b))}}),c}(r):null,[r]);return q.viewport?(0,b.jsxs)(b.Fragment,{children:[F&&(0,b.jsx)(aC,{__scopeToast:d,role:"status","aria-live":"foreground"===e?"assertive":"polite",children:F}),(0,b.jsx)(az,{scope:d,onClose:D,children:W.createPortal((0,b.jsx)(ai.ItemSlot,{scope:d,children:(0,b.jsx)(_.Root,{asChild:!0,onEscapeKeyDown:(0,X.composeEventHandlers)(i,()=>{q.isFocusedToastEscapeKeyDownRef.current||D(),q.isFocusedToastEscapeKeyDownRef.current=!1}),children:(0,b.jsx)(ac.Primitive.li,{tabIndex:0,"data-state":g?"open":"closed","data-swipe-direction":q.swipeDirection,...p,ref:u,style:{userSelect:"none",touchAction:"none",...a.style},onKeyDown:(0,X.composeEventHandlers)(a.onKeyDown,a=>{"Escape"===a.key&&(i?.(a.nativeEvent),a.nativeEvent.defaultPrevented||(q.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:(0,X.composeEventHandlers)(a.onPointerDown,a=>{0===a.button&&(v.current={x:a.clientX,y:a.clientY})}),onPointerMove:(0,X.composeEventHandlers)(a.onPointerMove,a=>{if(!v.current)return;let b=a.clientX-v.current.x,c=a.clientY-v.current.y,d=!!w.current,e=["left","right"].includes(q.swipeDirection),f=["left","up"].includes(q.swipeDirection)?Math.min:Math.max,g=e?f(0,b):0,h=e?0:f(0,c),i="touch"===a.pointerType?10:2,j={x:g,y:h},k={originalEvent:a,delta:j};d?(w.current=j,aK("toast.swipeMove",m,k,{discrete:!1})):aL(j,q.swipeDirection,i)?(w.current=j,aK("toast.swipeStart",l,k,{discrete:!1}),a.target.setPointerCapture(a.pointerId)):(Math.abs(b)>i||Math.abs(c)>i)&&(v.current=null)}),onPointerUp:(0,X.composeEventHandlers)(a.onPointerUp,a=>{let b=w.current,c=a.target;if(c.hasPointerCapture(a.pointerId)&&c.releasePointerCapture(a.pointerId),w.current=null,v.current=null,b){let c=a.currentTarget,d={originalEvent:a,delta:b};aL(b,q.swipeDirection,q.swipeThreshold)?aK("toast.swipeEnd",o,d,{discrete:!0}):aK("toast.swipeCancel",n,d,{discrete:!0}),c.addEventListener("click",a=>a.preventDefault(),{once:!0})}})})})}),q.viewport)})]}):null}),aC=a=>{let{__scopeToast:c,children:d,...e}=a,f=ao(ax,c),[g,h]=t.useState(!1),[i,j]=t.useState(!1);return function(a=()=>{}){let b=(0,ad.useCallbackRef)(a);(0,af.useLayoutEffect)(()=>{let a=0,c=0;return a=window.requestAnimationFrame(()=>c=window.requestAnimationFrame(b)),()=>{window.cancelAnimationFrame(a),window.cancelAnimationFrame(c)}},[b])}(()=>h(!0)),t.useEffect(()=>{let a=window.setTimeout(()=>j(!0),1e3);return()=>window.clearTimeout(a)},[]),i?null:(0,b.jsx)(aa.Portal,{asChild:!0,children:(0,b.jsx)(ag.VisuallyHidden,{...e,children:g&&(0,b.jsxs)(b.Fragment,{children:[f.label," ",d]})})})},aD=t.forwardRef((a,c)=>{let{__scopeToast:d,...e}=a;return(0,b.jsx)(ac.Primitive.div,{...e,ref:c})});aD.displayName="ToastTitle";var aE=t.forwardRef((a,c)=>{let{__scopeToast:d,...e}=a;return(0,b.jsx)(ac.Primitive.div,{...e,ref:c})});aE.displayName="ToastDescription";var aF="ToastAction",aG=t.forwardRef((a,c)=>{let{altText:d,...e}=a;return d.trim()?(0,b.jsx)(aJ,{altText:d,asChild:!0,children:(0,b.jsx)(aI,{...e,ref:c})}):(console.error(`Invalid prop \`altText\` supplied to \`${aF}\`. Expected non-empty \`string\`.`),null)});aG.displayName=aF;var aH="ToastClose",aI=t.forwardRef((a,c)=>{let{__scopeToast:d,...e}=a,f=aA(aH,d);return(0,b.jsx)(aJ,{asChild:!0,children:(0,b.jsx)(ac.Primitive.button,{type:"button",...e,ref:c,onClick:(0,X.composeEventHandlers)(a.onClick,f.onClose)})})});aI.displayName=aH;var aJ=t.forwardRef((a,c)=>{let{__scopeToast:d,altText:e,...f}=a;return(0,b.jsx)(ac.Primitive.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":e||void 0,...f,ref:c})});function aK(a,b,c,{discrete:d}){let e=c.originalEvent.currentTarget,f=new CustomEvent(a,{bubbles:!0,cancelable:!0,detail:c});b&&e.addEventListener(a,b,{once:!0}),d?(0,ac.dispatchDiscreteCustomEvent)(e,f):e.dispatchEvent(f)}var aL=(a,b,c=0)=>{let d=Math.abs(a.x),e=Math.abs(a.y),f=d>e;return"left"===b||"right"===b?f&&d>c:!f&&e>c};function aM(a){let b=document.activeElement;return a.some(a=>a===b||(a.focus(),document.activeElement!==b))}var aN=a.i(187);let aO=t.forwardRef(({className:a,...c},d)=>(0,b.jsx)(au,{ref:d,className:(0,e.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...c}));aO.displayName=au.displayName;let aP=(0,aN.cva)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 space-x-reverse overflow-hidden rounded-md border-[0.25px] border-border/30 glass-morphism p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-right-full",{variants:{variant:{default:"border text-foreground",destructive:"destructive group border-destructive bg-destructive/90 backdrop-blur-md text-destructive-foreground"}},defaultVariants:{variant:"default"}}),aQ=t.forwardRef(({className:a,variant:c,...d},f)=>(0,b.jsx)(ay,{ref:f,className:(0,e.cn)(aP({variant:c}),a),...d}));aQ.displayName=ay.displayName,t.forwardRef(({className:a,...c},d)=>(0,b.jsx)(aG,{ref:d,className:(0,e.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border-[0.25px] border-border/30 bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...c})).displayName=aG.displayName;let aR=t.forwardRef(({className:a,...c},d)=>(0,b.jsx)(aI,{ref:d,className:(0,e.cn)("absolute left-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...c,children:(0,b.jsx)(m.X,{className:"h-4 w-4"})}));aR.displayName=aI.displayName;let aS=t.forwardRef(({className:a,...c},d)=>(0,b.jsx)(aD,{ref:d,className:(0,e.cn)("text-sm font-semibold",a),...c}));aS.displayName=aD.displayName;let aT=t.forwardRef(({className:a,...c},d)=>(0,b.jsx)(aE,{ref:d,className:(0,e.cn)("text-sm opacity-90",a),...c}));function aU(){let{toasts:a}=(0,L.useToast)();return(0,b.jsxs)(ap,{children:[a.map(function({id:a,title:c,description:d,action:e,...f}){return(0,b.jsxs)(aQ,{...f,children:[(0,b.jsxs)("div",{className:"grid gap-1",children:[c&&(0,b.jsx)(aS,{children:c}),d&&(0,b.jsx)(aT,{children:d})]}),e,(0,b.jsx)(aR,{})]},a)}),(0,b.jsx)(aO,{})]})}aT.displayName=aE.displayName;var aV=a.i(16591),aW=a.i(57576);function aX(){return(0,t.useEffect)(()=>(console.log("[AdminChatPolling] Component mounted, starting polling..."),()=>{console.log("[AdminChatPolling] Component unmounted, stopping polling...")}),[]),(0,aW.useGlobalChatPolling)({isUser:!1,onNewMessage:(a,b)=>{console.log("[AdminChatPolling] New message received:",a,b)}}),null}a.i(26621);var aY=a.i(30877),aZ=a.i(25173);function a$({children:a}){let c=(0,d.useRouter)(),e=(0,d.usePathname)(),{user:f,isAuthenticated:g,hasCheckedAuth:h,checkAuth:i}=(0,aZ.useAuthStore)(),[j,k]=(0,t.useState)(!0);return((0,t.useEffect)(()=>{if("/admin/login"===e)return void k(!1);if(h){if(!g||f?.role!=="admin")return void c.push("/admin/login");k(!1)}},[e,h,g,f,c]),(0,t.useEffect)(()=>{let a=document.body.style.overflow,b=document.body.style.height,c=document.documentElement.style.overflow,d=document.documentElement.style.height;return document.body.style.overflow="hidden",document.body.style.height="100vh",document.documentElement.style.overflow="hidden",document.documentElement.style.height="100vh",()=>{document.body.style.overflow=a,document.body.style.height=b,document.documentElement.style.overflow=c,document.documentElement.style.height=d}},[]),j&&"/admin/login"!==e)?(0,b.jsx)("div",{className:"h-screen w-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(I.Loader2,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"در حال بررسی دسترسی..."})]})}):"/admin/login"===e?(0,b.jsx)(b.Fragment,{children:a}):(0,b.jsx)(aV.ErrorBoundary,{children:(0,b.jsxs)("div",{className:"h-screen w-screen flex overflow-hidden",children:[(0,b.jsx)(v,{}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:[(0,b.jsx)(M,{}),(0,b.jsx)(V,{}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto overflow-x-hidden p-4 lg:p-6",children:a})]}),(0,b.jsx)(aU,{}),(0,b.jsx)(aX,{}),(0,b.jsx)(aY.NotificationCenter,{position:"top-right",maxNotifications:5})]})})}a.s(["default",()=>a$],78170)}];

//# sourceMappingURL=app_admin_layout_tsx_1751cc55._.js.map