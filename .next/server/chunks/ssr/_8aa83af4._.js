module.exports=[25173,a=>{"use strict";var b=a.i(33915),c=a.i(62435);let d=(0,b.create)()((0,c.persist)((a,b)=>({user:null,isAuthenticated:!1,register:async(b,c,d)=>{let e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b,phone:c,password:d})}),f=await e.json();if(!f.success)throw Error(f.error||"خطا در ثبت‌نام");a({user:{id:f.data.user.id,name:f.data.user.name,phone:f.data.user.phone,createdAt:f.data.user.createdAt},isAuthenticated:!0})},login:async(b,c)=>{let d=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:b,password:c})}),e=await d.json();return!!e.success&&(a({user:{id:e.data.user.id,name:e.data.user.name,phone:e.data.user.phone,role:e.data.user.role,createdAt:e.data.user.createdAt},isAuthenticated:!0}),!0)},logout:()=>{a({user:null,isAuthenticated:!1})},updateUser:c=>{let{user:d}=b();d&&a({user:{...d,...c}})},loadUser:async b=>{try{let c=await fetch(`/api/auth/me?userId=${b}`),d=await c.json();d.success&&d.data.user&&a({user:{id:d.data.user.id,name:d.data.user.name,phone:d.data.user.phone,role:d.data.user.role,createdAt:d.data.user.createdAt},isAuthenticated:!0})}catch(a){console.error("Error loading user:",a)}}}),{name:"saded_auth",storage:(0,c.createJSONStorage)(()=>localStorage),partialize:a=>({user:a.user,isAuthenticated:a.isAuthenticated})}));a.s(["useAuthStore",0,d])},63519,a=>{"use strict";let b=(0,a.i(70106).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);a.s(["Phone",()=>b],63519)},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},5522,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,type:c,...e},f)=>(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-10 w-full rounded-md border-[0.25px] border-input/30 bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:f,...e}));e.displayName="Input",a.s(["Input",()=>e])},3130,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border-[0.25px] border-border/3 bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},77687,a=>{"use strict";var b=a.i(72131);let c=0,d=new Map,e=a=>{if(d.has(a))return;let b=setTimeout(()=>{d.delete(a),h({type:"REMOVE_TOAST",toastId:a})},1e6);d.set(a,b)},f=[],g={toasts:[]};function h(a){g=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":{let{toastId:c}=b;return c?e(c):a.toasts.forEach(a=>{e(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===c||void 0===c?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)}}})(g,a),f.forEach(a=>{a(g)})}function i({...a}){let b=(c=(c+1)%Number.MAX_SAFE_INTEGER).toString(),d=()=>h({type:"DISMISS_TOAST",toastId:b});return h({type:"ADD_TOAST",toast:{...a,id:b,open:!0,onOpenChange:a=>{a||d()}}}),{id:b,dismiss:d,update:a=>h({type:"UPDATE_TOAST",toast:{...a,id:b}})}}function j(){let[a,c]=b.useState(g);return b.useEffect(()=>(f.push(c),()=>{let a=f.indexOf(c);a>-1&&f.splice(a,1)}),[a]),{...a,toast:i,dismiss:a=>h({type:"DISMISS_TOAST",toastId:a})}}a.s(["useToast",()=>j])},17171,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(35112);var d=a.i(11011),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{}),f=c.forwardRef((a,c)=>(0,b.jsx)(e.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));f.displayName="Label";var g=a.i(187),h=a.i(97895);let i=(0,g.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),j=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(f,{ref:d,className:(0,h.cn)(i(),a),...c}));j.displayName=f.displayName,a.s(["Label",()=>j],17171)},32860,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);a.s(["ArrowRight",()=>b],32860)},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},99084,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(3130),i=a.i(25173),j=a.i(77687),k=a.i(46842),l=a.i(63519);let m=(0,a.i(70106).default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var n=a.i(32860),o=a.i(210),p=a.i(46271),q=a.i(38246);function r(){let a=(0,d.useRouter)(),{toast:r}=(0,j.useToast)(),{register:s,login:t,isAuthenticated:u}=(0,i.useAuthStore)(),[v,w]=(0,c.useState)("login"),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)({name:"",phone:"",password:"",confirmPassword:""});if(u)return a.push("/"),null;let B=async b=>{b.preventDefault(),y(!0);try{if("register"===v){if(!z.name.trim()){r({title:"خطا",description:"لطفاً نام خود را وارد کنید",variant:"destructive"}),y(!1);return}if(!z.phone.trim()||z.phone.length<10){r({title:"خطا",description:"لطفاً شماره تماس معتبر وارد کنید",variant:"destructive"}),y(!1);return}if(z.password.length<6){r({title:"خطا",description:"رمز عبور باید حداقل 6 کاراکتر باشد",variant:"destructive"}),y(!1);return}if(z.password!==z.confirmPassword){r({title:"خطا",description:"رمز عبور و تکرار آن یکسان نیستند",variant:"destructive"}),y(!1);return}await s(z.name,z.phone,z.password),r({title:"ثبت‌نام موفق",description:"حساب کاربری شما با موفقیت ایجاد شد"}),a.push("/")}else{if(!z.phone.trim()||!z.password.trim()){r({title:"خطا",description:"لطفاً شماره تماس و رمز عبور را وارد کنید",variant:"destructive"}),y(!1);return}await t(z.phone,z.password)?(r({title:"ورود موفق",description:"به ساد خوش آمدید"}),a.push("/")):r({title:"خطا",description:"شماره تماس یا رمز عبور اشتباه است",variant:"destructive"})}}catch(a){r({title:"خطا",description:a.message||"خطایی رخ داد. لطفاً دوباره تلاش کنید",variant:"destructive"})}finally{y(!1)}};return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-background via-background to-muted/20",children:(0,b.jsx)(p.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:(0,b.jsxs)(h.Card,{className:"border-border/30 shadow-lg",children:[(0,b.jsxs)(h.CardHeader,{className:"space-y-1 text-center",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(k.User,{className:"h-8 w-8 text-primary"})})}),(0,b.jsx)(h.CardTitle,{className:"text-2xl font-bold",children:"login"===v?"ورود به حساب کاربری":"ثبت‌نام"}),(0,b.jsx)(h.CardDescription,{children:"login"===v?"برای ادامه وارد حساب کاربری خود شوید":"حساب کاربری جدید ایجاد کنید"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsxs)("form",{onSubmit:B,className:"space-y-4",children:["register"===v&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"name",className:"flex items-center gap-2",children:[(0,b.jsx)(k.User,{className:"h-4 w-4"}),"نام و نام خانوادگی"]}),(0,b.jsx)(f.Input,{id:"name",type:"text",placeholder:"مثال: علی احمدی",value:z.name,onChange:a=>A({...z,name:a.target.value}),required:"register"===v,className:"h-11"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"phone",className:"flex items-center gap-2",children:[(0,b.jsx)(l.Phone,{className:"h-4 w-4"}),"شماره تماس"]}),(0,b.jsx)(f.Input,{id:"phone",type:"tel",placeholder:"09123456789",value:z.phone,onChange:a=>A({...z,phone:a.target.value}),required:!0,className:"h-11"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"password",className:"flex items-center gap-2",children:[(0,b.jsx)(m,{className:"h-4 w-4"}),"رمز عبور"]}),(0,b.jsx)(f.Input,{id:"password",type:"password",placeholder:"حداقل 6 کاراکتر",value:z.password,onChange:a=>A({...z,password:a.target.value}),required:!0,minLength:"register"===v?6:void 0,className:"h-11"})]}),"register"===v&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"confirmPassword",className:"flex items-center gap-2",children:[(0,b.jsx)(m,{className:"h-4 w-4"}),"تکرار رمز عبور"]}),(0,b.jsx)(f.Input,{id:"confirmPassword",type:"password",placeholder:"رمز عبور را دوباره وارد کنید",value:z.confirmPassword,onChange:a=>A({...z,confirmPassword:a.target.value}),required:!0,className:"h-11"})]}),(0,b.jsx)(e.Button,{type:"submit",className:"w-full h-11 text-base font-semibold",disabled:x,children:x?"در حال پردازش...":"login"===v?(0,b.jsxs)(b.Fragment,{children:["ورود",(0,b.jsx)(o.ArrowLeft,{className:"h-4 w-4 mr-2"})]}):(0,b.jsxs)(b.Fragment,{children:["ثبت‌نام",(0,b.jsx)(n.ArrowRight,{className:"h-4 w-4 mr-2"})]})})]}),(0,b.jsx)("div",{className:"mt-6 text-center",children:(0,b.jsx)("button",{type:"button",onClick:()=>{w("login"===v?"register":"login"),A({name:"",phone:"",password:"",confirmPassword:""})},className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"login"===v?(0,b.jsxs)(b.Fragment,{children:["حساب کاربری ندارید؟"," ",(0,b.jsx)("span",{className:"text-primary font-semibold",children:"ثبت‌نام کنید"})]}):(0,b.jsxs)(b.Fragment,{children:["قبلاً ثبت‌نام کرده‌اید؟"," ",(0,b.jsx)("span",{className:"text-primary font-semibold",children:"وارد شوید"})]})})}),(0,b.jsx)("div",{className:"mt-4 text-center",children:(0,b.jsxs)(q.default,{href:"/",className:"text-sm text-muted-foreground hover:text-foreground transition-colors flex items-center justify-center gap-2",children:[(0,b.jsx)(n.ArrowRight,{className:"h-4 w-4"}),"بازگشت به صفحه اصلی"]})})]})]})})})}a.s(["default",()=>r],99084)}];

//# sourceMappingURL=_8aa83af4._.js.map