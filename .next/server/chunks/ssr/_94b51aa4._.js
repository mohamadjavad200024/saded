module.exports=[77994,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},67552,a=>{"use strict";let b=(0,a.i(70106).default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);a.s(["ChevronUp",()=>b],67552)},88237,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{className:"relative w-full overflow-auto",children:(0,b.jsx)("table",{ref:e,className:(0,d.cn)("w-full caption-bottom text-sm",a),...c})}));e.displayName="Table";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("thead",{ref:e,className:(0,d.cn)("[&_tr]:border-b border-border/30",a),...c}));f.displayName="TableHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tbody",{ref:e,className:(0,d.cn)("[&_tr:last-child]:border-0",a),...c}));g.displayName="TableBody",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tfoot",{ref:e,className:(0,d.cn)("border-t border-border/30 bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c})).displayName="TableFooter";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tr",{ref:e,className:(0,d.cn)("border-b border-border/30 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...c}));h.displayName="TableRow";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("th",{ref:e,className:(0,d.cn)("h-12 px-4 text-right align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));i.displayName="TableHead";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("td",{ref:e,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));j.displayName="TableCell",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("caption",{ref:e,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",a),...c})).displayName="TableCaption",a.s(["Table",()=>e,"TableBody",()=>g,"TableCell",()=>j,"TableHead",()=>i,"TableHeader",()=>f,"TableRow",()=>h])},17755,a=>{"use strict";let b=(0,a.i(70106).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);a.s(["MoreHorizontal",()=>b],17755)},81464,a=>{"use strict";let b=(0,a.i(70106).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);a.s(["Filter",()=>b],81464)},84505,a=>{"use strict";let b=(0,a.i(70106).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);a.s(["Download",()=>b],84505)},3314,a=>{"use strict";let b=(0,a.i(70106).default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);a.s(["Shield",()=>b],3314)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},43592,a=>{"use strict";var b=a.i(33915),c=a.i(54917);let d={},e=(0,b.create)((a,b)=>({users:[],filters:d,isLoading:!1,setUsers:b=>a({users:b}),addUser:b=>a(a=>{let c=a.users.findIndex(a=>a.id===b.id);if(c>=0){let d=[...a.users];return d[c]=b,{users:d}}return{users:[...a.users,b]}}),updateUser:(b,c)=>a(a=>{let d=a.users.findIndex(a=>a.id===b);if(d>=0){let b=[...a.users];return b[d]={...b[d],...c,updatedAt:new Date},{users:b}}return a}),updateUserStatus:(b,c)=>a(a=>({users:a.users.map(a=>a.id===b?{...a,status:c,updatedAt:new Date}:a)})),updateUserRole:(b,c)=>a(a=>({users:a.users.map(a=>a.id===b?{...a,role:c,updatedAt:new Date}:a)})),deleteUser:b=>a(a=>({users:a.users.filter(a=>a.id!==b)})),getUser:a=>b().users.find(b=>b.id===a),setFilters:b=>a(a=>({filters:{...a.filters,...b}})),clearFilters:()=>a({filters:d}),loadUsersFromDB:async()=>{a({isLoading:!0});try{let a=await fetch("/api/users?limit=1000",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!a.ok){let b=await a.json().catch(()=>({})),c=b.error||b.message||"خطا در بارگذاری کاربران";throw Error(c)}let d=await a.json();if(d.success&&d.data){let a=d.data.map(a=>({id:a.id,name:a.name,email:a.email,phone:a.phone||void 0,role:a.role||"user",status:a.status||(1===a.enabled||!0===a.enabled?"active":"inactive"),avatar:a.avatar||void 0,ordersCount:a.ordersCount||void 0,totalSpent:a.totalSpent||void 0,createdAt:a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt),updatedAt:a.updatedAt instanceof Date?a.updatedAt:new Date(a.updatedAt)}));b().setUsers(a),c.logger.info(`✅ Loaded ${a.length} users from database`)}else b().setUsers([]),c.logger.info("No users found in database")}catch(a){c.logger.error("Error loading users from DB:",a),b().setUsers([])}finally{a({isLoading:!1})}}}));a.s(["useUserStore",0,e])},47468,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(88237),e=a.i(40695),f=a.i(54161),g=a.i(76504),h=a.i(17755),i=a.i(46842),j=a.i(3314),k=a.i(56468),l=a.i(16201),m=a.i(43592),n=a.i(77687),o=a.i(65733);let p={admin:"مدیر",user:"کاربر",moderator:"ناظر"},q={active:"فعال",inactive:"غیرفعال",suspended:"معلق"},r={admin:"destructive",user:"default",moderator:"secondary"},s={active:"success",inactive:"secondary",suspended:"warning"};function t({users:a,onRefresh:t}){let{updateUserStatus:u,updateUserRole:v,deleteUser:w}=(0,m.useUserStore)(),{toast:x}=(0,n.useToast)(),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"rounded-lg border border-border/30 shadow-sm overflow-hidden",children:(0,b.jsxs)(d.Table,{children:[(0,b.jsx)(d.TableHeader,{className:"bg-muted/50",children:(0,b.jsxs)(d.TableRow,{children:[(0,b.jsx)(d.TableHead,{children:"نام"}),(0,b.jsx)(d.TableHead,{children:"ایمیل"}),(0,b.jsx)(d.TableHead,{children:"تلفن"}),(0,b.jsx)(d.TableHead,{children:"نقش"}),(0,b.jsx)(d.TableHead,{children:"وضعیت"}),(0,b.jsx)(d.TableHead,{children:"سفارشات"}),(0,b.jsx)(d.TableHead,{children:"خرید کل"}),(0,b.jsx)(d.TableHead,{className:"text-left",children:"عملیات"})]})}),(0,b.jsx)(d.TableBody,{children:0===a.length?(0,b.jsx)(d.TableRow,{children:(0,b.jsx)(d.TableCell,{colSpan:8,className:"text-center py-8",children:"کاربری یافت نشد"})}):a.map(a=>{let c;return(0,b.jsxs)(d.TableRow,{children:[(0,b.jsx)(d.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[a.avatar?(0,b.jsx)("img",{src:a.avatar,alt:a.name,className:"w-10 h-10 rounded-full"}):(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(i.User,{className:"h-5 w-5 text-primary"})}),(0,b.jsx)("span",{className:"font-medium",children:a.name})]})}),(0,b.jsx)(d.TableCell,{children:a.email}),(0,b.jsx)(d.TableCell,{children:a.phone||"-"}),(0,b.jsx)(d.TableCell,{children:(0,b.jsx)(f.Badge,{variant:r[a.role],children:p[a.role]})}),(0,b.jsx)(d.TableCell,{children:(0,b.jsx)(f.Badge,{variant:s[a.status],children:q[a.status]})}),(0,b.jsx)(d.TableCell,{children:a.ordersCount||0}),(0,b.jsxs)(d.TableCell,{children:[a.totalSpent?(c=a.totalSpent,new Intl.NumberFormat("fa-IR").format(c)):"0"," تومان"]}),(0,b.jsx)(d.TableCell,{children:(0,b.jsxs)(g.DropdownMenu,{children:[(0,b.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(h.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(g.DropdownMenuLabel,{children:"عملیات"}),(0,b.jsx)(g.DropdownMenuSeparator,{}),(0,b.jsx)(g.DropdownMenuLabel,{children:"تغییر نقش"}),Object.entries(p).map(([c,d])=>(0,b.jsxs)(g.DropdownMenuItem,{onClick:()=>{v(a.id,c),x({title:"موفق",description:"نقش کاربر به‌روزرسانی شد"}),t?.()},disabled:a.role===c,children:[(0,b.jsx)(j.Shield,{className:"ml-2 h-4 w-4"}),d]},c)),(0,b.jsx)(g.DropdownMenuSeparator,{}),(0,b.jsx)(g.DropdownMenuLabel,{children:"تغییر وضعیت"}),Object.entries(q).map(([c,d])=>(0,b.jsxs)(g.DropdownMenuItem,{onClick:()=>{u(a.id,c),x({title:"موفق",description:"وضعیت کاربر به‌روزرسانی شد"}),t?.()},disabled:a.status===c,children:["active"===c?(0,b.jsx)(l.CheckCircle,{className:"ml-2 h-4 w-4"}):(0,b.jsx)(k.Ban,{className:"ml-2 h-4 w-4"}),d]},c)),(0,b.jsx)(g.DropdownMenuSeparator,{}),(0,b.jsx)(g.DropdownMenuItem,{className:"text-destructive",onClick:()=>{B(a.id),z(!0)},children:"حذف کاربر"})]})]})})]},a.id)})})]})}),(0,b.jsx)(o.Dialog,{open:y,onOpenChange:z,children:(0,b.jsxs)(o.DialogContent,{children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"حذف کاربر"}),(0,b.jsx)(o.DialogDescription,{children:"آیا از حذف این کاربر اطمینان دارید؟ این عمل قابل بازگشت نیست."})]}),(0,b.jsxs)(o.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>z(!1),children:"انصراف"}),(0,b.jsx)(e.Button,{variant:"destructive",onClick:()=>{A&&(w(A),x({title:"موفق",description:"کاربر با موفقیت حذف شد"}),z(!1),B(null),t?.())},children:"حذف"})]})]})})]})}var u=a.i(5522),v=a.i(3130),w=a.i(87682),x=a.i(87532);let y=(0,a.i(70106).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var z=a.i(84505),A=a.i(81464);function B(){let{users:a,setFilters:d,clearFilters:f,filters:g}=(0,m.useUserStore)(),[h,j]=(0,c.useState)(g.search||""),[k,l]=(0,c.useState)("all"),[n,o]=(0,c.useState)("all"),[p,q]=(0,c.useState)(!1),r=(0,c.useMemo)(()=>{let b=a;if(h){let a=h.toLowerCase();b=b.filter(b=>b.name.toLowerCase().includes(a)||b.email.toLowerCase().includes(a)||b.phone?.includes(a))}return"all"!==k&&(b=b.filter(a=>a.role===k)),"all"!==n&&(b=b.filter(a=>a.status===n)),b},[a,h,k,n]);return(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(v.Card,{className:"shadow-sm",children:[(0,b.jsxs)(v.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(v.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.User,{className:"h-5 w-5 text-primary"}),"کاربران (",r.length,")"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:p?"default":"outline",onClick:()=>q(!p),size:"sm",children:[(0,b.jsx)(A.Filter,{className:"ml-2 h-4 w-4"}),"فیلتر"]}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(z.Download,{className:"ml-2 h-4 w-4"}),"خروجی CSV"]}),(0,b.jsxs)(e.Button,{size:"sm",children:[(0,b.jsx)(y,{className:"ml-2 h-4 w-4"}),"افزودن کاربر"]})]})]}),p&&(0,b.jsxs)("div",{className:"mt-4 pt-4 border-t border-border/20",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"جستجو"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(x.Search,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(u.Input,{placeholder:"جستجو در کاربران...",value:h,onChange:a=>{var b;j(b=a.target.value),b?d({search:b}):f()},className:"pr-10"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"نقش"}),(0,b.jsxs)(w.Select,{value:k,onValueChange:a=>l(a),children:[(0,b.jsx)(w.SelectTrigger,{children:(0,b.jsx)(w.SelectValue,{placeholder:"همه نقش‌ها"})}),(0,b.jsxs)(w.SelectContent,{children:[(0,b.jsx)(w.SelectItem,{value:"all",children:"همه نقش‌ها"}),(0,b.jsx)(w.SelectItem,{value:"admin",children:"مدیر"}),(0,b.jsx)(w.SelectItem,{value:"moderator",children:"ناظر"}),(0,b.jsx)(w.SelectItem,{value:"user",children:"کاربر"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"وضعیت"}),(0,b.jsxs)(w.Select,{value:n,onValueChange:a=>o(a),children:[(0,b.jsx)(w.SelectTrigger,{children:(0,b.jsx)(w.SelectValue,{placeholder:"همه وضعیت‌ها"})}),(0,b.jsxs)(w.SelectContent,{children:[(0,b.jsx)(w.SelectItem,{value:"all",children:"همه وضعیت‌ها"}),(0,b.jsx)(w.SelectItem,{value:"active",children:"فعال"}),(0,b.jsx)(w.SelectItem,{value:"inactive",children:"غیرفعال"}),(0,b.jsx)(w.SelectItem,{value:"suspended",children:"معلق"})]})]})]})]}),(h||"all"!==k||"all"!==n)&&(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{j(""),l("all"),o("all"),f()},children:[(0,b.jsx)(A.Filter,{className:"ml-2 h-4 w-4"}),"پاک کردن فیلترها"]})})]})]}),(0,b.jsx)(v.CardContent,{children:(0,b.jsx)(t,{users:r})})]})})}a.s(["default",()=>B],47468)}];

//# sourceMappingURL=_94b51aa4._.js.map