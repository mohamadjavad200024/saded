module.exports=[38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},15618,a=>{"use strict";let b=(0,a.i(70106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},50180,71081,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);a.s(["Plane",()=>c],50180);let d=(0,b.default)("Ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]);a.s(["Ship",()=>d],71081)},78987,a=>{"use strict";let b=(0,a.i(70106).default)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);a.s(["ShoppingBag",()=>b],78987)},99859,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(82329),e=a.i(60421),f=a.i(3130),g=a.i(40695),h=a.i(81560),i=a.i(15618);let j=(0,a.i(70106).default)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var k=a.i(78987),l=a.i(50180),m=a.i(71081),n=a.i(71987),o=a.i(38246),p=a.i(77687);function q(){let{items:a,updateQuantity:q,removeItem:r,getTotal:s,clearCart:t,shippingMethod:u,setShippingMethod:v,initializeSession:w,loadFromDatabase:x}=(0,d.useCartStore)(),{getProduct:y,loadProductsFromDB:z}=(0,e.useProductStore)(),{toast:A}=(0,p.useToast)(),[B,C]=(0,c.useState)(u),[D,E]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{E(!0);try{w(),await z(),await x()}catch(a){console.error("Error initializing cart:",a)}finally{E(!1)}})()},[w,x,z]);let F=a=>{if(a.image&&""!==a.image.trim()&&(!a.image.startsWith("data:image")||!(a.image.length>5e4)))return a.image;let b=y(a.id);return b&&b.images&&b.images.length>0?(console.log("Using product image for cart item:",{itemId:a.id,productImage:b.images[0]?.substring(0,50)}),b.images[0]):null},G=(a,b)=>{try{q(a,b)}catch(a){a?.name==="QuotaExceededError"||a?.message?.includes("quota")?A({title:"خطا در ذخیره",description:"فضای ذخیره‌سازی پر شده است. لطفاً برخی از محصولات را از سبد خرید حذف کنید.",variant:"destructive"}):A({title:"خطا",description:"خطایی در به‌روزرسانی تعداد محصول رخ داد. لطفاً دوباره تلاش کنید.",variant:"destructive"})}};(0,c.useEffect)(()=>{u&&C(u)},[u]);let H=u||B,I=a=>{C(a),v(a)},J=a.reduce((a,b)=>{let c=y(b.id);return c?(c.airShippingEnabled?a.air=(a.air??!0)&&!0:a.air=!1,c.seaShippingEnabled?a.sea=(a.sea??!0)&&!0:a.sea=!1):(a.air=a.air??!0,a.sea=a.sea??!0),a},{air:void 0,sea:void 0}),K=!0===J.air,L=!0===J.sea;if((0,c.useEffect)(()=>{0!==a.length&&(H?"air"!==H||K?"sea"!==H||L||(K?(C("air"),v("air")):(C(null),v(null))):L?(C("sea"),v("sea")):(C(null),v(null)):(K||L)&&(K?(C("air"),v("air")):L&&(C("sea"),v("sea"))))},[K,L,H,v,a.length]),D)return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 sm:py-20 px-4",children:[(0,b.jsx)("div",{className:"h-12 w-12 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"}),(0,b.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold mb-2 text-center",children:"در حال بارگذاری سبد خرید..."})]});if(0===a.length)return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 sm:py-20 px-4",children:[(0,b.jsx)(k.ShoppingBag,{className:"h-16 w-16 sm:h-24 sm:w-24 text-muted-foreground mb-4"}),(0,b.jsx)("h2",{className:"text-xl sm:text-2xl font-bold mb-2 text-center",children:"سبد خرید شما خالی است"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground mb-6 text-center",children:"محصولات مورد نظر خود را به سبد خرید اضافه کنید"}),(0,b.jsx)(o.default,{href:"/products",children:(0,b.jsx)(g.Button,{size:"lg",className:"h-11 sm:h-12",children:"مشاهده محصولات"})})]});let M=s(),N=(()=>{if(!H||0===a.length)return 0;let b=0;for(let c of a){let a=y(c.id);if(a){let c="air"===H?a.airShippingCost??null:a.seaShippingCost??null;null!==c&&c>b&&(b=c)}}return 0===b?M>5e5?0:5e4:b})(),O=M+N;return(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8",children:[(0,b.jsx)("div",{className:"lg:col-span-2 space-y-0",children:a.map((c,d)=>(0,b.jsx)("div",{className:`p-3 sm:p-4 md:p-6 ${d<a.length-1?"border-b-[0.25px] border-border/30":""}`,children:(0,b.jsxs)("div",{className:"flex gap-3 sm:gap-4",children:[(0,b.jsx)("div",{className:"relative w-20 h-20 sm:w-24 sm:h-24 bg-muted rounded-lg overflow-hidden flex-shrink-0",children:F(c)?(0,b.jsx)(n.default,{src:F(c),alt:`${c.name} - سبد خرید`,fill:!0,className:"object-cover",onError:a=>{let b=a.target;b.style.display="none";let c=b.parentElement;if(c&&!c.querySelector(".image-placeholder")){let a=document.createElement("div");a.className="image-placeholder w-full h-full flex items-center justify-center text-muted-foreground",a.innerHTML='<svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>',c.appendChild(a)}}}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:(0,b.jsx)(k.ShoppingBag,{className:"h-8 w-8"})})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"font-semibold mb-2 text-sm sm:text-base line-clamp-2",children:c.name}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center border-[0.25px] border-border/30 rounded-md",children:[(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 sm:h-9 sm:w-9",onClick:()=>G(c.id,c.quantity-1),children:(0,b.jsx)(j,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})}),(0,b.jsx)("span",{className:"w-10 sm:w-12 text-center text-sm sm:text-base",children:c.quantity}),(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 sm:h-9 sm:w-9",onClick:()=>G(c.id,c.quantity+1),children:(0,b.jsx)(i.Plus,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]}),(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",onClick:()=>r(c.id),className:"text-destructive h-8 w-8 sm:h-9 sm:w-9",children:(0,b.jsx)(h.Trash2,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"text-base sm:text-lg font-bold",children:[(c.price*c.quantity).toLocaleString("fa-IR")," ","تومان"]})]})]})]})},c.id))}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(f.Card,{className:"sticky top-20 sm:top-24",children:[(0,b.jsx)(f.CardHeader,{className:"p-4 sm:p-6 pb-3 sm:pb-4",children:(0,b.jsx)(f.CardTitle,{className:"text-lg sm:text-xl",children:"خلاصه سفارش"})}),(0,b.jsxs)(f.CardContent,{className:"space-y-3 sm:space-y-4 p-4 sm:p-6 pt-0",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm sm:text-base",children:[(0,b.jsx)("span",{children:"جمع کل:"}),(0,b.jsxs)("span",{className:"font-semibold",children:[M.toLocaleString("fa-IR")," تومان"]})]}),(K||L)&&(0,b.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,b.jsx)("div",{className:"text-sm sm:text-base font-medium",children:"روش ارسال:"}),(0,b.jsxs)("div",{className:`grid gap-2 sm:gap-3 ${K&&L?"grid-cols-2":"grid-cols-1"}`,children:[K&&(0,b.jsxs)("button",{onClick:()=>I("air"),className:`flex flex-col items-center justify-center gap-2 p-3 sm:p-4 rounded-lg border-[0.25px] transition-all ${"air"===H?"border-primary/30 bg-primary/5":"border-border/30 hover:border-primary/20"}`,children:[(0,b.jsx)(l.Plane,{className:`h-5 w-5 sm:h-6 sm:w-6 ${"air"===H?"text-primary":"text-muted-foreground"}`}),(0,b.jsx)("span",{className:`text-xs sm:text-sm font-medium ${"air"===H?"text-primary":"text-foreground"}`,children:"هوایی"})]}),L&&(0,b.jsxs)("button",{onClick:()=>I("sea"),className:`flex flex-col items-center justify-center gap-2 p-3 sm:p-4 rounded-lg border-[0.25px] transition-all ${"sea"===H?"border-primary/30 bg-primary/5":"border-border/30 hover:border-primary/20"}`,children:[(0,b.jsx)(m.Ship,{className:`h-5 w-5 sm:h-6 sm:w-6 ${"sea"===H?"text-primary":"text-muted-foreground"}`}),(0,b.jsx)("span",{className:`text-xs sm:text-sm font-medium ${"sea"===H?"text-primary":"text-foreground"}`,children:"دریایی"})]})]})]}),!K&&!L&&(0,b.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,b.jsx)("div",{className:"text-sm sm:text-base font-medium",children:"روش ارسال:"}),(0,b.jsx)("div",{className:"p-3 sm:p-4 rounded-lg border-[0.25px] border-border/30 bg-muted/30",children:(0,b.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground text-center",children:"روش ارسال برای محصولات موجود در سبد خرید توسط مدیر در زمان ارسال مشخص خواهد شد"})})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm sm:text-base",children:[(0,b.jsx)("span",{children:"هزینه ارسال:"}),(0,b.jsx)("span",{className:"font-semibold",children:0===N?(0,b.jsx)("span",{className:"text-green-600",children:"رایگان"}):`${N.toLocaleString("fa-IR")} تومان`})]}),N>0&&5e4===N&&M<5e5&&(0,b.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground leading-relaxed",children:["برای ارسال رایگان، ",(5e5-M).toLocaleString("fa-IR")," تومان دیگر به سبد خرید خود اضافه کنید"]}),(0,b.jsxs)("div",{className:"border-t-[0.25px] border-border/30 pt-3 sm:pt-4 flex justify-between text-base sm:text-lg font-bold",children:[(0,b.jsx)("span",{children:"مبلغ نهایی:"}),(0,b.jsxs)("span",{children:[O.toLocaleString("fa-IR")," تومان"]})]}),(0,b.jsxs)("div",{className:"flex gap-2 sm:gap-3 min-w-0",children:[(0,b.jsx)(o.default,{href:"/checkout",className:"flex-1 min-w-0",children:(0,b.jsx)(g.Button,{className:"w-full h-11 sm:h-12 text-xs sm:text-sm",size:"lg",children:"ادامه خرید"})}),(0,b.jsx)(g.Button,{variant:"outline",className:"h-11 sm:h-12 text-xs sm:text-sm whitespace-nowrap flex-shrink-0",size:"lg",onClick:()=>{},children:"ارسال فاکتور خرید"})]}),(0,b.jsx)(g.Button,{variant:"outline",className:"w-full h-10 sm:h-11 text-sm sm:text-base",onClick:t,children:"پاک کردن سبد خرید"})]})]})})]})}a.s(["CartContent",()=>q],99859)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__e098f704._.js.map