module.exports=[12783,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(3130),f=a.i(40695),g=a.i(5522),h=a.i(17171),i=a.i(410),j=a.i(60421),k=a.i(87532),l=a.i(83497),m=a.i(24987),n=a.i(63519),o=a.i(92258),p=a.i(41675),q=a.i(10227),r=a.i(67453),s=a.i(41710),t=a.i(62722),u=a.i(38784);let v=(0,a.i(70106).default)("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);var w=a.i(16201),x=a.i(45222),y=a.i(71987),z=a.i(54161);a.i(35112);var A=a.i(11011),B=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,d)=>{let e=(0,A.createSlot)(`Primitive.${d}`),f=c.forwardRef((a,c)=>{let{asChild:f,...g}=a;return(0,b.jsx)(f?e:d,{...g,ref:c})});return f.displayName=`Primitive.${d}`,{...a,[d]:f}},{}),C="Progress",[D,E]=function(a,d=[]){let e=[],f=()=>{let b=e.map(a=>c.createContext(a));return function(d){let e=d?.[a]||b;return c.useMemo(()=>({[`__scope${a}`]:{...d,[a]:e}}),[d,e])}};return f.scopeName=a,[function(d,f){let g=c.createContext(f);g.displayName=d+"Context";let h=e.length;e=[...e,f];let i=d=>{let{scope:e,children:f,...i}=d,j=e?.[a]?.[h]||g,k=c.useMemo(()=>i,Object.values(i));return(0,b.jsx)(j.Provider,{value:k,children:f})};return i.displayName=d+"Provider",[i,function(b,e){let i=e?.[a]?.[h]||g,j=c.useContext(i);if(j)return j;if(void 0!==f)return f;throw Error(`\`${b}\` must be used within \`${d}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let d=()=>{let d=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let e=d.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return c.useMemo(()=>({[`__scope${b.scopeName}`]:e}),[e])}};return d.scopeName=b.scopeName,d}(f,...d)]}(C),[F,G]=D(C),H=c.forwardRef((a,c)=>{var d,e;let{__scopeProgress:f,value:g=null,max:h,getValueLabel:i=K,...j}=a;(h||0===h)&&!N(h)&&console.error((d=`${h}`,`Invalid prop \`max\` of value \`${d}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let k=N(h)?h:100;null===g||O(g,k)||console.error((e=`${g}`,`Invalid prop \`value\` of value \`${e}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let l=O(g,k)?g:null,m=M(l)?i(l,k):void 0;return(0,b.jsx)(F,{scope:f,value:l,max:k,children:(0,b.jsx)(B.div,{"aria-valuemax":k,"aria-valuemin":0,"aria-valuenow":M(l)?l:void 0,"aria-valuetext":m,role:"progressbar","data-state":L(l,k),"data-value":l??void 0,"data-max":k,...j,ref:c})})});H.displayName=C;var I="ProgressIndicator",J=c.forwardRef((a,c)=>{let{__scopeProgress:d,...e}=a,f=G(I,d);return(0,b.jsx)(B.div,{"data-state":L(f.value,f.max),"data-value":f.value??void 0,"data-max":f.max,...e,ref:c})});function K(a,b){return`${Math.round(a/b*100)}%`}function L(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function M(a){return"number"==typeof a}function N(a){return M(a)&&!isNaN(a)&&a>0}function O(a,b){return M(a)&&!isNaN(a)&&a<=b&&a>=0}J.displayName=I;var P=a.i(97895);let Q=c.forwardRef(({className:a,value:c,...d},e)=>(0,b.jsx)(H,{ref:e,className:(0,P.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...d,children:(0,b.jsx)(J,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(c||0)}%)`}})}));Q.displayName=H.displayName;var R=a.i(2342);let S={pending:{label:"در انتظار",color:"bg-yellow-100 text-yellow-800",icon:s.Clock},processing:{label:"در حال پردازش",color:"bg-blue-100 text-blue-800",icon:l.Package},shipped:{label:"ارسال شده",color:"bg-purple-100 text-purple-800",icon:q.Truck},delivered:{label:"تحویل داده شده",color:"bg-green-100 text-green-800",icon:r.CheckCircle2},cancelled:{label:"لغو شده",color:"bg-red-100 text-red-800",icon:t.XCircle}},T={pending:{label:"در انتظار پرداخت",color:"bg-yellow-100 text-yellow-800"},paid:{label:"پرداخت شده",color:"bg-green-100 text-green-800"},failed:{label:"پرداخت ناموفق",color:"bg-red-100 text-red-800"},refunded:{label:"بازگشت وجه",color:"bg-gray-100 text-gray-800"}};function U(){let a,A,B,C,D,E,F=(0,d.useSearchParams)().get("orderNumber")||"",[G,H]=(0,c.useState)(F),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),{orders:U,updateOrder:V}=(0,i.useOrderStore)(),{getProduct:W,loadProductsFromDB:X}=(0,j.useProductStore)(),Y=()=>{(L(!1),J(null),N(!0),G.trim())?Z(G):N(!1)},Z=async a=>{try{let b=U.find(b=>b.orderNumber.toLowerCase()===a.toLowerCase().trim()||b.id===a.trim());if(b){J(b),L(!1);return}let c=await fetch(`/api/orders?orderNumber=${encodeURIComponent(a)}`);if(c.ok){let a=await c.json();if(a.success&&a.data&&a.data.length>0){let b=a.data[0];J(b),L(!1),V(b.id,b)}else L(!0)}else L(!0)}catch(a){console.error("Error fetching order:",a),L(!0)}};return(0,c.useEffect)(()=>{X(!0).catch(a=>{console.error("Error loading products for order tracking:",a)})},[X]),(0,c.useEffect)(()=>{F&&F.trim()&&(N(!0),Z(F))},[F]),(0,c.useEffect)(()=>{if(!I?.id)return;let a=setInterval(async()=>{try{let a=await fetch(`/api/orders/${I.id}`);if(a.ok){let b=await a.json();b.success&&b.data&&(J(b.data),V(b.data.id,b.data))}}catch(a){console.error("Error polling order status:",a)}},1e4);return()=>clearInterval(a)},[I?.id,V]),I&&S[I.status]?.icon||s.Clock,(0,b.jsxs)("div",{className:"container mx-auto px-4 py-6 sm:py-8 md:py-12",children:[(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6 sm:mb-8",children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold",children:"پیگیری سفارش"}),(0,b.jsxs)(f.Button,{onClick:()=>P(!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,b.jsx)(x.MessageCircle,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"چت با ادمین"}),(0,b.jsx)("span",{className:"sm:hidden",children:"چت"})]})]}),(0,b.jsxs)(e.Card,{className:"mb-6",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"جستجوی سفارش"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(h.Label,{htmlFor:"orderNumber",children:"شماره سفارش"}),(0,b.jsx)(g.Input,{id:"orderNumber",placeholder:"مثال: ORD-1234567890-001",value:G,onChange:a=>H(a.target.value),onKeyDown:a=>{"Enter"===a.key&&Y()}})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)(f.Button,{onClick:Y,size:"lg",children:[(0,b.jsx)(k.Search,{className:"ml-2 h-4 w-4"}),"جستجو"]})})]})})]}),K&&M&&(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(t.XCircle,{className:"h-16 w-16 text-muted-foreground mb-4"}),(0,b.jsx)("h2",{className:"text-xl font-bold mb-2",children:"سفارش یافت نشد"}),(0,b.jsx)("p",{className:"text-muted-foreground text-center mb-6",children:"شماره سفارش وارد شده معتبر نیست. لطفاً شماره سفارش را بررسی کنید."})]})})}),I&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(e.Card,{className:"border-2",children:[(0,b.jsx)(e.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Package,{className:"h-5 w-5 text-primary"}),"پیگیری سفارش"]})}),(0,b.jsxs)(e.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute right-8 top-0 bottom-0 w-0.5 bg-border",children:(0,b.jsx)("div",{className:"absolute top-0 right-0 w-full bg-primary transition-all duration-500 ease-in-out",style:{height:`${-1===(A=(a=["pending","processing","shipped","delivered"]).indexOf(I.status))?0:(A+1)/a.length*100}%`}})}),(0,b.jsx)("div",{className:"space-y-8 relative z-10",children:[{status:"pending",label:"در انتظار",icon:u.ShoppingCart,description:"سفارش شما ثبت شد"},{status:"processing",label:"در حال پردازش",icon:v,description:"در حال آماده‌سازی"},{status:"shipped",label:"ارسال شده",icon:q.Truck,description:"در مسیر تحویل"},{status:"delivered",label:"تحویل شده",icon:r.CheckCircle2,description:"تحویل با موفقیت انجام شد"}].map((a,c)=>{let d=["pending","processing","shipped","delivered"],e=d.indexOf(I.status),f=d.indexOf(a.status),g=e>=f&&"cancelled"!==I.status,h=e===f&&"cancelled"!==I.status,i=a.icon;return(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:"relative z-10",children:(0,b.jsx)("div",{className:`w-16 h-16 rounded-full flex items-center justify-center transition-all duration-300 ${g?"bg-primary text-primary-foreground shadow-lg shadow-primary/50":h?"bg-primary/20 text-primary border-2 border-primary":"bg-muted text-muted-foreground"}`,children:g?(0,b.jsx)(w.CheckCircle,{className:"h-8 w-8"}):(0,b.jsx)(i,{className:"h-8 w-8"})})}),(0,b.jsxs)("div",{className:"flex-1 pt-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("h3",{className:`font-semibold text-lg ${g||h?"text-foreground":"text-muted-foreground"}`,children:a.label}),h&&(0,b.jsx)(z.Badge,{variant:"default",className:"animate-pulse",children:"در حال انجام"}),g&&!h&&(0,b.jsxs)(z.Badge,{variant:"success",className:"gap-1",children:[(0,b.jsx)(w.CheckCircle,{className:"h-3 w-3"}),"تکمیل شد"]})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description}),h&&I.updatedAt&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["آخرین به‌روزرسانی:"," ",new Date(I.updatedAt).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]},a.status)})})]}),(0,b.jsxs)("div",{className:"mt-8 pt-6 border-t",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"پیشرفت کلی"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:-1===(C=(B=["pending","processing","shipped","delivered"]).indexOf(I.status))?"0%":`${Math.round((C+1)/B.length*100)}%`})]}),(0,b.jsx)(Q,{value:-1===(E=(D=["pending","processing","shipped","delivered"]).indexOf(I.status))?0:(E+1)/D.length*100,className:"h-3"})]}),(0,b.jsxs)("div",{className:"mt-6 pt-6 border-t grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,b.jsx)(l.Package,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"شماره سفارش"}),(0,b.jsx)("p",{className:"font-semibold font-mono",children:I.orderNumber})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,b.jsx)(p.Calendar,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"تاریخ ثبت"}),(0,b.jsx)("p",{className:"font-semibold",children:new Date(I.createdAt).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"محصولات سفارش"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:I.items.map(a=>{let c=W(a.productId||a.id),d=a.image&&""!==a.image.trim()?a.image:"";!d&&c&&c.images&&c.images.length>0&&(d=c.images[0]);let e=d&&""!==d.trim();return(0,b.jsxs)("div",{className:"flex gap-4 pb-4 border-b last:border-0",children:[e?(0,b.jsx)("div",{className:"relative w-20 h-20 bg-muted rounded-lg overflow-hidden flex-shrink-0 border",children:(0,b.jsx)(y.default,{src:d,alt:a.name,fill:!0,className:"object-cover",unoptimized:d.startsWith("blob:")||d.startsWith("data:")})}):(0,b.jsx)("div",{className:"w-20 h-20 bg-muted rounded-lg flex items-center justify-center flex-shrink-0 border",children:(0,b.jsx)(l.Package,{className:"h-8 w-8 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold mb-1",children:a.name}),(0,b.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,b.jsxs)("span",{children:["تعداد: ",a.quantity]}),(0,b.jsxs)("span",{className:"font-semibold text-foreground",children:[(a.price*a.quantity).toLocaleString("fa-IR")," تومان"]})]})]})]},a.id)})})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"اطلاعات مشتری"})}),(0,b.jsxs)(e.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,b.jsx)(l.Package,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"نام"}),(0,b.jsx)("p",{className:"font-semibold",children:I.customerName})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,b.jsx)(n.Phone,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"شماره تماس"}),(0,b.jsx)("p",{className:"font-semibold",children:I.customerPhone})]})]}),I.customerEmail&&(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,b.jsx)(o.Mail,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"ایمیل"}),(0,b.jsx)("p",{className:"font-semibold",children:I.customerEmail})]})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"آدرس ارسال"})}),(0,b.jsxs)(e.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,b.jsx)(m.MapPin,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"آدرس"}),(0,b.jsxs)("p",{className:"font-semibold",children:[I.shippingAddress.city,"، ",I.shippingAddress.address]}),I.shippingAddress.postalCode&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["کد پستی: ",I.shippingAddress.postalCode]})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-muted rounded-lg",children:(0,b.jsx)(q.Truck,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"روش ارسال"}),(0,b.jsx)("p",{className:"font-semibold",children:"air"===I.shippingMethod?"هوایی":"دریایی"})]})]})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"خلاصه سفارش"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"جمع کل:"}),(0,b.jsxs)("span",{className:"font-semibold",children:[I.total.toLocaleString("fa-IR")," تومان"]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"هزینه ارسال:"}),(0,b.jsx)("span",{className:"font-semibold",children:0===I.shippingCost?(0,b.jsx)("span",{className:"text-green-600",children:"رایگان"}):`${I.shippingCost.toLocaleString("fa-IR")} تومان`})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-3 border-t",children:[(0,b.jsx)("span",{className:"font-bold",children:"مبلغ نهایی:"}),(0,b.jsxs)("span",{className:"font-bold text-lg text-primary",children:[(I.total+I.shippingCost).toLocaleString("fa-IR")," تومان"]})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-3 border-t",children:[(0,b.jsx)("span",{children:"وضعیت پرداخت:"}),(0,b.jsx)(z.Badge,{className:T[I.paymentStatus]?.color,children:T[I.paymentStatus]?.label})]})]})})]})]})]}),(0,b.jsx)(R.QuickBuyChat,{isOpen:O,onOpenChange:P})]})}function V(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"container mx-auto px-4 py-6",children:"در حال بارگذاری..."}),children:(0,b.jsx)(U,{})})}a.s(["default",()=>V],12783)}];

//# sourceMappingURL=app_order_track_page_tsx_c5d32813._.js.map