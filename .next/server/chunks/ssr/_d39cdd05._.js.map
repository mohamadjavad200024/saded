{"version":3,"sources":["../../../../hooks/use-global-chat-polling.tsx","../../../../hooks/use-notifications.ts","../../../../store/notification-store.ts","../../../../hooks/use-persistent-notifications.ts","../../../../node_modules/lucide-react/src/icons/bell.ts","../../../../components/notifications/persistent-notification.tsx","../../../../components/notifications/notification-center.tsx","../../../../components/error-boundary.tsx","../../../../components/ui/alert.tsx","../../../../lib/logger.ts","../../../../lib/api-error-handler.ts"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useCallback } from \"react\";\nimport { useNotifications } from \"@/hooks/use-notifications\";\nimport { usePersistentNotifications } from \"@/hooks/use-persistent-notifications\";\nimport { logger } from \"@/lib/logger-client\";\n\ninterface UseGlobalChatPollingOptions {\n  isUser?: boolean; // true for user chat, false for admin\n  chatId?: string | null;\n  onNewMessage?: (message: any, chatInfo?: any) => void;\n}\n\nexport function useGlobalChatPolling({\n  isUser = false,\n  chatId,\n  onNewMessage,\n}: UseGlobalChatPollingOptions) {\n  const { showNotification } = useNotifications();\n  const { showMessageNotification } = usePersistentNotifications();\n  const adminStatusRef = useRef<{ isOnline: boolean; lastChecked: number }>({\n    isOnline: false,\n    lastChecked: 0,\n  });\n  const pollingIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const lastPolledMessageIdRef = useRef<string | null>(null);\n  const lastPolledTimeRef = useRef<number>(0); // Start at 0, will be set on first poll\n  const processedMessageIdsRef = useRef<Set<string>>(new Set());\n  const notificationDebounceRef = useRef<Map<string, NodeJS.Timeout>>(new Map());\n  const lastNotificationTimeRef = useRef<Map<string, number>>(new Map());\n\n  // Load last message ID from localStorage for user\n  useEffect(() => {\n    if (isUser && typeof window !== \"undefined\") {\n      const savedChatId = localStorage.getItem(\"quickBuyChat_chatId\");\n      if (savedChatId && !chatId) {\n        // Load last message ID from localStorage\n        const savedLastMessageId = localStorage.getItem(\"quickBuyChat_lastMessageId\");\n        if (savedLastMessageId) {\n          lastPolledMessageIdRef.current = savedLastMessageId;\n        }\n      }\n    }\n  }, [isUser, chatId]);\n\n  // Check admin status\n  const checkAdminStatus = useCallback(async (): Promise<boolean> => {\n    try {\n      const now = Date.now();\n      // Cache admin status for 5 seconds\n      if (now - adminStatusRef.current.lastChecked < 5000) {\n        return adminStatusRef.current.isOnline;\n      }\n\n      const response = await fetch(\"/api/admin/presence\");\n      if (!response.ok) {\n        return false;\n      }\n\n      const data = await response.json();\n      if (data.success && data.data?.admins && Array.isArray(data.data.admins)) {\n        const isOnline = data.data.admins.length > 0;\n        adminStatusRef.current = {\n          isOnline,\n          lastChecked: now,\n        };\n        return isOnline;\n      }\n      return false;\n    } catch (error) {\n      logger.error(\"Error checking admin status:\", error);\n      return false;\n    }\n  }, []);\n\n  // Poll for new messages\n  const pollForNewMessages = useCallback(async () => {\n    try {\n      let url = \"\";\n      let currentChatId = chatId;\n\n      if (isUser) {\n        // For user: poll their own chat\n        if (typeof window !== \"undefined\") {\n          currentChatId = currentChatId || localStorage.getItem(\"quickBuyChat_chatId\");\n        }\n        if (!currentChatId) {\n          // No chat ID yet, skip polling\n          return;\n        }\n\n        url = `/api/chat?chatId=${currentChatId}`;\n        if (lastPolledMessageIdRef.current && lastPolledMessageIdRef.current !== \"1\") {\n          url += `&lastMessageId=${lastPolledMessageIdRef.current}`;\n        }\n      } else {\n        // For admin: poll all chats and find new messages\n        url = `/api/chat`;\n      }\n\n      let response;\n      try {\n        // Create abort controller for timeout\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout\n        \n        response = await fetch(url, {\n          signal: controller.signal,\n        });\n        \n        clearTimeout(timeoutId);\n      } catch (fetchError) {\n        // Network error or timeout - silently fail and retry next time\n        if (fetchError instanceof Error) {\n          // Only log non-abort errors\n          if (fetchError.name !== 'AbortError') {\n            logger.warn(\"[Chat Polling] Network error (will retry):\", fetchError.message);\n          }\n        }\n        return;\n      }\n\n      if (!response.ok) {\n        // Handle rate limiting (429) gracefully - back off and retry later\n        if (response.status === 429) {\n          const retryAfter = response.headers.get('Retry-After');\n          const retrySeconds = retryAfter ? parseInt(retryAfter, 10) : 10;\n          // Only log in development to avoid console spam\n          if (process.env.NODE_ENV === 'development') {\n            logger.warn(`[Chat Polling] Rate limited (429), will retry after ${retrySeconds}s`);\n          }\n          // Don't poll for a while - the interval will handle retry\n          return;\n        }\n        // Don't log error for 404 (chat not found) - this is expected for new chats\n        if (response.status !== 404) {\n          // Only log in development to avoid console spam\n          if (process.env.NODE_ENV === 'development') {\n            logger.error(\"Failed to fetch chat messages:\", response.status);\n          }\n        }\n        return;\n      }\n\n      let data;\n      try {\n        data = await response.json();\n      } catch (parseError) {\n        logger.error(\"Error parsing chat response:\", parseError);\n        return;\n      }\n\n      if (isUser) {\n        // Handle user polling - always check, but only show notification when chat is closed\n        // Check if chat is open by checking if chat component is mounted\n        const chatIsOpen = typeof window !== \"undefined\" && \n          document.querySelector('[data-chat-open=\"true\"]') !== null;\n        \n        if (data.success && data.data?.messages && Array.isArray(data.data.messages)) {\n          const allMessages = data.data.messages;\n          \n          // Filter for new support messages that haven't been processed\n          const newMessages = allMessages.filter(\n            (msg: any) => \n              msg.sender === \"support\" && \n              !processedMessageIdsRef.current.has(msg.id)\n          );\n\n          if (newMessages.length > 0) {\n            const latestMessage = newMessages[newMessages.length - 1];\n            const messageText = latestMessage.text || \"پیام جدید دریافت شد\";\n            const previewText = messageText.length > 50 \n              ? messageText.substring(0, 50) + \"...\" \n              : messageText;\n\n            // Mark as processed\n            newMessages.forEach((msg: any) => {\n              processedMessageIdsRef.current.add(msg.id);\n            });\n\n            // Update last message ID to the latest message (not just new ones)\n            // This ensures we don't miss messages\n            const allMessageIds = allMessages.map((m: any) => m.id);\n            if (allMessageIds.length > 0) {\n              lastPolledMessageIdRef.current = allMessageIds[allMessageIds.length - 1];\n              if (typeof window !== \"undefined\" && lastPolledMessageIdRef.current) {\n                localStorage.setItem(\"quickBuyChat_lastMessageId\", lastPolledMessageIdRef.current);\n              }\n            }\n\n            // Check admin status before showing notification\n            const isAdminOnline = await checkAdminStatus();\n\n            // Only show notification if chat is closed\n            if (!chatIsOpen) {\n              // Prevent duplicate notifications with debouncing\n              const notificationKey = `user-${currentChatId}-${latestMessage.id}`;\n              const now = Date.now();\n              const lastNotificationTime = lastNotificationTimeRef.current.get(notificationKey) || 0;\n              \n              // Skip if notification was shown recently (within 5 seconds)\n              if (now - lastNotificationTime < 5000) {\n                logger.debug(`[User Notification] ⏭️ Skipping duplicate notification for ${currentChatId}`);\n                // Still call callback\n                if (onNewMessage) {\n                  onNewMessage(latestMessage, data.data.chat);\n                }\n                return;\n              }\n\n              // Clear existing debounce timeout if any\n              const existingTimeout = notificationDebounceRef.current.get(notificationKey);\n              if (existingTimeout) {\n                clearTimeout(existingTimeout);\n              }\n\n              // Debounce notification to prevent spam\n              const timeoutId = setTimeout(() => {\n                logger.debug(\"New support message detected, showing notification:\", previewText);\n                \n                // Update last notification time\n                lastNotificationTimeRef.current.set(notificationKey, Date.now());\n              \n                // Show browser notification\n                showNotification({\n                  title: \"پیام جدید از پشتیبانی\",\n                  body: previewText,\n                  tag: `support-${latestMessage.id}`,\n                  requireInteraction: false,\n                  sound: true,\n                }).catch((error) => {\n                  logger.error(\"[User Notification] Error showing browser notification:\", error);\n                });\n\n                // Show persistent notification\n                showMessageNotification(\"پشتیبانی\", previewText, {\n                  onOpen: () => {\n                    if (onNewMessage) {\n                      onNewMessage(latestMessage);\n                    }\n                  },\n                  chatId: currentChatId || undefined,\n                  metadata: {\n                    messageId: latestMessage.id,\n                    chatId: currentChatId,\n                    isAdminOffline: !isAdminOnline,\n                    isAdmin: false, // This is for user\n                  },\n                });\n\n                // Clean up timeout reference\n                notificationDebounceRef.current.delete(notificationKey);\n              }, 300); // 300ms debounce\n\n              notificationDebounceRef.current.set(notificationKey, timeoutId);\n            } else {\n              logger.debug(\"New support message detected but chat is open, skipping notification\");\n            }\n\n            // Call callback if provided\n            if (onNewMessage) {\n              onNewMessage(latestMessage, data.data.chat);\n            }\n          } else {\n            // Update last message ID even if no new messages (to keep track)\n            if (allMessages.length > 0) {\n              const latestMessageId = allMessages[allMessages.length - 1].id;\n              if (latestMessageId !== lastPolledMessageIdRef.current) {\n                lastPolledMessageIdRef.current = latestMessageId;\n                if (typeof window !== \"undefined\") {\n                  localStorage.setItem(\"quickBuyChat_lastMessageId\", latestMessageId);\n                }\n              }\n            }\n          }\n        }\n      } else {\n        // Handle admin polling - check all chats for new user messages\n        if (data.success && data.data?.chats && Array.isArray(data.data.chats)) {\n          const chats = data.data.chats;\n          logger.debug(`[Admin Polling] ✅ Polling active - Checking ${chats.length} chats for new messages`);\n\n          // Check each chat for new messages\n          for (const chat of chats) {\n            try {\n              // Use a time window of last 1 minute for initial polling, then use lastPolledTime\n              const sinceTime = lastPolledTimeRef.current > 0 \n                ? lastPolledTimeRef.current \n                : Date.now() - 60000; // 1 minute ago for first poll\n              \n              const sinceISO = new Date(sinceTime).toISOString();\n              let chatResponse;\n              try {\n                // Create abort controller for timeout\n                const controller = new AbortController();\n                const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout per chat\n                \n                chatResponse = await fetch(`/api/chat?chatId=${chat.id}&since=${sinceISO}`, {\n                  signal: controller.signal,\n                });\n                \n                clearTimeout(timeoutId);\n              } catch (fetchError) {\n                // Network error - skip this chat and continue with others\n                if (process.env.NODE_ENV === 'development' && fetchError instanceof Error && fetchError.name !== 'AbortError') {\n                  logger.warn(`[Admin Polling] Network error for chat ${chat.id} (will retry):`, fetchError.message);\n                }\n                continue;\n              }\n              \n              if (!chatResponse.ok) {\n                // Handle rate limiting (429) gracefully - skip this chat and continue with others\n                if (chatResponse.status === 429) {\n                  if (process.env.NODE_ENV === 'development') {\n                    logger.warn(`[Admin Polling] Rate limited (429) for chat ${chat.id}, skipping this cycle`);\n                  }\n                  continue;\n                }\n                if (process.env.NODE_ENV === 'development') {\n                  logger.warn(`[Admin Polling] Failed to fetch chat ${chat.id}:`, chatResponse.status);\n                }\n                continue;\n              }\n\n              const chatData = await chatResponse.json();\n              if (chatData.success && chatData.data?.messages && Array.isArray(chatData.data.messages)) {\n                const allMessages = chatData.data.messages;\n                logger.debug(`[Admin Polling] Chat ${chat.id} (${chat.customerName}): Found ${allMessages.length} total messages`);\n\n                // Filter for new user messages that haven't been processed\n                // IMPORTANT: Only show notifications for messages FROM users (received messages), not FROM admin (sent messages)\n                const newUserMessages = allMessages.filter(\n                  (msg: any) => {\n                    const isUserMessage = msg.sender === \"user\"; // Only messages from user, not from support/admin\n                    const notProcessed = !processedMessageIdsRef.current.has(msg.id);\n                    const isNew = new Date(msg.createdAt).getTime() > sinceTime;\n                    \n                    // Log for debugging\n                    if (isNew && !isUserMessage) {\n                      logger.debug(`[Admin Polling] Skipping message from ${msg.sender} (only user messages trigger notifications)`);\n                    }\n                    \n                    return isUserMessage && notProcessed && isNew;\n                  }\n                );\n\n                logger.debug(`[Admin Polling] Chat ${chat.id}: Found ${newUserMessages.length} new user messages (received from user)`);\n                \n                // Log if there are messages from admin/support that are being filtered out\n                const adminMessages = allMessages.filter(\n                  (msg: any) => msg.sender === \"support\" && new Date(msg.createdAt).getTime() > sinceTime\n                );\n                if (adminMessages.length > 0 && process.env.NODE_ENV === 'development') {\n                  logger.debug(`[Admin Polling] Chat ${chat.id}: Found ${adminMessages.length} messages from admin/support (these will NOT trigger notifications)`);\n                }\n\n                if (newUserMessages.length > 0) {\n                  // Only show notification for the latest message (minimal notifications)\n                  const latestMessage = newUserMessages[newUserMessages.length - 1];\n                  \n                  // Double-check: Ensure this is a message FROM user (received), not FROM admin (sent)\n                  if (latestMessage.sender !== \"user\") {\n                    logger.warn(`[Admin Notification] ⚠️ Skipping notification - message sender is \"${latestMessage.sender}\", expected \"user\"`);\n                    processedMessageIdsRef.current.add(latestMessage.id);\n                    continue;\n                  }\n                  \n                  // Check if we already processed this message\n                  if (processedMessageIdsRef.current.has(latestMessage.id)) {\n                    logger.debug(`[Admin Notification] Message ${latestMessage.id} already processed, skipping`);\n                    continue;\n                  }\n\n                  // Check if this specific chat is currently selected/opened\n                  // Similar to user: only show notification if this specific chat is NOT currently open\n                  let thisChatIsOpen = false;\n                  if (typeof window !== \"undefined\") {\n                    // Method 1: Check localStorage (most reliable)\n                    const storedSelectedChatId = localStorage.getItem('admin_selected_chat_id');\n                    if (storedSelectedChatId) {\n                      thisChatIsOpen = storedSelectedChatId === chat.id;\n                    }\n                    \n                    // Method 2: Check data attribute as fallback\n                    if (!thisChatIsOpen) {\n                      const sheetElement = document.querySelector('[data-admin-chat-open=\"true\"]');\n                      if (sheetElement) {\n                        const selectedChatId = sheetElement.getAttribute('data-selected-chat-id');\n                        // Only consider chat open if selectedChatId matches AND is not empty\n                        if (selectedChatId && selectedChatId !== \"\" && selectedChatId === chat.id) {\n                          thisChatIsOpen = true;\n                        }\n                      }\n                    }\n                  }\n\n                  logger.debug(`[Admin Notification] Chat ${chat.id} (${chat.customerName}): isOpen=${thisChatIsOpen}, messageId=${latestMessage.id}`);\n\n                  // Always create notifications for admin, but mark them with the chat status\n                  // The Notification Center will filter out notifications from the currently open chat\n                  // This ensures notifications from other users always show, even when chatting with one user\n                  \n                  // Prevent duplicate notifications with debouncing\n                  const notificationKey = `admin-${chat.id}-${latestMessage.id}`;\n                  const now = Date.now();\n                  const lastNotificationTime = lastNotificationTimeRef.current.get(notificationKey) || 0;\n                  \n                  // Skip if notification was shown recently (within 5 seconds)\n                  if (now - lastNotificationTime < 5000) {\n                    logger.debug(`[Admin Notification] ⏭️ Skipping duplicate notification for chat ${chat.id} (shown ${Math.round((now - lastNotificationTime) / 1000)}s ago)`);\n                    // Still mark as processed and call callback\n                    processedMessageIdsRef.current.add(latestMessage.id);\n                    if (onNewMessage) {\n                      onNewMessage(latestMessage, chat);\n                    }\n                    continue;\n                  }\n\n                  // Mark as processed immediately to prevent duplicate processing\n                  processedMessageIdsRef.current.add(latestMessage.id);\n\n                  // Notifications disabled for admin - only call callback\n                  // Call callback if provided\n                  if (onNewMessage) {\n                    onNewMessage(latestMessage, chat);\n                  }\n                }\n              } else {\n                logger.warn(`[Admin Polling] Chat ${chat.id}: Invalid response format`, chatData);\n              }\n            } catch (error) {\n              logger.error(`[Admin Polling] Error polling chat ${chat.id}:`, error);\n            }\n          }\n\n          // Update last polled time\n          lastPolledTimeRef.current = Date.now();\n          logger.debug(`[Admin Polling] ✅ Polling completed, next poll in 3 seconds`);\n        } else {\n          logger.warn(\"[Admin Polling] Invalid response format or no chats found\", data);\n        }\n      }\n    } catch (error) {\n      // Silently handle errors - polling will retry on next interval\n      // Only log in development to avoid console spam\n      if (process.env.NODE_ENV === 'development') {\n        logger.error(\"Error polling for new messages:\", error);\n      }\n    }\n  }, [isUser, chatId, showNotification, showMessageNotification, onNewMessage, checkAdminStatus]);\n\n  // Start polling\n  useEffect(() => {\n    // Only start polling if we have a chatId (for users) or if admin\n    if (isUser) {\n      const currentChatId = chatId || (typeof window !== \"undefined\" ? localStorage.getItem(\"quickBuyChat_chatId\") : null);\n      if (!currentChatId) {\n        // No chat ID yet, don't start polling\n        logger.debug(\"Global polling: No chatId found, skipping polling\");\n        return;\n      }\n      logger.debug(\"Global polling: Starting polling for chatId:\", currentChatId);\n    } else {\n      logger.debug(\"Global polling: Starting admin polling\");\n    }\n\n    // Start polling immediately\n    logger.debug(\"[Admin Polling] Starting initial poll...\");\n    pollForNewMessages();\n\n    // Optimized: Poll every 5 seconds (reduced from 3s to reduce server load)\n    // When chat is open, it will poll more frequently (handled in chat component)\n    pollingIntervalRef.current = setInterval(() => {\n      pollForNewMessages();\n    }, 5000);\n\n    return () => {\n      if (pollingIntervalRef.current) {\n        clearInterval(pollingIntervalRef.current);\n        pollingIntervalRef.current = null;\n      }\n      // Clean up notification debounce timers\n      notificationDebounceRef.current.forEach((timeout) => clearTimeout(timeout));\n      notificationDebounceRef.current.clear();\n    };\n  }, [pollForNewMessages, isUser, chatId]);\n\n\n  return {\n    stopPolling: () => {\n      if (pollingIntervalRef.current) {\n        clearInterval(pollingIntervalRef.current);\n        pollingIntervalRef.current = null;\n      }\n      // Clean up notification debounce timers\n      notificationDebounceRef.current.forEach((timeout) => clearTimeout(timeout));\n      notificationDebounceRef.current.clear();\n    },\n  };\n}\n\n","\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { logger } from \"@/lib/logger-client\";\n\ninterface NotificationOptions {\n  title: string;\n  body: string;\n  icon?: string;\n  badge?: string;\n  tag?: string;\n  requireInteraction?: boolean;\n  sound?: boolean;\n}\n\nexport function useNotifications() {\n  const [permission, setPermission] = useState<NotificationPermission>(\"default\");\n  const lastNotificationRef = useRef<string | null>(null);\n\n  useEffect(() => {\n    // Check if browser supports notifications\n    if (typeof window === \"undefined\" || !(\"Notification\" in window)) {\n      return;\n    }\n\n    // Get current permission\n    setPermission(Notification.permission);\n\n    // Request permission if not granted\n    if (Notification.permission === \"default\") {\n      Notification.requestPermission().then((perm) => {\n        setPermission(perm);\n      });\n    }\n  }, []);\n\n  const requestPermission = async (): Promise<boolean> => {\n    if (typeof window === \"undefined\" || !(\"Notification\" in window)) {\n      return false;\n    }\n\n    if (Notification.permission === \"granted\") {\n      return true;\n    }\n\n    const perm = await Notification.requestPermission();\n    setPermission(perm);\n    return perm === \"granted\";\n  };\n\n  // Play notification sound using Web Audio API\n  const playNotificationSound = () => {\n    try {\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      const oscillator = audioContext.createOscillator();\n      const gainNode = audioContext.createGain();\n\n      oscillator.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n\n      // Create a pleasant notification sound (two-tone beep)\n      oscillator.frequency.setValueAtTime(800, audioContext.currentTime);\n      oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);\n      oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.2);\n\n      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);\n\n      oscillator.start(audioContext.currentTime);\n      oscillator.stop(audioContext.currentTime + 0.3);\n    } catch (error) {\n      logger.error(\"Error playing notification sound:\", error);\n    }\n  };\n\n  const showNotification = async (\n    options: NotificationOptions,\n    preventDuplicate = true\n  ) => {\n    // Check if browser supports notifications\n    if (typeof window === \"undefined\" || !(\"Notification\" in window)) {\n      return;\n    }\n\n    // Request permission if needed\n    if (Notification.permission !== \"granted\") {\n      const granted = await requestPermission();\n      if (!granted) {\n        return;\n      }\n    }\n\n    // Prevent duplicate notifications\n    if (preventDuplicate && lastNotificationRef.current === options.tag) {\n      return;\n    }\n\n    // Play sound if enabled (default: true)\n    if (options.sound !== false) {\n      playNotificationSound();\n    }\n\n    try {\n      const notification = new Notification(options.title, {\n        body: options.body,\n        icon: options.icon || \"/favicon.ico\",\n        badge: options.badge || \"/favicon.ico\",\n        tag: options.tag,\n        requireInteraction: options.requireInteraction || false,\n        dir: \"rtl\",\n        lang: \"fa\",\n      });\n\n      // Update last notification tag\n      if (options.tag) {\n        lastNotificationRef.current = options.tag;\n      }\n\n      // Auto close after 5 seconds\n      setTimeout(() => {\n        notification.close();\n      }, 5000);\n\n      // Handle click\n      notification.onclick = () => {\n        window.focus();\n        notification.close();\n      };\n\n      return notification;\n    } catch (error) {\n      logger.error(\"Error showing notification:\", error);\n    }\n  };\n\n  return {\n    permission,\n    requestPermission,\n    showNotification,\n    isSupported: typeof window !== \"undefined\" && \"Notification\" in window,\n  };\n}\n\n\n","\"use client\";\n\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nimport { logger } from \"@/lib/logger-client\";\n\nexport type NotificationType = \"message\" | \"order\" | \"system\" | \"alert\";\nexport type NotificationPriority = \"low\" | \"medium\" | \"high\" | \"urgent\";\n\nexport interface PersistentNotification {\n  id: string;\n  type: NotificationType;\n  priority: NotificationPriority;\n  title: string;\n  message: string;\n  sender?: string;\n  avatar?: string;\n  timestamp: number;\n  read: boolean;\n  dismissed: boolean;\n  actions?: {\n    label: string;\n    action: () => void;\n    variant?: \"default\" | \"destructive\" | \"outline\";\n  }[];\n  onConfirm?: () => void;\n  onDismiss?: () => void;\n  metadata?: Record<string, any>;\n  persistent: boolean; // If true, remains until manually dismissed\n  sound?: boolean;\n  vibration?: boolean;\n}\n\ninterface NotificationStore {\n  notifications: PersistentNotification[];\n  addNotification: (notification: Omit<PersistentNotification, \"id\" | \"timestamp\" | \"read\" | \"dismissed\">) => string;\n  removeNotification: (id: string) => void;\n  markAsRead: (id: string) => void;\n  markAllAsRead: () => void;\n  dismissNotification: (id: string) => void;\n  dismissAll: () => void;\n  getUnreadCount: () => number;\n  getUnreadCountExcludingChat: (chatId: string | null) => number;\n  getNotificationsExcludingChat: (chatId: string | null) => PersistentNotification[];\n  clearAll: () => void;\n}\n\nexport const useNotificationStore = create<NotificationStore>()(\n  persist(\n    (set, get) => ({\n      notifications: [],\n\n      addNotification: (notification) => {\n        // If notification has a custom ID in metadata, use it; otherwise generate one\n        const customId = notification.metadata?.notificationId;\n        const id = customId || `notif-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        \n        // Check if notification with same ID already exists (for chat messages)\n        const existing = get().notifications.find((n) => n.id === id);\n        if (existing && !existing.dismissed) {\n          // Update existing notification instead of creating duplicate\n          logger.debug(`[Notification Store] Updating existing notification ${id}`);\n          set((state) => ({\n            notifications: state.notifications.map((n) =>\n              n.id === id\n                ? {\n                    ...n,\n                    ...notification,\n                    timestamp: Date.now(),\n                    read: false,\n                    dismissed: false,\n                  }\n                : n\n            ),\n          }));\n          return id;\n        }\n        \n        const newNotification: PersistentNotification = {\n          ...notification,\n          id,\n          timestamp: Date.now(),\n          read: false,\n          dismissed: false,\n        };\n\n        logger.debug(`[Notification Store] Adding new notification ${id}`, {\n          type: newNotification.type,\n          title: newNotification.title,\n          chatId: newNotification.metadata?.chatId,\n          isAdmin: newNotification.metadata?.isAdmin,\n        });\n\n        set((state) => ({\n          notifications: [newNotification, ...state.notifications.filter((n) => n.id !== id)].slice(0, 50), // Keep max 50 notifications\n        }));\n\n        return id;\n      },\n\n      removeNotification: (id) => {\n        set((state) => ({\n          notifications: state.notifications.filter((n) => n.id !== id),\n        }));\n      },\n\n      markAsRead: (id) => {\n        set((state) => ({\n          notifications: state.notifications.map((n) =>\n            n.id === id ? { ...n, read: true } : n\n          ),\n        }));\n      },\n\n      markAllAsRead: () => {\n        set((state) => ({\n          notifications: state.notifications.map((n) => ({ ...n, read: true })),\n        }));\n      },\n\n      dismissNotification: (id) => {\n        const notification = get().notifications.find((n) => n.id === id);\n        if (notification?.onDismiss) {\n          notification.onDismiss();\n        }\n        \n        set((state) => ({\n          notifications: state.notifications.filter((n) => n.id !== id),\n        }));\n      },\n\n      dismissAll: () => {\n        set((state) => ({\n          notifications: state.notifications.filter((n) => n.persistent),\n        }));\n      },\n\n      getUnreadCount: () => {\n        return get().notifications.filter((n) => !n.read && !n.dismissed).length;\n      },\n\n      getUnreadCountExcludingChat: (chatId: string | null) => {\n        if (!chatId) {\n          return get().getUnreadCount();\n        }\n        return get().notifications.filter(\n          (n) => !n.read && !n.dismissed && !(n.metadata?.chatId === chatId && n.metadata?.isAdmin)\n        ).length;\n      },\n\n      getNotificationsExcludingChat: (chatId: string | null) => {\n        if (!chatId) {\n          return get().notifications;\n        }\n        return get().notifications.filter(\n          (n) => !(n.metadata?.chatId === chatId && n.metadata?.isAdmin)\n        );\n      },\n\n      clearAll: () => {\n        set({ notifications: [] });\n      },\n    }),\n    {\n      name: \"notification-storage\",\n      partialize: (state) => ({\n        notifications: state.notifications.filter((n) => n.read).slice(0, 20), // Only persist read notifications\n      }),\n    }\n  )\n);\n\n","\"use client\";\n\nimport { useCallback, useEffect } from \"react\";\nimport { useNotificationStore, PersistentNotification, NotificationType, NotificationPriority } from \"@/store/notification-store\";\nimport { useNotifications } from \"./use-notifications\";\nimport { logger } from \"@/lib/logger-client\";\n\ninterface ShowNotificationOptions {\n  type?: NotificationType;\n  priority?: NotificationPriority;\n  title: string;\n  message: string;\n  sender?: string;\n  avatar?: string;\n  actions?: {\n    label: string;\n    action: () => void;\n    variant?: \"default\" | \"destructive\" | \"outline\";\n  }[];\n  onConfirm?: () => void;\n  onDismiss?: () => void;\n  metadata?: Record<string, any>;\n  persistent?: boolean;\n  sound?: boolean;\n  vibration?: boolean;\n}\n\nexport function usePersistentNotifications() {\n  const {\n    notifications,\n    addNotification,\n    removeNotification,\n    markAsRead,\n    markAllAsRead,\n    dismissNotification,\n    getUnreadCount,\n  } = useNotificationStore();\n\n  const { showNotification: showBrowserNotification } = useNotifications();\n\n  // Play notification sound\n  const playNotificationSound = useCallback((type: NotificationType, priority: NotificationPriority) => {\n    try {\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      const oscillator = audioContext.createOscillator();\n      const gainNode = audioContext.createGain();\n\n      oscillator.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n\n      // Different sounds based on priority and type\n      if (priority === \"urgent\" || priority === \"high\") {\n        // Urgent sound: three quick beeps\n        oscillator.frequency.setValueAtTime(1000, audioContext.currentTime);\n        oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.1);\n        oscillator.frequency.setValueAtTime(1000, audioContext.currentTime + 0.2);\n        oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.3);\n        oscillator.frequency.setValueAtTime(1000, audioContext.currentTime + 0.4);\n        \n        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\n        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);\n        \n        oscillator.start(audioContext.currentTime);\n        oscillator.stop(audioContext.currentTime + 0.5);\n      } else {\n        // Normal sound: two-tone beep\n        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);\n        oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);\n        oscillator.frequency.setValueAtTime(800, audioContext.currentTime + 0.2);\n        \n        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\n        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);\n        \n        oscillator.start(audioContext.currentTime);\n        oscillator.stop(audioContext.currentTime + 0.3);\n      }\n    } catch (error) {\n      logger.error(\"Error playing notification sound:\", error);\n    }\n  }, []);\n\n  // Vibrate device if supported\n  const vibrateDevice = useCallback((pattern: number[]) => {\n    if (\"vibrate\" in navigator) {\n      try {\n        navigator.vibrate(pattern);\n      } catch (error) {\n        logger.error(\"Error vibrating device:\", error);\n      }\n    }\n  }, []);\n\n  const showNotification = useCallback(\n    (options: ShowNotificationOptions): string => {\n      const {\n        type = \"message\",\n        priority = \"medium\",\n        title,\n        message,\n        sender,\n        avatar,\n        actions,\n        onConfirm,\n        onDismiss,\n        metadata,\n        persistent = true,\n        sound = true,\n        vibration = false,\n      } = options;\n\n      // Play sound if enabled\n      if (sound) {\n        playNotificationSound(type, priority);\n      }\n\n      // Vibrate if enabled\n      if (vibration && priority === \"urgent\") {\n        vibrateDevice([200, 100, 200]);\n      }\n\n      // Show browser notification if permission granted\n      showBrowserNotification({\n        title,\n        body: message,\n        tag: `persistent-${Date.now()}`,\n        requireInteraction: persistent,\n        sound: false, // We handle sound separately\n      }).catch(() => {\n        // Ignore if permission not granted\n      });\n\n      // Add to persistent notification store\n      const id = addNotification({\n        type,\n        priority,\n        title,\n        message,\n        sender,\n        avatar,\n        actions,\n        onConfirm,\n        onDismiss,\n        metadata,\n        persistent,\n        sound,\n        vibration,\n      });\n\n      return id;\n    },\n    [addNotification, playNotificationSound, vibrateDevice, showBrowserNotification]\n  );\n\n  const showMessageNotification = useCallback(\n    (\n      sender: string,\n      message: string,\n      options?: {\n        avatar?: string;\n        onOpen?: () => void;\n        chatId?: string;\n        metadata?: Record<string, any>;\n      }\n    ) => {\n      const { avatar, onOpen, chatId, metadata } = options || {};\n\n      // Use chatId as notification ID to update existing notifications for the same chat\n      // This ensures we have one notification per chat that gets updated with new messages\n      const notificationId = chatId ? `msg-${chatId}` : undefined;\n\n      return showNotification({\n        type: \"message\",\n        priority: \"high\",\n        title: `پیام جدید از ${sender}`,\n        message,\n        sender,\n        avatar,\n        persistent: true,\n        sound: true,\n        actions: chatId\n          ? [\n              {\n                label: \"مشاهده\",\n                action: () => {\n                  // Dispatch custom event to open chat\n                  const event = new CustomEvent(\"openChat\", {\n                    detail: {\n                      chatId: chatId,\n                      isAdmin: metadata?.isAdmin !== false, // Default to true for admin\n                    },\n                  });\n                  window.dispatchEvent(event);\n                  \n                  // Also call onOpen if provided\n                  if (onOpen) {\n                    onOpen();\n                  }\n                  \n                  // Mark as read and dismiss notification\n                  if (notificationId) {\n                    markAsRead(notificationId);\n                    dismissNotification(notificationId);\n                  }\n                },\n                variant: \"default\" as const,\n              },\n            ]\n          : onOpen\n          ? [\n              {\n                label: \"مشاهده\",\n                action: () => {\n                  if (onOpen) {\n                    onOpen();\n                  }\n                },\n                variant: \"default\" as const,\n              },\n            ]\n          : undefined,\n        onConfirm: onOpen,\n        metadata: { chatId, notificationId, ...metadata },\n      });\n    },\n    [showNotification, markAsRead, dismissNotification]\n  );\n\n  return {\n    notifications: notifications.filter((n) => !n.dismissed),\n    showNotification,\n    showMessageNotification,\n    removeNotification,\n    markAsRead,\n    markAllAsRead,\n    dismissNotification,\n    unreadCount: getUnreadCount(),\n  };\n}\n\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Bell\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTAuMjY4IDIxYTIgMiAwIDAgMCAzLjQ2NCAwIiAvPgogIDxwYXRoIGQ9Ik0zLjI2MiAxNS4zMjZBMSAxIDAgMCAwIDQgMTdoMTZhMSAxIDAgMCAwIC43NC0xLjY3M0MxOS40MSAxMy45NTYgMTggMTIuNDk5IDE4IDhBNiA2IDAgMCAwIDYgOGMwIDQuNDk5LTEuNDExIDUuOTU2LTIuNzM4IDcuMzI2IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/bell\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Bell = createLucideIcon('Bell', [\n  ['path', { d: 'M10.268 21a2 2 0 0 0 3.464 0', key: 'vwvbt9' }],\n  [\n    'path',\n    {\n      d: 'M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326',\n      key: '11g9vi',\n    },\n  ],\n]);\n\nexport default Bell;\n","\"use client\";\n\nimport * as React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport {\n  MessageCircle,\n  X,\n  Check,\n  AlertCircle,\n  Info,\n  Bell,\n  User,\n  ShoppingCart,\n  ArrowLeft,\n  Clock,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { cn } from \"@/lib/utils\";\nimport { PersistentNotification, NotificationType, NotificationPriority } from \"@/store/notification-store\";\n\ninterface PersistentNotificationProps {\n  notification: PersistentNotification;\n  onConfirm?: () => void;\n  onDismiss?: () => void;\n  onMarkAsRead?: () => void;\n}\n\nconst getNotificationIcon = (type: NotificationType) => {\n  switch (type) {\n    case \"message\":\n      return MessageCircle;\n    case \"order\":\n      return ShoppingCart;\n    case \"alert\":\n      return AlertCircle;\n    case \"system\":\n      return Info;\n    default:\n      return Bell;\n  }\n};\n\nconst getPriorityColor = (priority: NotificationPriority) => {\n  switch (priority) {\n    case \"urgent\":\n      return \"bg-red-500\";\n    case \"high\":\n      return \"bg-orange-500\";\n    case \"medium\":\n      return \"bg-blue-500\";\n    case \"low\":\n      return \"bg-gray-500\";\n    default:\n      return \"bg-blue-500\";\n  }\n};\n\nconst getPriorityVariant = (priority: NotificationPriority): \"default\" | \"destructive\" | \"secondary\" => {\n  switch (priority) {\n    case \"urgent\":\n      return \"destructive\";\n    case \"high\":\n      return \"secondary\";\n    default:\n      return \"default\";\n  }\n};\n\nconst formatTime = (timestamp: number) => {\n  const now = Date.now();\n  const diff = now - timestamp;\n  const seconds = Math.floor(diff / 1000);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n\n  if (seconds < 60) return \"همین الان\";\n  if (minutes < 60) return `${minutes} دقیقه پیش`;\n  if (hours < 24) return `${hours} ساعت پیش`;\n  \n  const date = new Date(timestamp);\n  return date.toLocaleDateString(\"fa-IR\", {\n    month: \"short\",\n    day: \"numeric\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n  });\n};\n\nexport function PersistentNotificationComponent({\n  notification,\n  onConfirm,\n  onDismiss,\n  onMarkAsRead,\n}: PersistentNotificationProps) {\n  const Icon = getNotificationIcon(notification.type);\n  const [isExpanded, setIsExpanded] = React.useState(false);\n\n  const handleConfirm = () => {\n    if (onConfirm) {\n      onConfirm();\n    }\n    if (notification.onConfirm) {\n      notification.onConfirm();\n    }\n    if (onMarkAsRead) {\n      onMarkAsRead();\n    }\n  };\n\n  const handleDismiss = () => {\n    if (onDismiss) {\n      onDismiss();\n    }\n    if (notification.onDismiss) {\n      notification.onDismiss();\n    }\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: -50, scale: 0.95, x: 20 }}\n      animate={{ opacity: 1, y: 0, scale: 1, x: 0 }}\n      exit={{ opacity: 0, y: -20, scale: 0.95, x: 20, transition: { duration: 0.2 } }}\n      whileHover={{ scale: 1.02, y: -2 }}\n      transition={{\n        type: \"spring\",\n        stiffness: 300,\n        damping: 25,\n      }}\n      className={cn(\n        \"relative w-full max-w-lg sm:max-w-xl pointer-events-auto\",\n        !notification.read && \"ring-2 ring-primary/40 shadow-lg\"\n      )}\n      onAnimationComplete={() => {\n        // Auto-expand urgent notifications and message notifications\n        if ((notification.priority === \"urgent\" || notification.type === \"message\") && !isExpanded) {\n          setIsExpanded(true);\n        }\n      }}\n    >\n      <motion.div\n        className={cn(\n          \"group relative w-full rounded-lg sm:rounded-xl py-2 px-2.5 sm:py-3 sm:px-4 shadow-sm sm:shadow-lg backdrop-blur-sm sm:backdrop-blur-md transition-all duration-300 cursor-pointer border\",\n          notification.priority === \"urgent\"\n            ? \"bg-gradient-to-br from-red-50/95 via-background to-red-50/60 dark:from-red-950/30 dark:via-background dark:to-red-950/15 border-red-200/50 dark:border-red-800/30 hover:border-red-300 dark:hover:border-red-700\"\n            : notification.priority === \"high\"\n            ? \"bg-gradient-to-br from-orange-50/60 via-background to-orange-50/40 dark:from-orange-950/15 dark:via-background dark:to-orange-950/8 border-orange-200/40 dark:border-orange-800/20 hover:border-orange-300 dark:hover:border-orange-700\"\n            : \"bg-gradient-to-br from-background via-background to-primary/8 border-border/50 hover:border-primary/30\",\n          !notification.read && \"shadow-md hover:shadow-lg\"\n        )}\n        onClick={() => {\n          handleConfirm();\n        }}\n        whileHover={{ \n          boxShadow: \"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)\" \n        }}\n      >\n        {/* Priority indicator bar */}\n        <div\n          className={cn(\n            \"absolute top-0 right-0 left-0 h-0.5 sm:h-1 rounded-t-lg sm:rounded-t-xl\",\n            getPriorityColor(notification.priority)\n          )}\n        />\n\n        {/* Unread indicator */}\n        {!notification.read && (\n          <motion.div\n            className=\"absolute top-1.5 left-1.5 sm:top-2 sm:left-2 w-2 h-2 sm:w-2.5 sm:h-2.5 rounded-full bg-primary shadow-lg\"\n            animate={{ \n              scale: [1, 1.3, 1],\n              opacity: [1, 0.7, 1]\n            }}\n            transition={{ repeat: Infinity, duration: 2 }}\n          >\n            <motion.div\n              className=\"absolute inset-0 rounded-full bg-primary/50\"\n              animate={{ scale: [1, 2, 2], opacity: [0.5, 0, 0] }}\n              transition={{ repeat: Infinity, duration: 2 }}\n            />\n          </motion.div>\n        )}\n\n        <div className=\"flex items-start gap-1.5 sm:gap-3\">\n          {/* Avatar/Icon */}\n          <motion.div\n            className=\"relative flex-shrink-0\"\n            initial={{ scale: 0, rotate: -180 }}\n            animate={{ scale: 1, rotate: 0 }}\n            transition={{ type: \"spring\", stiffness: 200, damping: 15, delay: 0.1 }}\n          >\n            {notification.avatar ? (\n              <motion.div \n                className=\"relative w-7 h-7 sm:w-10 sm:h-10 rounded-full overflow-hidden ring-2 ring-primary/30 shadow-md\"\n                whileHover={{ scale: 1.1 }}\n                transition={{ type: \"spring\", stiffness: 400, damping: 17 }}\n              >\n                <img\n                  src={notification.avatar}\n                  alt={notification.sender || notification.title}\n                  className=\"w-full h-full object-cover\"\n                />\n                {!notification.read && (\n                  <motion.div\n                    className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 sm:w-3.5 sm:h-3.5 bg-green-500 rounded-full border-2 border-background\"\n                    initial={{ scale: 0 }}\n                    animate={{ scale: 1 }}\n                    transition={{ delay: 0.2 }}\n                  />\n                )}\n              </motion.div>\n            ) : (\n              <motion.div\n                className={cn(\n                  \"w-7 h-7 sm:w-10 sm:h-10 rounded-full flex items-center justify-center shadow-md ring-2 ring-primary/20\",\n                  notification.type === \"message\"\n                    ? \"bg-gradient-to-br from-primary/25 via-primary/20 to-accent/25\"\n                    : notification.type === \"order\"\n                    ? \"bg-gradient-to-br from-green-500/25 via-green-500/20 to-green-400/25\"\n                    : \"bg-gradient-to-br from-blue-500/25 via-blue-500/20 to-blue-400/25\"\n                )}\n                whileHover={{ scale: 1.1, rotate: 5 }}\n                transition={{ type: \"spring\", stiffness: 400, damping: 17 }}\n              >\n                <Icon className=\"h-3.5 w-3.5 sm:h-5 sm:w-5 text-primary\" />\n              </motion.div>\n            )}\n            {notification.priority === \"urgent\" && (\n              <motion.div\n                className=\"absolute -top-0.5 -right-0.5 sm:-top-1 sm:-right-1 w-4 h-4 sm:w-5 sm:h-5 bg-red-500 rounded-full border border-background sm:border-2 shadow-md sm:shadow-lg flex items-center justify-center\"\n                animate={{ scale: [1, 1.2, 1] }}\n                transition={{ repeat: Infinity, duration: 1 }}\n              >\n                <Bell className=\"h-2.5 w-2.5 sm:h-3 sm:w-3 text-white\" />\n              </motion.div>\n            )}\n          </motion.div>\n\n          {/* Content */}\n          <div className=\"flex-1 min-w-0 space-y-1 sm:space-y-2\">\n            <div className=\"flex items-start justify-between gap-1 sm:gap-2\">\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"flex items-center gap-1 sm:gap-1.5 mb-0.5 sm:mb-1 flex-wrap\">\n                  <h4 className=\"text-xs sm:text-sm font-semibold text-foreground truncate\">\n                    {notification.title}\n                  </h4>\n                  <Badge\n                    variant={getPriorityVariant(notification.priority)}\n                    className=\"text-[9px] sm:text-[10px] px-1 sm:px-1.5 py-0 h-4 sm:h-5\"\n                  >\n                    {notification.priority === \"urgent\"\n                      ? \"فوری\"\n                      : notification.priority === \"high\"\n                      ? \"مهم\"\n                      : notification.priority === \"medium\"\n                      ? \"متوسط\"\n                      : \"کم\"}\n                  </Badge>\n                </div>\n                {notification.sender && (\n                  <p className=\"text-[9px] sm:text-[10px] text-muted-foreground mb-0.5 sm:mb-1 flex items-center gap-0.5 sm:gap-1\">\n                    <User className=\"h-2 w-2 sm:h-2.5 sm:w-2.5\" />\n                    {notification.sender}\n                  </p>\n                )}\n                <motion.p\n                  className={cn(\n                    \"text-[10px] sm:text-xs text-muted-foreground leading-tight sm:leading-relaxed transition-all duration-300\",\n                    isExpanded ? \"line-clamp-none\" : \"line-clamp-2\"\n                  )}\n                  initial={{ opacity: 0.8 }}\n                  animate={{ opacity: 1 }}\n                  transition={{ delay: 0.1 }}\n                >\n                  {notification.message}\n                </motion.p>\n                <div className=\"flex items-center gap-1 sm:gap-1.5 mt-0.5 sm:mt-1 text-[9px] sm:text-[10px] text-muted-foreground\">\n                  <Clock className=\"h-2 w-2 sm:h-2.5 sm:w-2.5\" />\n                  <span>{formatTime(notification.timestamp)}</span>\n                </div>\n              </div>\n              <motion.div\n                whileHover={{ scale: 1.1 }}\n                whileTap={{ scale: 0.9 }}\n              >\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleDismiss();\n                  }}\n                  className=\"h-5 w-5 sm:h-7 sm:w-7 rounded-full hover:bg-destructive/10 hover:text-destructive flex-shrink-0 transition-colors\"\n                >\n                  <X className=\"h-2.5 w-2.5 sm:h-3.5 sm:w-3.5\" />\n                </Button>\n              </motion.div>\n            </div>\n\n          </div>\n        </div>\n\n        {/* Decorative gradient overlay */}\n        <div className=\"absolute inset-0 bg-gradient-to-br from-primary/3 sm:from-primary/5 via-transparent to-accent/3 sm:to-accent/5 pointer-events-none rounded-lg sm:rounded-xl\" />\n\n        {/* Pulse effect for urgent notifications */}\n        {notification.priority === \"urgent\" && (\n          <motion.div\n            className=\"absolute inset-0 rounded-lg sm:rounded-xl border border-red-500/20 sm:border-2 sm:border-red-500/30\"\n            animate={{\n              opacity: [0.5, 1, 0.5],\n              scale: [1, 1.02, 1],\n            }}\n            transition={{\n              repeat: Infinity,\n              duration: 2,\n            }}\n          />\n        )}\n      </motion.div>\n    </motion.div>\n  );\n}\n\n","\"use client\";\n\nimport * as React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { X, CheckCheck, Bell } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { PersistentNotificationComponent } from \"./persistent-notification\";\nimport { usePersistentNotifications } from \"@/hooks/use-persistent-notifications\";\nimport { cn } from \"@/lib/utils\";\n\ninterface NotificationCenterProps {\n  position?: \"top-right\" | \"top-left\" | \"bottom-right\" | \"bottom-left\";\n  maxNotifications?: number;\n  className?: string;\n}\n\nexport function NotificationCenter({\n  position = \"top-right\",\n  maxNotifications = 5,\n  className,\n}: NotificationCenterProps) {\n  const {\n    notifications,\n    markAsRead,\n    markAllAsRead,\n    dismissNotification,\n    unreadCount,\n  } = usePersistentNotifications();\n\n  // Track currently open chat\n  const [openChatId, setOpenChatId] = React.useState<string | null>(null);\n\n  // Listen for chat open/close events\n  React.useEffect(() => {\n    const updateOpenChat = () => {\n      if (typeof window !== \"undefined\") {\n        const storedChatId = localStorage.getItem('admin_selected_chat_id');\n        setOpenChatId(storedChatId);\n      }\n    };\n\n    // Check on mount\n    updateOpenChat();\n\n    // Listen for storage changes (when chat is opened/closed)\n    const handleStorageChange = (e: StorageEvent) => {\n      if (e.key === 'admin_selected_chat_id') {\n        updateOpenChat();\n      }\n    };\n\n    // Listen for custom events\n    const handleChatOpen = (e: CustomEvent) => {\n      if (e.detail?.chatId) {\n        setOpenChatId(e.detail.chatId);\n      }\n    };\n\n    const handleChatOpened = (e: CustomEvent) => {\n      if (e.detail?.chatId) {\n        setOpenChatId(e.detail.chatId);\n      }\n    };\n\n    const handleChatClose = () => {\n      setOpenChatId(null);\n    };\n\n    window.addEventListener('storage', handleStorageChange);\n    window.addEventListener('openChat', handleChatOpen as EventListener);\n    window.addEventListener('chatOpened', handleChatOpened as EventListener);\n    window.addEventListener('closeChat', handleChatClose);\n    window.addEventListener('chatClosed', handleChatClose);\n\n    // Poll for changes (fallback for same-window updates)\n    const interval = setInterval(updateOpenChat, 500);\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange);\n      window.removeEventListener('openChat', handleChatOpen as EventListener);\n      window.removeEventListener('closeChat', handleChatClose);\n      clearInterval(interval);\n    };\n  }, []);\n\n  // Filter persistent notifications, excluding those from the currently open chat\n  const persistentNotifications = notifications.filter((n) => {\n    if (!n.persistent || n.dismissed) return false;\n    \n    // For admin notifications: filter out notifications from the currently open chat\n    // This allows notifications from other users to show even when chatting with one user\n    if (n.metadata?.isAdmin && n.metadata?.chatId && openChatId) {\n      const shouldShow = n.metadata.chatId !== openChatId;\n      if (process.env.NODE_ENV === 'development') {\n        console.log(`[Notification Center] Notification ${n.id} from chat ${n.metadata.chatId}: openChatId=${openChatId}, shouldShow=${shouldShow}`);\n      }\n      return shouldShow;\n    }\n    \n    // Show all notifications if no chat is open, or if it's not an admin notification\n    return true;\n  });\n  \n  if (process.env.NODE_ENV === 'development') {\n    console.log(`[Notification Center] Total notifications: ${notifications.length}, Persistent: ${persistentNotifications.length}, Open chat: ${openChatId || 'none'}`);\n  }\n\n  // Sort by priority and timestamp (newest and highest priority first)\n  const sortedNotifications = persistentNotifications.sort((a, b) => {\n    // First sort by read status (unread first)\n    if (a.read !== b.read) {\n      return a.read ? 1 : -1;\n    }\n    // Then by priority\n    const priorityOrder = { urgent: 4, high: 3, medium: 2, low: 1 };\n    const priorityDiff = (priorityOrder[b.priority] || 0) - (priorityOrder[a.priority] || 0);\n    if (priorityDiff !== 0) return priorityDiff;\n    // Finally by timestamp (newest first)\n    return b.timestamp - a.timestamp;\n  });\n\n  const visibleNotifications = sortedNotifications.slice(0, maxNotifications);\n\n  const positionClasses = {\n    \"top-right\": \"top-4 right-4\",\n    \"top-left\": \"top-4 left-4\",\n    \"bottom-right\": \"bottom-4 right-4\",\n    \"bottom-left\": \"bottom-4 left-4\",\n  };\n\n  if (visibleNotifications.length === 0) {\n    return null;\n  }\n\n  return (\n    <div\n      className={cn(\n        \"fixed z-[9999] pointer-events-none flex flex-col gap-2 sm:gap-3\",\n        positionClasses[position],\n        className\n      )}\n    >\n      <AnimatePresence mode=\"popLayout\">\n        {visibleNotifications.map((notification, index) => (\n          <motion.div\n            key={notification.id}\n            layout\n            initial={{ opacity: 0, scale: 0.8, y: -20, x: position.includes('right') ? 20 : -20 }}\n            animate={{ opacity: 1, scale: 1, y: 0, x: 0 }}\n            exit={{ \n              opacity: 0, \n              scale: 0.8, \n              y: -20, \n              x: position.includes('right') ? 20 : -20,\n              transition: { duration: 0.2 } \n            }}\n            transition={{\n              type: \"spring\",\n              stiffness: 300,\n              damping: 25,\n              delay: index * 0.05,\n            }}\n            className=\"pointer-events-auto\"\n          >\n            <PersistentNotificationComponent\n              notification={notification}\n              onConfirm={() => {\n                // Dispatch custom event to open chat\n                if (notification.metadata?.chatId) {\n                  const event = new CustomEvent(\"openChat\", {\n                    detail: {\n                      chatId: notification.metadata.chatId,\n                      isAdmin: notification.metadata.isAdmin !== false, // Default to true for admin\n                    },\n                  });\n                  window.dispatchEvent(event);\n                }\n                \n                if (notification.onConfirm) {\n                  notification.onConfirm();\n                }\n                \n                // Mark as read and dismiss notification\n                markAsRead(notification.id);\n                dismissNotification(notification.id);\n              }}\n              onDismiss={() => {\n                dismissNotification(notification.id);\n              }}\n              onMarkAsRead={() => {\n                markAsRead(notification.id);\n              }}\n            />\n          </motion.div>\n        ))}\n      </AnimatePresence>\n\n      {/* Unread count badge - only count visible notifications */}\n      {(() => {\n        const visibleUnreadCount = visibleNotifications.filter(n => !n.read).length;\n        return visibleUnreadCount > 0 ? (\n          <motion.div\n            initial={{ scale: 0, rotate: -180 }}\n            animate={{ scale: 1, rotate: 0 }}\n            exit={{ scale: 0, rotate: 180 }}\n            transition={{ type: \"spring\", stiffness: 300, damping: 20 }}\n            className={cn(\n              \"fixed pointer-events-none z-[10000]\",\n              position === \"top-right\" ? \"top-2 right-2\" :\n              position === \"top-left\" ? \"top-2 left-2\" :\n              position === \"bottom-right\" ? \"bottom-2 right-2\" :\n              \"bottom-2 left-2\"\n            )}\n          >\n            <Badge\n              variant=\"destructive\"\n              className=\"h-6 px-2 text-xs font-bold shadow-lg flex items-center gap-1.5 animate-pulse\"\n            >\n              <Bell className=\"h-3 w-3\" />\n              {visibleUnreadCount}\n            </Badge>\n          </motion.div>\n        ) : null;\n      })()}\n    </div>\n  );\n}\n\n","\"use client\";\n\nimport React from \"react\";\nimport { AlertCircle } from \"lucide-react\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { Button } from \"@/components/ui/button\";\nimport { logError } from \"@/lib/api-error-handler\";\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n}\n\ninterface ErrorBoundaryProps {\n  children: React.ReactNode;\n  fallback?: React.ReactNode;\n}\n\nexport class ErrorBoundary extends React.Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    logError(error, \"ErrorBoundary\");\n    if (process.env.NODE_ENV === \"development\") {\n      // Log additional error info in development\n      logError(errorInfo, \"ErrorBoundary - ErrorInfo\");\n    }\n  }\n\n  handleReset = () => {\n    this.setState({ hasError: false, error: null });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div className=\"min-h-screen flex items-center justify-center p-4\">\n          <Alert variant=\"destructive\" className=\"max-w-md\">\n            <AlertCircle className=\"h-4 w-4\" />\n            <AlertTitle>خطایی رخ داد</AlertTitle>\n            <AlertDescription className=\"mt-2\">\n              <p className=\"mb-4\">\n                متأسفانه خطایی در سیستم رخ داده است. لطفاً صفحه را رفرش کنید.\n              </p>\n              {process.env.NODE_ENV === \"development\" && this.state.error && (\n                <details className=\"mt-2\">\n                  <summary className=\"cursor-pointer text-sm font-medium\">\n                    جزئیات خطا (فقط در حالت توسعه)\n                  </summary>\n                  <pre className=\"mt-2 text-xs overflow-auto bg-muted p-2 rounded\">\n                    {this.state.error.toString()}\n                    {this.state.error.stack && (\n                      <div className=\"mt-2\">{this.state.error.stack}</div>\n                    )}\n                  </pre>\n                </details>\n              )}\n              <Button\n                onClick={this.handleReset}\n                className=\"mt-4\"\n                variant=\"outline\"\n              >\n                تلاش مجدد\n              </Button>\n            </AlertDescription>\n          </Alert>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","import * as React from \"react\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst alertVariants = cva(\r\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pr-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:right-4 [&>svg]:top-4 [&>svg]:text-foreground\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-background text-foreground\",\r\n        destructive:\r\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive bg-destructive/10\",\r\n        warning:\r\n          \"border-yellow-500/50 text-yellow-700 dark:text-yellow-400 dark:border-yellow-400 [&>svg]:text-yellow-600 dark:[&>svg]:text-yellow-400 bg-yellow-50 dark:bg-yellow-950/20\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n);\r\n\r\nconst Alert = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\r\n>(({ className, variant, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    role=\"alert\"\r\n    className={cn(alertVariants({ variant }), className)}\r\n    {...props}\r\n  />\r\n));\r\nAlert.displayName = \"Alert\";\r\n\r\nconst AlertTitle = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h5\r\n    ref={ref}\r\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\r\n    {...props}\r\n  />\r\n));\r\nAlertTitle.displayName = \"AlertTitle\";\r\n\r\nconst AlertDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\r\n    {...props}\r\n  />\r\n));\r\nAlertDescription.displayName = \"AlertDescription\";\r\n\r\nexport { Alert, AlertTitle, AlertDescription };\r\n\r\n","/**\r\n * Centralized logging utility\r\n * Disables console.log in production for better performance\r\n */\r\n\r\ntype LogLevel = 'log' | 'error' | 'warn' | 'info' | 'debug';\r\n\r\nclass Logger {\r\n  private isDevelopment = process.env.NODE_ENV === 'development';\r\n  private isProduction = process.env.NODE_ENV === 'production';\r\n\r\n  private shouldLog(level: LogLevel): boolean {\r\n    // Always log errors and warnings\r\n    if (level === 'error' || level === 'warn') {\r\n      return true;\r\n    }\r\n    // Only log other levels in development\r\n    return this.isDevelopment;\r\n  }\r\n\r\n  log(...args: any[]): void {\r\n    if (this.shouldLog('log')) {\r\n      console.log(...args);\r\n    }\r\n  }\r\n\r\n  error(...args: any[]): void {\r\n    console.error(...args);\r\n  }\r\n\r\n  warn(...args: any[]): void {\r\n    console.warn(...args);\r\n  }\r\n\r\n  info(...args: any[]): void {\r\n    if (this.shouldLog('info')) {\r\n      console.info(...args);\r\n    }\r\n  }\r\n\r\n  debug(...args: any[]): void {\r\n    if (this.shouldLog('debug')) {\r\n      console.debug(...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log database query (only in development)\r\n   */\r\n  dbQuery(query: string, params?: any[]): void {\r\n    if (this.isDevelopment) {\r\n      console.log('[DB Query]', query.substring(0, 100), params ? `[${params.length} params]` : '');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log API request (only in development)\r\n   */\r\n  apiRequest(method: string, path: string, statusCode?: number): void {\r\n    if (this.isDevelopment) {\r\n      console.log(`[API] ${method} ${path}${statusCode ? ` ${statusCode}` : ''}`);\r\n    }\r\n  }\r\n}\r\n\r\nexport const logger = new Logger();\r\n\r\n","/**\r\n * Centralized Error Handler\r\n * Provides consistent error handling and logging across the application\r\n */\r\n\r\nexport interface ApiError {\r\n  message: string;\r\n  status?: number;\r\n  code?: string;\r\n  details?: unknown;\r\n}\r\n\r\nexport class AppError extends Error {\r\n  status?: number;\r\n  code?: string;\r\n  details?: unknown;\r\n\r\n  constructor(message: string, status?: number, code?: string, details?: unknown) {\r\n    super(message);\r\n    this.name = \"AppError\";\r\n    this.status = status;\r\n    this.code = code;\r\n    this.details = details;\r\n    Object.setPrototypeOf(this, AppError.prototype);\r\n  }\r\n}\r\n\r\n/**\r\n * Network error types\r\n */\r\nexport enum NetworkErrorType {\r\n  TIMEOUT = \"TIMEOUT\",\r\n  NETWORK = \"NETWORK\",\r\n  ABORTED = \"ABORTED\",\r\n  UNKNOWN = \"UNKNOWN\",\r\n}\r\n\r\nexport class NetworkError extends Error {\r\n  type: NetworkErrorType;\r\n  originalError?: Error;\r\n\r\n  constructor(\r\n    message: string,\r\n    type: NetworkErrorType = NetworkErrorType.UNKNOWN,\r\n    originalError?: Error\r\n  ) {\r\n    super(message);\r\n    this.name = \"NetworkError\";\r\n    this.type = type;\r\n    this.originalError = originalError;\r\n    Object.setPrototypeOf(this, NetworkError.prototype);\r\n  }\r\n}\r\n\r\n/**\r\n * Import centralized logger\r\n */\r\nimport { logger } from \"@/lib/logger\";\r\n\r\n/**\r\n * Parse error from various sources\r\n */\r\nexport function parseError(error: unknown): ApiError {\r\n  if (error instanceof AppError) {\r\n    return {\r\n      message: error.message,\r\n      status: error.status,\r\n      code: error.code,\r\n      details: error.details,\r\n    };\r\n  }\r\n\r\n  if (error instanceof NetworkError) {\r\n    return {\r\n      message: error.message,\r\n      code: error.type,\r\n      details: error.originalError,\r\n    };\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    return {\r\n      message: error.message,\r\n    };\r\n  }\r\n\r\n  if (typeof error === \"string\") {\r\n    return {\r\n      message: error,\r\n    };\r\n  }\r\n\r\n  return {\r\n    message: \"خطای نامشخص رخ داد\",\r\n  };\r\n}\r\n\r\n/**\r\n * Get user-friendly error message\r\n */\r\nexport function getUserFriendlyMessage(error: unknown): string {\r\n  const parsed = parseError(error);\r\n\r\n  // Network errors\r\n  if (parsed.code === NetworkErrorType.TIMEOUT) {\r\n    return \"درخواست شما به دلیل طولانی شدن زمان پاسخ لغو شد. لطفاً دوباره تلاش کنید.\";\r\n  }\r\n\r\n  if (parsed.code === NetworkErrorType.NETWORK) {\r\n    return \"خطا در ارتباط با سرور. لطفاً اتصال اینترنت خود را بررسی کنید.\";\r\n  }\r\n\r\n  if (parsed.code === NetworkErrorType.ABORTED) {\r\n    return \"درخواست لغو شد.\";\r\n  }\r\n\r\n  // HTTP status codes\r\n  if (parsed.status) {\r\n    switch (parsed.status) {\r\n      case 400:\r\n        return parsed.message || \"درخواست نامعتبر است.\";\r\n      case 401:\r\n        return \"لطفاً دوباره وارد شوید.\";\r\n      case 403:\r\n        return \"شما دسترسی به این منبع ندارید.\";\r\n      case 404:\r\n        return \"منبع مورد نظر یافت نشد.\";\r\n      case 429:\r\n        return \"تعداد درخواست‌های شما بیش از حد مجاز است. لطفاً کمی صبر کنید.\";\r\n      case 500:\r\n        return \"خطای سرور. لطفاً بعداً تلاش کنید.\";\r\n      case 502:\r\n      case 503:\r\n      case 504:\r\n        return \"سرور در دسترس نیست. لطفاً بعداً تلاش کنید.\";\r\n      default:\r\n        return parsed.message || \"خطایی رخ داد.\";\r\n    }\r\n  }\r\n\r\n  return parsed.message || \"خطای نامشخص رخ داد.\";\r\n}\r\n\r\n/**\r\n * Log error (only in development)\r\n */\r\nexport function logError(error: unknown, context?: string): void {\r\n  const parsed = parseError(error);\r\n  const contextMsg = context ? `[${context}] ` : \"\";\r\n  \r\n  logger.error(`${contextMsg}${parsed.message}`, {\r\n    status: parsed.status,\r\n    code: parsed.code,\r\n    details: parsed.details,\r\n  });\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[4]}