{"version":3,"sources":["../../../../app/checkout/page.tsx","../../../../lib/validations/checkout.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useCartStore } from \"@/store/cart-store\";\nimport { useOrderStore } from \"@/store/order-store\";\nimport { useProductStore } from \"@/store/product-store\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ShoppingBag, Loader2, ArrowRight, AlertCircle, Package } from \"lucide-react\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { checkoutFormSchema, sanitizeCheckoutInput, type CheckoutFormData } from \"@/lib/validations/checkout\";\n\nexport default function CheckoutPage() {\n  const router = useRouter();\n  const { toast } = useToast();\n  const { items, getTotal, shippingMethod, clearCart } = useCartStore();\n  const { addOrder } = useOrderStore();\n  const { getProduct } = useProductStore();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [submitAttempted, setSubmitAttempted] = useState(false);\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    watch,\n    setValue,\n    reset,\n  } = useForm<CheckoutFormData>({\n    resolver: zodResolver(checkoutFormSchema),\n    mode: \"onChange\", // اعتبارسنجی هنگام تغییر\n    defaultValues: {\n      firstName: \"\",\n      lastName: \"\",\n      phone: \"\",\n      email: \"\",\n      address: \"\",\n      city: \"\",\n      postalCode: \"\",\n      province: \"\",\n      notes: \"\",\n    },\n  });\n\n  // بارگذاری اطلاعات checkout از localStorage (اگر وجود داشته باشد)\n  useEffect(() => {\n    const checkoutData = localStorage.getItem(\"checkoutData\");\n    if (checkoutData) {\n      try {\n        const data = JSON.parse(checkoutData);\n        if (data.formData) {\n          reset({\n            firstName: data.formData.firstName || \"\",\n            lastName: data.formData.lastName || \"\",\n            phone: data.formData.phone || \"\",\n            email: data.formData.email || \"\",\n            address: data.formData.address || \"\",\n            city: data.formData.city || \"\",\n            postalCode: data.formData.postalCode || \"\",\n            province: data.formData.province || \"\",\n            notes: data.formData.notes || \"\",\n          });\n        }\n      } catch (error) {\n        console.error(\"Error loading checkout data:\", error);\n      }\n    }\n  }, [reset]);\n\n  const total = getTotal();\n  \n  // Calculate shipping cost based on products and selected shipping method\n  const calculateShippingCost = () => {\n    if (!shippingMethod || items.length === 0) return 0;\n    \n    // Get the maximum shipping cost from all products (if multiple products, use the highest)\n    let maxShippingCost = 0;\n    \n    for (const item of items) {\n      const product = getProduct(item.id);\n      if (product) {\n        const productShippingCost = shippingMethod === \"air\" \n          ? (product.airShippingCost ?? null)\n          : (product.seaShippingCost ?? null);\n        \n        if (productShippingCost !== null && productShippingCost > maxShippingCost) {\n          maxShippingCost = productShippingCost;\n        }\n      }\n    }\n    \n    // If no shipping cost is set for products, use default logic (free over 500k)\n    if (maxShippingCost === 0) {\n      return total > 500000 ? 0 : 50000;\n    }\n    \n    return maxShippingCost;\n  };\n  \n  const shipping = calculateShippingCost();\n  const finalTotal = total + shipping;\n\n  // Sanitize phone input (only numbers)\n  const handlePhoneChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value.replace(/\\D/g, \"\");\n    if (value.length <= 11) {\n      setValue(\"phone\", value);\n    }\n  };\n\n  // Sanitize postal code input (only numbers)\n  const handlePostalCodeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value.replace(/\\D/g, \"\");\n    if (value.length <= 10) {\n      setValue(\"postalCode\", value);\n    }\n  };\n\n  const onSubmit = async (data: CheckoutFormData) => {\n    try {\n      console.log(\"onSubmit called with data:\", data);\n      setSubmitAttempted(true);\n      setIsSubmitting(true);\n\n      // Sanitize data\n      const sanitizedData = sanitizeCheckoutInput(data);\n      console.log(\"Sanitized data:\", sanitizedData);\n      console.log(\"Items count:\", items.length);\n      console.log(\"Items:\", items);\n\n      // بررسی اینکه سبد خرید خالی نباشد\n      if (items.length === 0) {\n        console.error(\"Cart is empty!\");\n        toast({\n          title: \"خطا\",\n          description: \"سبد خرید شما خالی است\",\n          variant: \"destructive\",\n        });\n        setIsSubmitting(false);\n        return;\n      }\n\n      // بررسی اینکه مبلغ نهایی معتبر باشد\n      console.log(\"Final total:\", finalTotal);\n      if (finalTotal <= 0 || !isFinite(finalTotal)) {\n        console.error(\"Invalid final total:\", finalTotal);\n        toast({\n          title: \"خطا\",\n          description: \"مبلغ سفارش نامعتبر است\",\n          variant: \"destructive\",\n        });\n        setIsSubmitting(false);\n        return;\n      }\n\n      // بررسی و اعتبارسنجی items قبل از ارسال\n      console.log(\"Validating items...\");\n      let validatedItems;\n      try {\n        validatedItems = items.map((item) => {\n          console.log(\"Validating item:\", item);\n          // بررسی فیلدهای ضروری\n          if (!item || typeof item !== \"object\") {\n            console.error(\"Invalid item object:\", item);\n            throw new Error(\"آیتم سفارش نامعتبر است\");\n          }\n\n          if (!item.id || String(item.id).trim() === \"\") {\n            console.error(\"Item missing id:\", item);\n            throw new Error(\"شناسه محصول مشخص نشده است\");\n          }\n\n          if (!item.name || String(item.name).trim() === \"\") {\n            console.error(\"Item missing name:\", item);\n            throw new Error(`نام محصول برای شناسه \"${item.id}\" مشخص نشده است`);\n          }\n\n          if (item.price === undefined || item.price === null || isNaN(Number(item.price))) {\n            console.error(\"Item missing or invalid price:\", item);\n            throw new Error(`قیمت محصول \"${item.name || item.id}\" مشخص نشده است`);\n          }\n\n          if (item.quantity === undefined || item.quantity === null || isNaN(Number(item.quantity))) {\n            console.error(\"Item missing or invalid quantity:\", item);\n            throw new Error(`تعداد محصول \"${item.name || item.id}\" مشخص نشده است`);\n          }\n\n          // اگر image خالی بود، از product store بگیر\n          let imageUrl = item.image ? String(item.image).trim() : \"\";\n          if (!imageUrl) {\n            const product = getProduct(item.id);\n            if (product && product.images && product.images.length > 0) {\n              imageUrl = product.images[0];\n            }\n          }\n\n          const validatedItem = {\n            id: String(item.id).trim(),\n            name: String(item.name).trim(),\n            price: Number(item.price),\n            quantity: Number(item.quantity),\n            image: imageUrl || \"\",\n          };\n          console.log(\"Validated item:\", validatedItem);\n          return validatedItem;\n        });\n        console.log(\"All items validated:\", validatedItems);\n      } catch (validationError) {\n        console.error(\"Validation error:\", validationError);\n        toast({\n          title: \"خطا\",\n          description: validationError instanceof Error ? validationError.message : \"خطا در اعتبارسنجی محصولات\",\n          variant: \"destructive\",\n        });\n        setIsSubmitting(false);\n        return;\n      }\n\n      // ابتدا سفارش را ثبت می‌کنیم (بدون پرداخت)\n      console.log(\"Sending order creation request...\");\n      const orderResponse = await fetch(\"/api/orders/create\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          items: validatedItems,\n          formData: sanitizedData,\n          total: finalTotal,\n          shippingCost: shipping,\n          shippingMethod,\n        }),\n      });\n\n      console.log(\"Order response status:\", orderResponse.status);\n      if (!orderResponse.ok) {\n        const errorData = await orderResponse.json().catch(() => ({}));\n        console.error(\"Order creation failed:\", errorData);\n        throw new Error(errorData.error || `HTTP error! status: ${orderResponse.status}`);\n      }\n\n      const orderResult = await orderResponse.json();\n      console.log(\"Order created successfully:\", orderResult);\n\n      // بررسی ساختار response: {success: true, data: {order: ...}}\n      const order = orderResult.data?.order || orderResult.order;\n      \n      if (!orderResult.success || !order) {\n        const errorMessage = orderResult.error || \"خطا در ثبت سفارش\";\n        const isDbError = errorMessage.includes('database') || errorMessage.includes('connection') || errorMessage.includes('دیتابیس');\n        \n        toast({\n          title: \"خطا\",\n          description: isDbError \n            ? \"خطا در اتصال به دیتابیس. لطفاً بعداً تلاش کنید.\"\n            : errorMessage,\n          variant: \"destructive\",\n        });\n        setIsSubmitting(false);\n        return;\n      }\n\n      // ============================================\n      // پرداخت Mock برای توسعه و تست\n      // در این حالت، پرداخت همیشه موفق می‌شود\n      // ============================================\n      console.log(\"[Mock Payment] Updating payment status to paid for order:\", order.id);\n      \n      // به‌روزرسانی وضعیت پرداخت سفارش به \"paid\"\n      const updatePaymentResponse = await fetch(`/api/orders/${order.id}/payment-status`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          paymentStatus: \"paid\",\n        }),\n      });\n\n      if (!updatePaymentResponse.ok) {\n        const errorData = await updatePaymentResponse.json().catch(() => ({}));\n        console.error(\"[Mock Payment] Failed to update payment status:\", errorData);\n        throw new Error(errorData.error || \"خطا در به‌روزرسانی وضعیت پرداخت\");\n      }\n\n      const paymentUpdateResult = await updatePaymentResponse.json();\n      console.log(\"[Mock Payment] Payment status updated successfully:\", paymentUpdateResult);\n\n      // استفاده از سفارش به‌روزرسانی شده از API\n      const updatedOrder = paymentUpdateResult.success && paymentUpdateResult.data \n        ? paymentUpdateResult.data \n        : { ...order, paymentStatus: \"paid\" as const };\n\n      // ذخیره سفارش در store با وضعیت paid\n      console.log(\"[Mock Payment] Adding order to store:\", updatedOrder);\n      addOrder(updatedOrder);\n\n      // پاک کردن سبد خرید\n      console.log(\"[Mock Payment] Clearing cart...\");\n      clearCart();\n\n      // حذف اطلاعات checkout از localStorage\n      console.log(\"[Mock Payment] Clearing localStorage...\");\n      localStorage.removeItem(\"checkoutData\");\n      localStorage.removeItem(\"pendingOrder\");\n      // Clear dismissed order status bar so new order shows in status bar\n      localStorage.removeItem(\"dismissedOrderStatusBar\");\n\n      // نمایش پیام موفقیت\n      console.log(\"[Mock Payment] Showing success toast...\");\n      toast({\n        title: \"پرداخت موفق\",\n        description: \"سفارش شما با موفقیت ثبت و پرداخت شد\",\n      });\n\n      // هدایت به صفحه پیگیری سفارش\n      const orderNumber = updatedOrder.orderNumber || order.orderNumber;\n      console.log(\"[Mock Payment] Redirecting to track page with orderNumber:\", orderNumber);\n      \n      // استفاده از router.push برای هدایت بهتر (به جای window.location.href)\n      setTimeout(() => {\n        router.push(`/order/track?orderNumber=${orderNumber}`);\n      }, 1000); // افزایش تاخیر برای نمایش بهتر پیام موفقیت\n    } catch (error) {\n      console.error(\"[Checkout] Order creation error:\", {\n        message: error instanceof Error ? error.message : 'Unknown error',\n        name: error instanceof Error ? error.name : 'Unknown',\n        ...(process.env.NODE_ENV === 'development' && {\n          stack: error instanceof Error ? error.stack : undefined,\n        }),\n      });\n      \n      const errorMessage = error instanceof Error ? error.message : \"خطایی در پردازش درخواست رخ داد\";\n      const isDbError = errorMessage.includes('database') || errorMessage.includes('connection') || errorMessage.includes('دیتابیس');\n      const isNetworkError = errorMessage.includes('fetch') || errorMessage.includes('network') || errorMessage.includes('Failed to fetch');\n      \n      toast({\n        title: \"خطا\",\n        description: isDbError\n          ? \"خطا در اتصال به دیتابیس. لطفاً بعداً تلاش کنید.\"\n          : isNetworkError\n          ? \"خطا در ارتباط با سرور. لطفاً اتصال اینترنت خود را بررسی کنید.\"\n          : errorMessage,\n        variant: \"destructive\",\n      });\n      setIsSubmitting(false);\n    }\n  };\n\n  if (items.length === 0) {\n    return (\n      <div className=\"container mx-auto px-4 py-12 sm:py-20\">\n        <div className=\"flex flex-col items-center justify-center py-12 sm:py-20\">\n          <ShoppingBag className=\"h-16 w-16 sm:h-24 sm:w-24 text-muted-foreground mb-4\" />\n          <h2 className=\"text-xl sm:text-2xl font-bold mb-2 text-center\">\n            سبد خرید شما خالی است\n          </h2>\n          <p className=\"text-sm sm:text-base text-muted-foreground mb-6 text-center\">\n            محصولات مورد نظر خود را به سبد خرید اضافه کنید\n          </p>\n          <Link href=\"/products\">\n            <Button size=\"lg\" className=\"h-11 sm:h-12\">\n              مشاهده محصولات\n            </Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-6 sm:py-8 md:py-12\">\n      <h1 className=\"text-2xl sm:text-3xl font-bold mb-6 sm:mb-8\">\n        تکمیل اطلاعات و پرداخت\n      </h1>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8\">\n        {/* فرم اطلاعات */}\n        <div className=\"lg:col-span-2\">\n          <Card>\n            <CardHeader>\n              <CardTitle>اطلاعات تحویل</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <form \n                onSubmit={(e) => {\n                  e.preventDefault();\n                  console.log(\"[Form] Submit event triggered\");\n                  handleSubmit(\n                    (data) => {\n                      console.log(\"[Form] Validation passed, data:\", data);\n                      onSubmit(data);\n                    },\n                    (errors) => {\n                      console.error(\"[Form] Validation errors:\", errors);\n                      setSubmitAttempted(true);\n                      // نمایش پیام خطا برای کاربر\n                      const firstError = Object.values(errors)[0];\n                      if (firstError) {\n                        toast({\n                          title: \"خطا در اعتبارسنجی\",\n                          description: firstError.message || \"لطفاً تمام فیلدهای الزامی را پر کنید\",\n                          variant: \"destructive\",\n                        });\n                      }\n                    }\n                  )(e);\n                }} \n                className=\"space-y-4 sm:space-y-6\"\n              >\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"firstName\">\n                      نام <span className=\"text-destructive\">*</span>\n                    </Label>\n                    <Input\n                      id=\"firstName\"\n                      {...register(\"firstName\")}\n                      placeholder=\"نام\"\n                      className={errors.firstName ? \"border-destructive\" : \"\"}\n                    />\n                    {errors.firstName && (\n                      <p className=\"text-sm text-destructive flex items-center gap-1\">\n                        <AlertCircle className=\"h-3 w-3\" />\n                        {errors.firstName.message}\n                      </p>\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"lastName\">\n                      نام خانوادگی <span className=\"text-destructive\">*</span>\n                    </Label>\n                    <Input\n                      id=\"lastName\"\n                      {...register(\"lastName\")}\n                      placeholder=\"نام خانوادگی\"\n                      className={errors.lastName ? \"border-destructive\" : \"\"}\n                    />\n                    {errors.lastName && (\n                      <p className=\"text-sm text-destructive flex items-center gap-1\">\n                        <AlertCircle className=\"h-3 w-3\" />\n                        {errors.lastName.message}\n                      </p>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"phone\">\n                      شماره تماس <span className=\"text-destructive\">*</span>\n                    </Label>\n                    <Input\n                      id=\"phone\"\n                      {...register(\"phone\")}\n                      type=\"tel\"\n                      onChange={handlePhoneChange}\n                      placeholder=\"09123456789\"\n                      maxLength={11}\n                      className={errors.phone ? \"border-destructive\" : \"\"}\n                    />\n                    {errors.phone && (\n                      <p className=\"text-sm text-destructive flex items-center gap-1\">\n                        <AlertCircle className=\"h-3 w-3\" />\n                        {errors.phone.message}\n                      </p>\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"email\">\n                      ایمیل <span className=\"text-destructive\">*</span>\n                    </Label>\n                    <Input\n                      id=\"email\"\n                      {...register(\"email\")}\n                      type=\"email\"\n                      placeholder=\"example@email.com\"\n                      className={errors.email ? \"border-destructive\" : \"\"}\n                    />\n                    {errors.email && (\n                      <p className=\"text-sm text-destructive flex items-center gap-1\">\n                        <AlertCircle className=\"h-3 w-3\" />\n                        {errors.email.message}\n                      </p>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"address\">\n                    آدرس کامل <span className=\"text-destructive\">*</span>\n                  </Label>\n                  <Textarea\n                    id=\"address\"\n                    {...register(\"address\")}\n                    placeholder=\"آدرس کامل تحویل\"\n                    rows={3}\n                    className={errors.address ? \"border-destructive\" : \"\"}\n                  />\n                  {errors.address && (\n                    <p className=\"text-sm text-destructive flex items-center gap-1\">\n                      <AlertCircle className=\"h-3 w-3\" />\n                      {errors.address.message}\n                    </p>\n                  )}\n                </div>\n\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"city\">\n                      شهر <span className=\"text-destructive\">*</span>\n                    </Label>\n                    <Input\n                      id=\"city\"\n                      {...register(\"city\")}\n                      placeholder=\"شهر\"\n                      className={errors.city ? \"border-destructive\" : \"\"}\n                    />\n                    {errors.city && (\n                      <p className=\"text-sm text-destructive flex items-center gap-1\">\n                        <AlertCircle className=\"h-3 w-3\" />\n                        {errors.city.message}\n                      </p>\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"postalCode\">کد پستی</Label>\n                    <Input\n                      id=\"postalCode\"\n                      {...register(\"postalCode\")}\n                      onChange={handlePostalCodeChange}\n                      placeholder=\"1234567890\"\n                      maxLength={10}\n                      className={errors.postalCode ? \"border-destructive\" : \"\"}\n                    />\n                    {errors.postalCode && (\n                      <p className=\"text-sm text-destructive flex items-center gap-1\">\n                        <AlertCircle className=\"h-3 w-3\" />\n                        {errors.postalCode.message}\n                      </p>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"province\">استان (اختیاری)</Label>\n                  <Input\n                    id=\"province\"\n                    {...register(\"province\")}\n                    placeholder=\"استان\"\n                    className={errors.province ? \"border-destructive\" : \"\"}\n                  />\n                  {errors.province && (\n                    <p className=\"text-sm text-destructive flex items-center gap-1\">\n                      <AlertCircle className=\"h-3 w-3\" />\n                      {errors.province.message}\n                    </p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"notes\">یادداشت (اختیاری)</Label>\n                  <Textarea\n                    id=\"notes\"\n                    {...register(\"notes\")}\n                    placeholder=\"یادداشت یا توضیحات اضافی\"\n                    rows={3}\n                    className={errors.notes ? \"border-destructive\" : \"\"}\n                  />\n                  {errors.notes && (\n                    <p className=\"text-sm text-destructive flex items-center gap-1\">\n                      <AlertCircle className=\"h-3 w-3\" />\n                      {errors.notes.message}\n                    </p>\n                  )}\n                </div>\n\n                {/* نمایش خطاهای کلی فرم */}\n                {submitAttempted && Object.keys(errors).length > 0 && (\n                  <div className=\"p-4 bg-destructive/10 border border-destructive/20 rounded-lg\">\n                    <p className=\"text-sm text-destructive font-medium mb-2\">\n                      لطفاً خطاهای زیر را برطرف کنید:\n                    </p>\n                    <ul className=\"list-disc list-inside space-y-1 text-sm text-destructive\">\n                      {Object.entries(errors).map(([field, error]) => (\n                        <li key={field}>\n                          {error?.message || `${field} نامعتبر است`}\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                )}\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full h-11 sm:h-12 text-sm sm:text-base\"\n                  size=\"lg\"\n                  disabled={isSubmitting}\n                >\n                  {isSubmitting ? (\n                    <>\n                      <Loader2 className=\"ml-2 h-4 w-4 animate-spin\" />\n                      در حال اتصال به درگاه...\n                    </>\n                  ) : (\n                    <>\n                      ادامه به درگاه پرداخت\n                      <ArrowRight className=\"mr-2 h-4 w-4\" />\n                    </>\n                  )}\n                </Button>\n              </form>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* خلاصه سفارش */}\n        <div className=\"lg:col-span-1\">\n          <Card className=\"sticky top-20 sm:top-24\">\n            <CardHeader>\n              <CardTitle>خلاصه سفارش</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-3 max-h-[300px] overflow-y-auto\">\n                {items.map((item) => (\n                  <div key={item.id} className=\"flex gap-3 pb-3 border-b border-border/30 last:border-0\">\n                    <div className=\"relative w-16 h-16 bg-muted rounded-lg overflow-hidden flex-shrink-0\">\n                      {item.image && item.image.trim() !== \"\" ? (\n                      <Image\n                        src={item.image}\n                        alt={item.name}\n                        fill\n                        className=\"object-cover\"\n                      />\n                      ) : (\n                        <div className=\"w-full h-full flex items-center justify-center text-muted-foreground\">\n                          <Package className=\"h-6 w-6\" />\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-medium text-sm line-clamp-2 mb-1\">\n                        {item.name}\n                      </h3>\n                      <div className=\"flex justify-between text-sm text-muted-foreground\">\n                        <span>تعداد: {item.quantity}</span>\n                        <span className=\"font-semibold text-foreground\">\n                          {(item.price * item.quantity).toLocaleString(\"fa-IR\")}{\" \"}\n                          تومان\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              <div className=\"space-y-2 pt-2 border-t border-border/30\">\n                <div className=\"flex justify-between text-sm sm:text-base\">\n                  <span>جمع کل:</span>\n                  <span className=\"font-semibold\">\n                    {total.toLocaleString(\"fa-IR\")} تومان\n                  </span>\n                </div>\n                <div className=\"flex justify-between text-sm sm:text-base\">\n                  <span>هزینه ارسال:</span>\n                  <span className=\"font-semibold\">\n                    {shipping === 0 ? (\n                      <span className=\"text-green-600\">رایگان</span>\n                    ) : (\n                      `${shipping.toLocaleString(\"fa-IR\")} تومان`\n                    )}\n                  </span>\n                </div>\n                {shippingMethod && (\n                  <div className=\"flex justify-between text-xs text-muted-foreground\">\n                    <span>روش ارسال:</span>\n                    <span>{shippingMethod === \"air\" ? \"هوایی\" : \"دریایی\"}</span>\n                  </div>\n                )}\n                <div className=\"flex justify-between text-base sm:text-lg font-bold pt-2 border-t border-border/30\">\n                  <span>مبلغ نهایی:</span>\n                  <span className=\"text-primary\">\n                    {finalTotal.toLocaleString(\"fa-IR\")} تومان\n                  </span>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n    </div>\n  );\n}\n\n\n","import * as z from \"zod\";\n\n/**\n * Schema اعتبارسنجی فرم Checkout\n */\nexport const checkoutFormSchema = z.object({\n  firstName: z.string().min(1, \"نام الزامی است\"),\n  lastName: z.string().min(1, \"نام خانوادگی الزامی است\"),\n  phone: z\n    .string()\n    .min(10, \"شماره تلفن باید حداقل 10 رقم باشد\")\n    .regex(/^[0-9]+$/, \"شماره تلفن باید فقط عدد باشد\"),\n  email: z\n    .union([z.string().email(\"ایمیل نامعتبر است\"), z.literal(\"\")])\n    .optional(),\n  address: z.string().min(5, \"آدرس باید حداقل 5 کاراکتر باشد\"),\n  city: z.string().min(1, \"شهر الزامی است\"),\n  postalCode: z\n    .string()\n    .optional()\n    .refine((val) => !val || val === \"\" || /^[0-9]{10}$/.test(val), {\n      message: \"کد پستی باید 10 رقم باشد\",\n    }),\n  province: z.string().optional(),\n  notes: z\n    .string()\n    .max(500, \"یادداشت نمی‌تواند بیشتر از 500 کاراکتر باشد\")\n    .optional(),\n});\n\nexport type CheckoutFormData = z.infer<typeof checkoutFormSchema>;\n\n/**\n * Sanitize و پاکسازی داده‌های فرم\n */\nexport function sanitizeCheckoutInput(data: CheckoutFormData): CheckoutFormData {\n  return {\n    firstName: data.firstName.trim(),\n    lastName: data.lastName.trim(),\n    phone: data.phone.replace(/\\D/g, \"\"),\n    email: data.email?.trim().toLowerCase() || \"\",\n    address: data.address.trim(),\n    city: data.city.trim(),\n    postalCode: data.postalCode?.replace(/\\D/g, \"\") || \"\",\n    province: data.province?.trim() || \"\",\n    notes: data.notes?.trim() || \"\",\n  };\n}\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,KACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OCjBA,EAAA,EAAA,CAAA,CAAA,MAKO,IAAM,EAAqB,EAAA,MAAQ,CAAC,CACzC,UAAW,EAAA,MAAQ,GAAG,GAAG,CAAC,EAAG,kBAC7B,SAAU,EAAA,MAAQ,GAAG,GAAG,CAAC,EAAG,2BAC5B,MAAO,EAAA,MACE,GACN,GAAG,CAAC,GAAI,qCACR,KAAK,CAAC,WAAY,gCACrB,MAAO,EAAA,KACC,CAAC,CAAC,EAAA,MAAQ,GAAG,KAAK,CAAC,qBAAsB,EAAA,OAAS,CAAC,IAAI,EAC5D,QAAQ,GACX,QAAS,EAAA,MAAQ,GAAG,GAAG,CAAC,EAAG,kCAC3B,KAAM,EAAA,MAAQ,GAAG,GAAG,CAAC,EAAG,kBACxB,WAAY,EAAA,MACH,GACN,QAAQ,GACR,MAAM,CAAC,AAAC,GAAQ,CAAC,GAAe,KAAR,GAAc,cAAc,IAAI,CAAC,GAAM,CAC9D,QAAS,0BACX,GACF,SAAU,EAAA,MAAQ,GAAG,QAAQ,GAC7B,MAAO,EAAA,MACE,GACN,GAAG,CAAC,IAAK,+CACT,QAAQ,EACb,GDRe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAS,AAAT,IACT,OAAE,CAAK,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,IACpB,OAAE,CAAK,UAAE,CAAQ,gBAAE,CAAc,WAAE,CAAS,CAAE,CAAG,CAAA,EAAA,EAAA,YAAA,AAAY,IAC7D,UAAE,CAAQ,CAAE,CAAG,CAAA,EAAA,EAAA,aAAA,AAAa,IAC5B,YAAE,CAAU,CAAE,CAAG,CAAA,EAAA,EAAA,eAAe,AAAf,IACjB,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GAC3C,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEjD,UACJ,CAAQ,CACR,cAAY,CACZ,UAAW,QAAE,CAAM,CAAE,OACrB,CAAK,UACL,CAAQ,CACR,OAAK,CACN,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,EAAmB,CAC5B,SAAU,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,GACtB,KAAM,WACN,cAAe,CACb,UAAW,GACX,SAAU,GACV,MAAO,GACP,MAAO,GACP,QAAS,GACT,KAAM,GACN,WAAY,GACZ,SAAU,GACV,MAAO,EACT,CACF,GAGA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAe,aAAa,OAAO,CAAC,gBAC1C,GAAI,EACF,GAAI,CACF,IAAM,EAAO,EAFC,GAEI,KAAK,CAAC,GACpB,EAAK,QAAQ,EAAE,AACjB,EAAM,CACJ,UAAW,EAAK,QAAQ,CAAC,SAAS,EAAI,GACtC,SAAU,EAAK,QAAQ,CAAC,QAAQ,EAAI,GACpC,MAAO,EAAK,QAAQ,CAAC,KAAK,EAAI,GAC9B,MAAO,EAAK,QAAQ,CAAC,KAAK,EAAI,GAC9B,QAAS,EAAK,QAAQ,CAAC,OAAO,EAAI,GAClC,KAAM,EAAK,QAAQ,CAAC,IAAI,EAAI,GAC5B,WAAY,EAAK,QAAQ,CAAC,UAAU,EAAI,GACxC,SAAU,EAAK,QAAQ,CAAC,QAAQ,EAAI,GACpC,MAAO,EAAK,QAAQ,CAAC,KAAK,EAAI,EAChC,EAEJ,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,+BAAgC,EAChD,CAEJ,EAAG,CAAC,EAAM,EAEV,IAAM,EAAQ,IA8BR,EAAW,CA3Ba,KAC5B,GAAI,CAAC,GAAmC,IAAjB,EAAM,MAAM,CAAQ,OAAO,EAGlD,IAAI,EAAkB,EAEtB,IAAK,IAAM,KAAQ,EAAO,CACxB,IAAM,EAAU,EAAW,EAAK,EAAE,EAClC,GAAI,EAAS,CACX,IAAM,EAAyC,QAAnB,EACvB,EAAQ,eAAe,EAAI,KAC3B,EAAQ,eAAe,EAAI,IAEJ,QAAxB,GAAgC,EAAsB,GACxD,GAAkB,CAAA,CAEtB,CACF,QAJ+E,AAO/E,AAAwB,GAAG,CAAvB,EACK,EAAQ,IAAS,EAAI,IAGvB,EACT,IAGM,EAAa,EAAQ,EAkBrB,EAAW,MAAO,IACtB,GAAI,KAsCE,EArCJ,QAAQ,GAAG,CAAC,6BAA8B,GAC1C,GAAmB,GACnB,EAAgB,IAGhB,IAAM,ECjGH,CACL,UAAW,EAAK,CDgGQ,QChGC,CAAC,IAAI,GAC9B,SAAU,AD+FoC,EC/F/B,QAAQ,CAAC,IAAI,GAC5B,MAAO,EAAK,KAAK,CAAC,OAAO,CAAC,MAAO,IACjC,MAAO,EAAK,KAAK,EAAE,OAAO,eAAiB,GAC3C,QAAS,EAAK,OAAO,CAAC,IAAI,GAC1B,KAAM,EAAK,IAAI,CAAC,IAAI,GACpB,WAAY,EAAK,UAAU,EAAE,QAAQ,MAAO,KAAO,GACnD,SAAU,EAAK,QAAQ,EAAE,QAAU,GACnC,MAAO,EAAK,KAAK,EAAE,QAAU,EAC/B,ED6FI,GALA,QAAQ,GAAG,CAAC,kBAAmB,GAC/B,QAAQ,GAAG,CAAC,eAAgB,EAAM,MAAM,EACxC,QAAQ,GAAG,CAAC,SAAU,GAGD,IAAjB,EAAM,MAAM,CAAQ,CACtB,QAAQ,KAAK,CAAC,kBACd,EAAM,CACJ,MAAO,MACP,YAAa,wBACb,QAAS,aACX,GACA,GAAgB,GAChB,MACF,CAIA,GADA,QAAQ,GAAG,CAAC,eAAgB,GACxB,GAAc,GAAK,CAAC,SAAS,GAAa,CAC5C,QAAQ,KAAK,CAAC,uBAAwB,GACtC,EAAM,CACJ,MAAO,MACP,YAAa,yBACb,QAAS,aACX,GACA,GAAgB,GAChB,MACF,CAGA,QAAQ,GAAG,CAAC,uBAEZ,GAAI,CACF,EAAiB,EAAM,GAAG,CAAC,AAAC,IAG1B,GAFA,QAAQ,GAAG,CAAC,mBAAoB,GAE5B,CAAC,GAAwB,UAAhB,AAA0B,OAAnB,EAElB,MADA,QAAQ,KAAK,CAAC,uBAAwB,GAChC,AAAI,MAAM,0BAGlB,GAAI,CAAC,EAAK,EAAE,EAA+B,IAAI,CAA/B,OAAO,EAAK,EAAE,EAAE,IAAI,GAElC,MADA,QAAQ,KAAK,CAAC,mBAAoB,GAC5B,AAAI,MAAM,6BAGlB,GAAI,CAAC,EAAK,IAAI,EAAI,AAA6B,IAAI,QAA1B,EAAK,IAAI,EAAE,IAAI,GAEtC,MADA,QAAQ,KAAK,CAAC,qBAAsB,GAC9B,AAAI,MAAM,CAAC,sBAAsB,EAAE,EAAK,EAAE,CAAC,eAAe,CAAC,EAGnE,QAAmB,IAAf,EAAK,KAAK,EAAiC,OAAf,EAAK,KAAK,EAAa,MAAM,OAAO,EAAK,KAAK,GAE5E,CAFgF,KAChF,QAAQ,KAAK,CAAC,iCAAkC,GAC1C,AAAI,MAAM,CAAC,YAAY,EAAE,EAAK,IAAI,EAAI,EAAK,EAAE,CAAC,eAAe,CAAC,EAGtE,QAAsB,IAAlB,EAAK,QAAQ,EAAoC,OAAlB,EAAK,QAAQ,EAAa,MAAM,OAAO,EAAK,QAAQ,GAErF,CAFyF,KACzF,QAAQ,KAAK,CAAC,oCAAqC,GAC7C,AAAI,MAAM,CAAC,aAAa,EAAE,EAAK,IAAI,EAAI,EAAK,EAAE,CAAC,eAAe,CAAC,EAIvE,IAAI,EAAW,EAAK,KAAK,CAAG,OAAO,EAAK,KAAK,EAAE,IAAI,GAAK,GACxD,GAAI,CAAC,EAAU,CACb,IAAM,EAAU,EAAW,EAAK,EAAE,EAC9B,GAAW,EAAQ,MAAM,EAAI,EAAQ,MAAM,CAAC,MAAM,CAAG,GAAG,CAC1D,EAAW,EAAQ,MAAM,CAAC,EAAA,AAAE,CAEhC,CAEA,IAAM,EAAgB,CACpB,GAAI,OAAO,EAAK,EAAE,EAAE,IAAI,GACxB,KAAM,OAAO,EAAK,IAAI,EAAE,IAAI,GAC5B,MAAO,OAAO,EAAK,KAAK,EACxB,SAAU,OAAO,EAAK,QAAQ,EAC9B,MAAO,GAAY,EACrB,EAEA,OADA,QAAQ,GAAG,CAAC,kBAAmB,GACxB,CACT,GACA,QAAQ,GAAG,CAAC,uBAAwB,EACtC,CAAE,MAAO,EAAiB,CACxB,QAAQ,KAAK,CAAC,oBAAqB,GACnC,EAAM,CACJ,MAAO,MACP,YAAa,aAA2B,MAAQ,EAAgB,OAAO,CAAG,4BAC1E,QAAS,aACX,GACA,GAAgB,GAChB,MACF,CAGA,QAAQ,GAAG,CAAC,qCACZ,IAAM,EAAgB,MAAM,MAAM,qBAAsB,CACtD,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,CACnB,MAAO,EACP,SAAU,EACV,MAAO,EACP,aAAc,iBACd,CACF,EACF,GAGA,GADA,QAAQ,GAAG,CAAC,yBAA0B,EAAc,MAAM,EACtD,CAAC,EAAc,EAAE,CAAE,CACrB,IAAM,EAAY,MAAM,EAAc,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,EAAC,CAAC,CAE5D,OADA,QAAQ,KAAK,CAAC,yBAA0B,GAClC,AAAI,MAAM,EAAU,KAAK,EAAI,CAAC,oBAAoB,EAAE,EAAc,MAAM,CAAA,CAAE,CAClF,CAEA,IAAM,EAAc,MAAM,EAAc,IAAI,GAC5C,QAAQ,GAAG,CAAC,8BAA+B,GAG3C,IAAM,EAAQ,EAAY,IAAI,EAAE,OAAS,EAAY,KAAK,CAE1D,GAAI,CAAC,EAAY,OAAO,EAAI,CAAC,EAAO,CAClC,IAAM,EAAe,EAAY,KAAK,EAAI,mBACpC,EAAY,EAAa,QAAQ,CAAC,aAAe,EAAa,QAAQ,CAAC,eAAiB,EAAa,QAAQ,CAAC,WAEpH,EAAM,CACJ,MAAO,MACP,YAAa,EACT,kDACA,EACJ,QAAS,aACX,GACA,GAAgB,GAChB,MACF,CAMA,QAAQ,GAAG,CAAC,4DAA6D,EAAM,EAAE,EAGjF,IAAM,EAAwB,MAAM,MAAM,CAAC,YAAY,EAAE,EAAM,EAAE,CAAC,eAAe,CAAC,CAAE,CAClF,OAAQ,QACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,CACnB,cAAe,MACjB,EACF,GAEA,GAAI,CAAC,EAAsB,EAAE,CAAE,CAC7B,IAAM,EAAY,MAAM,EAAsB,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,EAAC,CAAC,CAEpE,OADA,QAAQ,KAAK,CAAC,kDAAmD,GAC3D,AAAI,MAAM,EAAU,KAAK,EAAI,kCACrC,CAEA,IAAM,EAAsB,MAAM,EAAsB,IAAI,GAC5D,QAAQ,GAAG,CAAC,sDAAuD,GAGnE,IAAM,EAAe,EAAoB,OAAO,EAAI,EAAoB,IAAI,CACxE,EAAoB,IAAI,CACxB,CAAE,GAAG,CAAK,CAAE,cAAe,MAAgB,EAG/C,QAAQ,GAAG,CAAC,wCAAyC,GACrD,EAAS,GAGT,QAAQ,GAAG,CAAC,mCACZ,IAGA,QAAQ,GAAG,CAAC,2CACZ,aAAa,UAAU,CAAC,gBACxB,aAAa,UAAU,CAAC,gBAExB,aAAa,UAAU,CAAC,2BAGxB,QAAQ,GAAG,CAAC,2CACZ,EAAM,CACJ,MAAO,cACP,YAAa,qCACf,GAGA,IAAM,EAAc,EAAa,WAAW,EAAI,EAAM,WAAW,CACjE,QAAQ,GAAG,CAAC,6DAA8D,GAG1E,WAAW,KACT,EAAO,IAAI,CAAC,CAAC,yBAAyB,EAAE,EAAA,CAAa,CACvD,EAAG,IACL,CAAE,EADU,IACH,EAAO,CACd,QAAQ,KAAK,CAAC,sBAFuC,aAEH,CAChD,QAAS,aAAiB,MAAQ,EAAM,OAAO,CAAG,gBAClD,KAAM,aAAiB,MAAQ,EAAM,IAAI,CAAG,UAC5C,IAAI,CAAyB,AAG/B,GAEA,CALgD,GAK1C,EAAe,aAAiB,MAAQ,EAAM,OAAO,CAAG,YAL/B,qBAMzB,EAAY,EAAa,QAAQ,CAAC,aAAe,EAAa,QAAQ,CAAC,eAAiB,EAAa,QAAQ,CAAC,WAC9G,EAAiB,EAAa,QAAQ,CAAC,UAAY,EAAa,QAAQ,CAAC,YAAc,EAAa,QAAQ,CAAC,mBAEnH,EAAM,CACJ,MAAO,MACP,YAAa,EACT,kDACA,EACA,gEACA,EACJ,QAAS,aACX,GACA,GAAgB,EAClB,CACF,SAEqB,AAArB,GAAwB,CAApB,EAAM,MAAM,CAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qEACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,yDACvB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,0DAAiD,0BAG/D,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uEAA8D,mDAG3E,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAK,qBACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,KAAK,UAAU,wBAAe,0BAUnD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uDAA8C,2BAI5D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2DAEb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,oBAEb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,SAAU,AAAC,IACT,EAAE,cAAc,GAChB,QAAQ,GAAG,CAAC,iCACZ,EACG,AAAD,IACE,QAAQ,GAAG,CAAC,kCAAmC,GAC/C,EAAS,EACX,EACA,AAAC,IACC,QAAQ,KAAK,CAAC,4BAA6B,GAC3C,GAAmB,GAEnB,IAAM,EAAa,OAAO,MAAM,CAAC,EAAO,CAAC,EAAE,CACvC,GACF,EAAM,CACJ,MAFY,AAEL,oBACP,YAAa,EAAW,OAAO,EAAI,uCACnC,QAAS,aACX,EAEJ,GACA,EACJ,EACA,UAAU,mCAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,sBAAY,OACrB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,SAEzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,YACF,GAAG,EAAS,YAAY,CACzB,YAAY,MACZ,UAAW,EAAO,SAAS,CAAG,qBAAuB,KAEtD,EAAO,SAAS,EACf,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,SAAS,CAAC,OAAO,OAI/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,qBAAW,gBACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,SAElD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,WACF,GAAG,EAAS,WAAW,CACxB,YAAY,eACZ,UAAW,EAAO,QAAQ,CAAG,qBAAuB,KAErD,EAAO,QAAQ,EACd,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,QAAQ,CAAC,OAAO,UAMhC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,kBAAQ,cACV,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,SAEhD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,QACF,GAAG,EAAS,QAAQ,CACrB,KAAK,MACL,SAjWM,AAAC,CAiWG,GAhW5B,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,MAAO,IACxC,EAAM,MAAM,EAAI,IAAI,AACtB,EAAS,QAAS,EAEtB,EA6VoB,YAAY,cACZ,UAAW,GACX,UAAW,EAAO,KAAK,CAAG,qBAAuB,KAElD,EAAO,KAAK,EACX,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,KAAK,CAAC,OAAO,OAI3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,kBAAQ,SACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,SAE3C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,QACF,GAAG,EAAS,QAAQ,CACrB,KAAK,QACL,YAAY,oBACZ,UAAW,EAAO,KAAK,CAAG,qBAAuB,KAElD,EAAO,KAAK,EACX,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,KAAK,CAAC,OAAO,UAM7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBAAU,aACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,SAE/C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACP,GAAG,UACF,GAAG,EAAS,UAAU,CACvB,YAAY,kBACZ,KAAM,EACN,UAAW,EAAO,OAAO,CAAG,qBAAuB,KAEpD,EAAO,OAAO,EACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,OAAO,CAAC,OAAO,OAK7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAO,OAChB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4BAAmB,SAEzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,OACF,GAAG,EAAS,OAAO,CACpB,YAAY,MACZ,UAAW,EAAO,IAAI,CAAG,qBAAuB,KAEjD,EAAO,IAAI,EACV,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,IAAI,CAAC,OAAO,OAI1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,sBAAa,YAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,aACF,GAAG,EAAS,aAAa,CAC1B,SAnaW,AAAC,CAmaF,GAla5B,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,MAAO,IACxC,EAAM,MAAM,EAAI,IAClB,AADsB,EACb,aAAc,EAE3B,EA+ZoB,YAAY,aACZ,UAAW,GACX,UAAW,EAAO,UAAU,CAAG,qBAAuB,KAEvD,EAAO,UAAU,EAChB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,UAAU,CAAC,OAAO,UAMlC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBAAW,oBAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,WACF,GAAG,EAAS,WAAW,CACxB,YAAY,QACZ,UAAW,EAAO,QAAQ,CAAG,qBAAuB,KAErD,EAAO,QAAQ,EACd,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,QAAQ,CAAC,OAAO,OAK9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAQ,sBACvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACP,GAAG,QACF,GAAG,EAAS,QAAQ,CACrB,YAAY,2BACZ,KAAM,EACN,UAAW,EAAO,KAAK,CAAG,qBAAuB,KAElD,EAAO,KAAK,EACX,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,6DACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YACtB,EAAO,KAAK,CAAC,OAAO,OAM1B,GAAmB,OAAO,IAAI,CAAC,GAAQ,MAAM,CAAG,GAC/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0EACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,qDAA4C,oCAGzD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEACX,OAAO,OAAO,CAAC,GAAQ,GAAG,CAAC,CAAC,CAAC,EAAO,EAAM,GACzC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACE,GAAO,SAAW,CAAA,EAAG,EAAM,YAAY,CAAC,EADlC,SAQjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,SACL,UAAU,2CACV,KAAK,KACL,SAAU,WAET,EACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,8BAA8B,8BAInD,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WAAE,wBAEA,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,gCAUpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,oCACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,kBAEb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,sBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDACZ,EAAM,GAAG,CAAC,AAAC,GACV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAkB,UAAU,oEAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gFACZ,EAAK,KAAK,EAAI,AAAsB,OAAjB,KAAK,CAAC,IAAI,GAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAK,CAAA,CACJ,IAAK,EAAK,KAAK,CACf,IAAK,EAAK,IAAI,CACd,IAAI,CAAA,CAAA,EACJ,UAAU,iBAGV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gFACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,gBAIzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,iDACX,EAAK,IAAI,GAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+DACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,UAAQ,EAAK,QAAQ,IAC3B,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,0CACb,CAAC,EAAK,KAAK,CAAG,EAAK,QAAA,AAAQ,EAAE,cAAc,CAAC,SAAU,IAAI,mBAtBzD,EAAK,EAAE,KA+BrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sDACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,YACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,0BACb,EAAM,cAAc,CAAC,SAAS,eAGnC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sDACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,iBACN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBACA,IAAb,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,0BAAiB,WAEjC,CAAA,EAAG,EAAS,cAAc,CAAC,SAAS,MAAM,CAAC,MAIhD,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+DACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,eACN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAyB,QAAnB,EAA2B,QAAU,cAGhD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+FACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,gBACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,yBACb,EAAW,cAAc,CAAC,SAAS,+BAWxD"}