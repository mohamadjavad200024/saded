module.exports=[89078,a=>{"use strict";var b=a.i(33915),c=a.i(60421),d=a.i(49814),e=a.i(410);a.i(25173);var f=a.i(54917);let g={siteName:"ساد",siteDescription:"فروشگاه آنلاین قطعات خودرو وارداتی",maintenanceMode:!1,allowRegistration:!0,emailNotifications:!0,lowStockThreshold:10,itemsPerPage:10,showNotifications:!0,theme:"system"},h={totalProducts:0,activeProducts:0,totalStock:0,lowStockProducts:0,totalCategories:0,activeCategories:0,totalOrders:0,pendingOrders:0,totalRevenue:0,averagePrice:0},i=(0,b.create)((a,b)=>({stats:null,isLoading:!1,settings:g,refreshStats:async()=>{a({isLoading:!0});try{let f=c.useProductStore.getState(),g=d.useCategoryStore.getState(),h=e.useOrderStore.getState(),i=f.products,j=g.categories,k=h.orders,l=i.filter(a=>a.enabled),m=l.reduce((a,b)=>a+(b.price||0),0),n=l.length>0?m/l.length:0,o=k.length,p=k.filter(a=>"pending"===a.status||"pending"===a.paymentStatus).length,q=k.filter(a=>"paid"===a.paymentStatus).reduce((a,b)=>a+(b.total+b.shippingCost),0),r={totalProducts:i.length,activeProducts:l.length,totalStock:i.reduce((a,b)=>a+b.stockCount,0),lowStockProducts:i.filter(a=>a.stockCount<b().settings.lowStockThreshold).length,totalCategories:j.length,activeCategories:j.filter(a=>a.isActive&&a.enabled).length,totalOrders:o,pendingOrders:p,totalRevenue:q,averagePrice:Math.round(n)};a({stats:r,isLoading:!1})}catch(b){f.logger.error("Error refreshing stats:",b),a({stats:h,isLoading:!1})}},updateSettings:(c,d=!0)=>{a({settings:{...b().settings,...c}}),d||fetch("http://127.0.0.1:7242/ingest/6e2493c0-cc8b-4c0b-9456-c04638b7e615",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"admin-store.ts:206",message:"Client: updateSettings called with saveToAPI=false (loading from API)",data:{saveToAPI:d},timestamp:Date.now(),sessionId:"debug-session",runId:"run1",hypothesisId:"O"})}).catch(()=>{})},resetSettings:()=>{a({settings:g})}}));a.s(["useAdminStore",0,i])},15618,a=>{"use strict";let b=(0,a.i(70106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},88237,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97895);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{className:"relative w-full overflow-auto",children:(0,b.jsx)("table",{ref:e,className:(0,d.cn)("w-full caption-bottom text-sm",a),...c})}));e.displayName="Table";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("thead",{ref:e,className:(0,d.cn)("[&_tr]:border-b border-border/30",a),...c}));f.displayName="TableHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tbody",{ref:e,className:(0,d.cn)("[&_tr:last-child]:border-0",a),...c}));g.displayName="TableBody",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tfoot",{ref:e,className:(0,d.cn)("border-t border-border/30 bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c})).displayName="TableFooter";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tr",{ref:e,className:(0,d.cn)("border-b border-border/30 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...c}));h.displayName="TableRow";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("th",{ref:e,className:(0,d.cn)("h-12 px-4 text-right align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));i.displayName="TableHead";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("td",{ref:e,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));j.displayName="TableCell",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("caption",{ref:e,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",a),...c})).displayName="TableCaption",a.s(["Table",()=>e,"TableBody",()=>g,"TableCell",()=>j,"TableHead",()=>i,"TableHeader",()=>f,"TableRow",()=>h])},69520,a=>{"use strict";let b=(0,a.i(70106).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],69520)},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},43592,a=>{"use strict";var b=a.i(33915),c=a.i(54917);let d={},e=(0,b.create)((a,b)=>({users:[],filters:d,isLoading:!1,setUsers:b=>a({users:b}),addUser:b=>a(a=>{let c=a.users.findIndex(a=>a.id===b.id);if(c>=0){let d=[...a.users];return d[c]=b,{users:d}}return{users:[...a.users,b]}}),updateUser:(b,c)=>a(a=>{let d=a.users.findIndex(a=>a.id===b);if(d>=0){let b=[...a.users];return b[d]={...b[d],...c,updatedAt:new Date},{users:b}}return a}),updateUserStatus:(b,c)=>a(a=>({users:a.users.map(a=>a.id===b?{...a,status:c,updatedAt:new Date}:a)})),updateUserRole:(b,c)=>a(a=>({users:a.users.map(a=>a.id===b?{...a,role:c,updatedAt:new Date}:a)})),deleteUser:b=>a(a=>({users:a.users.filter(a=>a.id!==b)})),getUser:a=>b().users.find(b=>b.id===a),setFilters:b=>a(a=>({filters:{...a.filters,...b}})),clearFilters:()=>a({filters:d}),loadUsersFromDB:async()=>{a({isLoading:!0});try{let a=await fetch("/api/users?limit=1000",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!a.ok){let b=await a.json().catch(()=>({})),c=b.error||b.message||"خطا در بارگذاری کاربران";throw Error(c)}let d=await a.json();if(d.success&&d.data){let a=d.data.map(a=>({id:a.id,name:a.name,email:a.email,phone:a.phone||void 0,role:a.role||"user",status:a.status||(1===a.enabled||!0===a.enabled?"active":"inactive"),avatar:a.avatar||void 0,ordersCount:a.ordersCount||void 0,totalSpent:a.totalSpent||void 0,createdAt:a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt),updatedAt:a.updatedAt instanceof Date?a.updatedAt:new Date(a.updatedAt)}));b().setUsers(a),c.logger.info(`✅ Loaded ${a.length} users from database`)}else b().setUsers([]),c.logger.info("No users found in database")}catch(a){c.logger.error("Error loading users from DB:",a),b().setUsers([])}finally{a({isLoading:!1})}}}));a.s(["useUserStore",0,e])},33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},32245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(41997);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},7773,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},97458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(35112),f=a.r(56704),g=a.r(7773);function h({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}return 0===c.length?null:(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},69853,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(87924),e=a.r(72131),f=a.r(32245),g=a.r(97458);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},19721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(33354)._(a.r(69853));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},88367,a=>{"use strict";var b=a.i(87924),c=a.i(19721),d=a.i(3130),e=a.i(40695),f=a.i(60421),g=a.i(410),h=a.i(43592),i=a.i(69520),j=a.i(15618),k=a.i(83497),l=a.i(38784),m=a.i(210),n=a.i(77156),o=a.i(92e3),p=a.i(16201),q=a.i(38246),r=a.i(89078),s=a.i(72131),t=a.i(88237),u=a.i(54161),v=a.i(72228),w=a.i(80666);let x=(0,c.default)(async()=>{},{loadableGenerated:{modules:[72952]},loading:()=>(0,b.jsx)("div",{className:"animate-pulse h-48 bg-muted rounded-lg"}),ssr:!1});function y(){let{refreshStats:a}=(0,r.useAdminStore)(),c=(0,f.useProductStore)(a=>a.products),y=(0,g.useOrderStore)(a=>a.orders);(0,f.useProductStore)(a=>a.getEnabledProducts());let{loadProductsFromDB:z}=(0,f.useProductStore)(),{loadOrdersFromDB:A}=(0,g.useOrderStore)(),{loadUsersFromDB:B}=(0,h.useUserStore)();(0,s.useEffect)(()=>{(async()=>{try{await Promise.all([z(!0),A(),B()]),a()}catch(a){console.error("Error loading dashboard data:",a)}})()},[]),(0,s.useEffect)(()=>{(c.length>0||y.length>0)&&a()},[c,y,a]);let C=(0,s.useMemo)(()=>c.map(a=>({...a,createdAt:a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt)})).sort((a,b)=>{let c=a.createdAt instanceof Date?a.createdAt.getTime():new Date(a.createdAt).getTime();return(b.createdAt instanceof Date?b.createdAt.getTime():new Date(b.createdAt).getTime())-c}).slice(0,5),[c]),D=(0,s.useMemo)(()=>c.filter(a=>a.stockCount<10).slice(0,5),[c]),E=(0,s.useMemo)(()=>y.map(a=>({...a,createdAt:a.createdAt instanceof Date?a.createdAt:new Date(a.createdAt)})).sort((a,b)=>{let c=a.createdAt instanceof Date?a.createdAt.getTime():new Date(a.createdAt).getTime();return(b.createdAt instanceof Date?b.createdAt.getTime():new Date(b.createdAt).getTime())-c}).slice(0,5),[y]);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary/60 bg-clip-text text-transparent",children:"داشبورد"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"خوش آمدید به پنل مدیریت فروشگاه"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:a,children:[(0,b.jsx)(i.RefreshCw,{className:"ml-2 h-4 w-4"}),"بروزرسانی"]}),(0,b.jsx)(e.Button,{size:"sm",asChild:!0,children:(0,b.jsxs)(q.default,{href:"/admin/products/new",children:[(0,b.jsx)(j.Plus,{className:"ml-2 h-4 w-4"}),"محصول جدید"]})})]})]}),(0,b.jsx)(x,{}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsxs)(d.Card,{className:"lg:col-span-2",children:[(0,b.jsx)(d.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.ShoppingCart,{className:"h-5 w-5 text-primary"}),"آخرین سفارشات"]}),(0,b.jsx)(d.CardDescription,{children:"سفارشات اخیراً ثبت شده"})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(q.default,{href:"/admin/orders",children:[(0,b.jsx)(m.ArrowLeft,{className:"ml-2 h-4 w-4"}),"مشاهده همه"]})})]})}),(0,b.jsx)(d.CardContent,{className:"pt-6",children:E.length>0?(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)(t.Table,{children:[(0,b.jsx)(t.TableHeader,{children:(0,b.jsxs)(t.TableRow,{children:[(0,b.jsx)(t.TableHead,{children:"شماره سفارش"}),(0,b.jsx)(t.TableHead,{children:"مشتری"}),(0,b.jsx)(t.TableHead,{children:"مبلغ"}),(0,b.jsx)(t.TableHead,{children:"وضعیت"}),(0,b.jsx)(t.TableHead,{children:"تاریخ"})]})}),(0,b.jsx)(t.TableBody,{children:E.map(a=>(0,b.jsxs)(t.TableRow,{children:[(0,b.jsx)(t.TableCell,{className:"font-medium",children:a.orderNumber}),(0,b.jsx)(t.TableCell,{children:a.customerName}),(0,b.jsxs)(t.TableCell,{children:[new Intl.NumberFormat("fa-IR").format(a.total+a.shippingCost)," تومان"]}),(0,b.jsx)(t.TableCell,{children:(0,b.jsxs)(u.Badge,{variant:"delivered"===a.status?"success":"pending"===a.status?"warning":"default",children:["pending"===a.status&&"در انتظار","processing"===a.status&&"در حال پردازش","shipped"===a.status&&"ارسال شده","delivered"===a.status&&"تحویل شده","cancelled"===a.status&&"لغو شده"]})}),(0,b.jsx)(t.TableCell,{className:"text-sm text-muted-foreground",children:(0,v.format)(a.createdAt,"yyyy/MM/dd",{locale:w.faIR})})]},a.id))})]})}):(0,b.jsxs)("div",{className:"text-center py-12 border border-dashed border-border/30 rounded-lg",children:[(0,b.jsx)(l.ShoppingCart,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"هیچ سفارشی وجود ندارد"})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"bg-gradient-to-r from-red-500/5 to-transparent border-b",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(o.AlertCircle,{className:"h-5 w-5 text-red-600"}),"هشدار موجودی"]}),(0,b.jsx)(d.CardDescription,{children:"محصولات با موجودی کم"})]}),(0,b.jsx)(u.Badge,{variant:"warning",className:"h-6",children:c.filter(a=>a.stockCount<10).length})]})}),(0,b.jsx)(d.CardContent,{className:"pt-6",children:D.length>0?(0,b.jsxs)("div",{className:"space-y-3",children:[D.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border border-border/50 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["موجودی: ",a.stockCount]})]}),(0,b.jsx)(u.Badge,{variant:"warning",className:"ml-2",children:a.stockCount})]},a.id)),c.filter(a=>a.stockCount<10).length>5&&(0,b.jsx)(e.Button,{variant:"outline",className:"w-full mt-4",asChild:!0,children:(0,b.jsxs)(q.default,{href:"/admin/products",children:["مشاهده همه (",c.filter(a=>a.stockCount<10).length,")"]})})]}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(p.CheckCircle,{className:"h-12 w-12 mx-auto text-green-500 mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"همه محصولات موجودی کافی دارند"})]})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-transparent border-b",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Package,{className:"h-5 w-5 text-primary"}),"آخرین محصولات"]}),(0,b.jsx)(d.CardDescription,{children:"محصولات اخیراً اضافه شده"})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(q.default,{href:"/admin/products",children:[(0,b.jsx)(m.ArrowLeft,{className:"ml-2 h-4 w-4"}),"مشاهده همه"]})})]})}),(0,b.jsx)(d.CardContent,{className:"pt-6",children:C.length>0?(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)(t.Table,{children:[(0,b.jsx)(t.TableHeader,{children:(0,b.jsxs)(t.TableRow,{children:[(0,b.jsx)(t.TableHead,{children:"نام"}),(0,b.jsx)(t.TableHead,{children:"قیمت"}),(0,b.jsx)(t.TableHead,{children:"وضعیت"}),(0,b.jsx)(t.TableHead,{children:"موجودی"}),(0,b.jsx)(t.TableHead,{children:"عملیات"})]})}),(0,b.jsx)(t.TableBody,{children:C.map(a=>(0,b.jsxs)(t.TableRow,{children:[(0,b.jsx)(t.TableCell,{className:"font-medium",children:a.name}),(0,b.jsxs)(t.TableCell,{children:[new Intl.NumberFormat("fa-IR").format(a.price||0)," تومان"]}),(0,b.jsx)(t.TableCell,{children:(0,b.jsx)(u.Badge,{variant:a.enabled?"success":"secondary",children:a.enabled?"فعال":"غیرفعال"})}),(0,b.jsx)(t.TableCell,{children:(0,b.jsx)(u.Badge,{variant:a.stockCount<10?"warning":"default",children:a.stockCount})}),(0,b.jsx)(t.TableCell,{children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,b.jsxs)(q.default,{href:`/admin/products/${a.id}`,children:[(0,b.jsx)(n.Eye,{className:"h-4 w-4 ml-1"}),"مشاهده"]})})})]},a.id))})]})}):(0,b.jsxs)("div",{className:"text-center py-12 border border-dashed border-border/30 rounded-lg",children:[(0,b.jsx)(k.Package,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"محصولی وجود ندارد"})]})})]})]})}a.s(["default",()=>y])}];

//# sourceMappingURL=_bc4a7c3a._.js.map