{"version":3,"sources":["../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js","../../../../node_modules/use-sync-external-store/shim/index.js","../../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js","../../../../node_modules/use-sync-external-store/shim/with-selector.js","../../../../node_modules/zustand/esm/vanilla.mjs","../../../../node_modules/zustand/esm/index.mjs","../../../../node_modules/%40swc/helpers/cjs/_interop_require_wildcard.cjs","../../../../node_modules/next/src/shared/lib/segment.ts","../../../../node_modules/next/src/shared/lib/promise-with-resolvers.ts","../../../../node_modules/next/src/shared/lib/lazy-dynamic/bailout-to-csr.ts","../../../../lib/logger-client.ts","../../../../store/product-store.ts","../../../../lib/image-utils.ts","../../../../lib/product-utils.ts"],"sourcesContent":["/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useState = React.useState,\n  useEffect = React.useEffect,\n  useLayoutEffect = React.useLayoutEffect,\n  useDebugValue = React.useDebugValue;\nfunction useSyncExternalStore$2(subscribe, getSnapshot) {\n  var value = getSnapshot(),\n    _useState = useState({ inst: { value: value, getSnapshot: getSnapshot } }),\n    inst = _useState[0].inst,\n    forceUpdate = _useState[1];\n  useLayoutEffect(\n    function () {\n      inst.value = value;\n      inst.getSnapshot = getSnapshot;\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n    },\n    [subscribe, value, getSnapshot]\n  );\n  useEffect(\n    function () {\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      return subscribe(function () {\n        checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      });\n    },\n    [subscribe]\n  );\n  useDebugValue(value);\n  return value;\n}\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  inst = inst.value;\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(inst, nextValue);\n  } catch (error) {\n    return !0;\n  }\n}\nfunction useSyncExternalStore$1(subscribe, getSnapshot) {\n  return getSnapshot();\n}\nvar shim =\n  \"undefined\" === typeof window ||\n  \"undefined\" === typeof window.document ||\n  \"undefined\" === typeof window.document.createElement\n    ? useSyncExternalStore$1\n    : useSyncExternalStore$2;\nexports.useSyncExternalStore =\n  void 0 !== React.useSyncExternalStore ? React.useSyncExternalStore : shim;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\"),\n  shim = require(\"use-sync-external-store/shim\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useSyncExternalStore = shim.useSyncExternalStore,\n  useRef = React.useRef,\n  useEffect = React.useEffect,\n  useMemo = React.useMemo,\n  useDebugValue = React.useDebugValue;\nexports.useSyncExternalStoreWithSelector = function (\n  subscribe,\n  getSnapshot,\n  getServerSnapshot,\n  selector,\n  isEqual\n) {\n  var instRef = useRef(null);\n  if (null === instRef.current) {\n    var inst = { hasValue: !1, value: null };\n    instRef.current = inst;\n  } else inst = instRef.current;\n  instRef = useMemo(\n    function () {\n      function memoizedSelector(nextSnapshot) {\n        if (!hasMemo) {\n          hasMemo = !0;\n          memoizedSnapshot = nextSnapshot;\n          nextSnapshot = selector(nextSnapshot);\n          if (void 0 !== isEqual && inst.hasValue) {\n            var currentSelection = inst.value;\n            if (isEqual(currentSelection, nextSnapshot))\n              return (memoizedSelection = currentSelection);\n          }\n          return (memoizedSelection = nextSnapshot);\n        }\n        currentSelection = memoizedSelection;\n        if (objectIs(memoizedSnapshot, nextSnapshot)) return currentSelection;\n        var nextSelection = selector(nextSnapshot);\n        if (void 0 !== isEqual && isEqual(currentSelection, nextSelection))\n          return (memoizedSnapshot = nextSnapshot), currentSelection;\n        memoizedSnapshot = nextSnapshot;\n        return (memoizedSelection = nextSelection);\n      }\n      var hasMemo = !1,\n        memoizedSnapshot,\n        memoizedSelection,\n        maybeGetServerSnapshot =\n          void 0 === getServerSnapshot ? null : getServerSnapshot;\n      return [\n        function () {\n          return memoizedSelector(getSnapshot());\n        },\n        null === maybeGetServerSnapshot\n          ? void 0\n          : function () {\n              return memoizedSelector(maybeGetServerSnapshot());\n            }\n      ];\n    },\n    [getSnapshot, getServerSnapshot, selector, isEqual]\n  );\n  var value = useSyncExternalStore(subscribe, instRef[0], instRef[1]);\n  useEffect(\n    function () {\n      inst.hasValue = !0;\n      inst.value = value;\n    },\n    [value]\n  );\n  useDebugValue(value);\n  return value;\n};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","\"use strict\";\n\nfunction _getRequireWildcardCache(nodeInterop) {\n    if (typeof WeakMap !== \"function\") return null;\n\n    var cacheBabelInterop = new WeakMap();\n    var cacheNodeInterop = new WeakMap();\n\n    return (_getRequireWildcardCache = function(nodeInterop) {\n        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n    })(nodeInterop);\n}\nfunction _interop_require_wildcard(obj, nodeInterop) {\n    if (!nodeInterop && obj && obj.__esModule) return obj;\n    if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") return { default: obj };\n\n    var cache = _getRequireWildcardCache(nodeInterop);\n\n    if (cache && cache.has(obj)) return cache.get(obj);\n\n    var newObj = { __proto__: null };\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n    for (var key in obj) {\n        if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n            if (desc && (desc.get || desc.set)) Object.defineProperty(newObj, key, desc);\n            else newObj[key] = obj[key];\n        }\n    }\n\n    newObj.default = obj;\n\n    if (cache) cache.set(obj, newObj);\n\n    return newObj;\n}\nexports._ = _interop_require_wildcard;\n","import type { FlightRouterState, Segment } from './app-router-types'\n\nexport function getSegmentValue(segment: Segment) {\n  return Array.isArray(segment) ? segment[1] : segment\n}\n\nexport function isGroupSegment(segment: string) {\n  // Use array[0] for performant purpose\n  return segment[0] === '(' && segment.endsWith(')')\n}\n\nexport function isParallelRouteSegment(segment: string) {\n  return segment.startsWith('@') && segment !== '@children'\n}\n\nexport function addSearchParamsIfPageSegment(\n  segment: Segment,\n  searchParams: Record<string, string | string[] | undefined>\n) {\n  const isPageSegment = segment.includes(PAGE_SEGMENT_KEY)\n\n  if (isPageSegment) {\n    const stringifiedQuery = JSON.stringify(searchParams)\n    return stringifiedQuery !== '{}'\n      ? PAGE_SEGMENT_KEY + '?' + stringifiedQuery\n      : PAGE_SEGMENT_KEY\n  }\n\n  return segment\n}\n\nexport function computeSelectedLayoutSegment(\n  segments: string[] | null,\n  parallelRouteKey: string\n): string | null {\n  if (!segments || segments.length === 0) {\n    return null\n  }\n\n  // For 'children', use first segment; for other parallel routes, use last segment\n  const rawSegment =\n    parallelRouteKey === 'children'\n      ? segments[0]\n      : segments[segments.length - 1]\n\n  // If the default slot is showing, return null since it's not technically \"selected\" (it's a fallback)\n  // Returning an internal value like `__DEFAULT__` would be confusing\n  return rawSegment === DEFAULT_SEGMENT_KEY ? null : rawSegment\n}\n\n/** Get the canonical parameters from the current level to the leaf node. */\nexport function getSelectedLayoutSegmentPath(\n  tree: FlightRouterState,\n  parallelRouteKey: string,\n  first = true,\n  segmentPath: string[] = []\n): string[] {\n  let node: FlightRouterState\n  if (first) {\n    // Use the provided parallel route key on the first parallel route\n    node = tree[1][parallelRouteKey]\n  } else {\n    // After first parallel route prefer children, if there's no children pick the first parallel route.\n    const parallelRoutes = tree[1]\n    node = parallelRoutes.children ?? Object.values(parallelRoutes)[0]\n  }\n\n  if (!node) return segmentPath\n  const segment = node[0]\n\n  let segmentValue = getSegmentValue(segment)\n\n  if (!segmentValue || segmentValue.startsWith(PAGE_SEGMENT_KEY)) {\n    return segmentPath\n  }\n\n  segmentPath.push(segmentValue)\n\n  return getSelectedLayoutSegmentPath(\n    node,\n    parallelRouteKey,\n    false,\n    segmentPath\n  )\n}\n\nexport const PAGE_SEGMENT_KEY = '__PAGE__'\nexport const DEFAULT_SEGMENT_KEY = '__DEFAULT__'\n","export function createPromiseWithResolvers<T>(): PromiseWithResolvers<T> {\n  // Shim of Stage 4 Promise.withResolvers proposal\n  let resolve: (value: T | PromiseLike<T>) => void\n  let reject: (reason: any) => void\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res\n    reject = rej\n  })\n  return { resolve: resolve!, reject: reject!, promise }\n}\n","// This has to be a shared module which is shared between client component error boundary and dynamic component\nconst BAILOUT_TO_CSR = 'BAILOUT_TO_CLIENT_SIDE_RENDERING'\n\n/** An error that should be thrown when we want to bail out to client-side rendering. */\nexport class BailoutToCSRError extends Error {\n  public readonly digest = BAILOUT_TO_CSR\n\n  constructor(public readonly reason: string) {\n    super(`Bail out to client-side rendering: ${reason}`)\n  }\n}\n\n/** Checks if a passed argument is an error that is thrown if we want to bail out to client-side rendering. */\nexport function isBailoutToCSRError(err: unknown): err is BailoutToCSRError {\n  if (typeof err !== 'object' || err === null || !('digest' in err)) {\n    return false\n  }\n\n  return err.digest === BAILOUT_TO_CSR\n}\n","/**\r\n * Client-side logger utility\r\n * For use in React components and hooks (browser environment)\r\n * Disables console.log in production for better performance\r\n */\r\n\r\ntype LogLevel = 'log' | 'error' | 'warn' | 'info' | 'debug';\r\n\r\nclass ClientLogger {\r\n  private isDevelopment = typeof window !== 'undefined' && \r\n    (window.location.hostname === 'localhost' || \r\n     window.location.hostname === '127.0.0.1' ||\r\n     process.env.NODE_ENV === 'development');\r\n\r\n  private shouldLog(level: LogLevel): boolean {\r\n    // Always log errors and warnings\r\n    if (level === 'error' || level === 'warn') {\r\n      return true;\r\n    }\r\n    // Only log other levels in development\r\n    return this.isDevelopment;\r\n  }\r\n\r\n  log(...args: any[]): void {\r\n    if (this.shouldLog('log')) {\r\n      console.log(...args);\r\n    }\r\n  }\r\n\r\n  error(...args: any[]): void {\r\n    console.error(...args);\r\n  }\r\n\r\n  warn(...args: any[]): void {\r\n    console.warn(...args);\r\n  }\r\n\r\n  info(...args: any[]): void {\r\n    if (this.shouldLog('info')) {\r\n      console.info(...args);\r\n    }\r\n  }\r\n\r\n  debug(...args: any[]): void {\r\n    if (this.shouldLog('debug')) {\r\n      console.debug(...args);\r\n    }\r\n  }\r\n}\r\n\r\nexport const logger = new ClientLogger();\r\n\r\n","\"use client\";\n\nimport { create } from \"zustand\";\nimport type { Product, ProductFilters } from \"@/types/product\";\nimport { logger } from \"@/lib/logger-client\";\nimport { validateImageUrl, normalizeImageUrl } from \"@/lib/image-utils\";\nimport { normalizeImages, normalizeSpecifications } from \"@/lib/product-utils\";\n\ninterface ProductStore {\n  products: Product[];\n  filters: ProductFilters;\n  \n  // Actions\n  setProducts: (products: Product[]) => void;\n  addProduct: (product: Product) => void;\n  updateProduct: (product: Product) => void;\n  removeProduct: (id: string) => void;\n  getProduct: (id: string) => Product | undefined;\n  getEnabledProducts: () => Product[];\n  getFilteredProducts: () => Product[];\n  setFilters: (filters: Partial<ProductFilters>) => void;\n  clearFilters: () => void;\n  \n  // Additional actions for product table\n  deleteProduct: (id: string) => Promise<void>;\n  deleteProducts: (ids: string[]) => Promise<void>;\n  toggleProduct: (id: string) => Promise<void>;\n  toggleProducts: (ids: string[], enabled: boolean) => Promise<void>;\n  \n  // Async API sync methods (optional - for direct API calls with store sync)\n  createProduct: (productData: Omit<Product, \"id\" | \"createdAt\" | \"updatedAt\">) => Promise<Product>;\n  updateProductInDB: (id: string, productData: Partial<Product>) => Promise<Product>;\n  deleteProductFromDB: (id: string) => Promise<void>;\n  loadProductsFromDB: (includeInactive?: boolean) => Promise<void>;\n}\n\nconst defaultFilters: ProductFilters = {};\n\nexport const useProductStore = create<ProductStore>((set, get) => ({\n  products: [],\n  filters: defaultFilters,\n\n  setProducts: (products) => {\n    // Validate and normalize images for all products - be more lenient with base64\n    const validatedProducts = products.map((product) => {\n      // First, normalize images (this handles parsing JSON strings into arrays)\n      const normalizedImages = normalizeImages(product.images);\n      \n      // Then validate and normalize each image URL\n      const validatedImages = normalizedImages\n        .map((img) => {\n          if (!img || typeof img !== 'string') return null;\n          const trimmed = img.trim();\n          if (trimmed === '') return null;\n          \n          // For base64 images, validate directly without normalization\n          if (trimmed.startsWith('data:image') || trimmed.startsWith('data:')) {\n            if (trimmed.includes(';base64,') && trimmed.length > 50) {\n              return trimmed; // Accept base64 images with basic validation\n            } else if (trimmed.startsWith('data:image') && trimmed.length > 50) {\n              // Even without ;base64,, if it's data:image and long enough, accept it\n              return trimmed;\n            }\n            return null;\n          }\n          \n          // For other URLs (http, https, blob, relative), normalize and validate\n          const normalized = normalizeImageUrl(trimmed);\n          if (!normalized) return null;\n          return validateImageUrl(normalized) ? normalized : null;\n        })\n        .filter((img): img is string => img !== null);\n      \n      return {\n        ...product,\n        images: validatedImages,\n      };\n    });\n    set({ products: validatedProducts });\n  },\n\n  addProduct: (product) =>\n    set((state) => {\n      // First, normalize images (this handles parsing JSON strings into arrays)\n      const normalizedImages = normalizeImages(product.images);\n      \n      // Then validate and normalize each image URL - be more lenient with base64\n      const validatedImages = normalizedImages\n        .map((img) => {\n          if (!img || typeof img !== 'string') return null;\n          const trimmed = img.trim();\n          if (trimmed === '') return null;\n          \n          // For base64 images, validate directly without normalization\n          if (trimmed.startsWith('data:image') || trimmed.startsWith('data:')) {\n            if (trimmed.includes(';base64,') && trimmed.length > 50) {\n              return trimmed; // Accept base64 images with basic validation\n            } else if (trimmed.startsWith('data:image') && trimmed.length > 50) {\n              // Even without ;base64,, if it's data:image and long enough, accept it\n              return trimmed;\n            }\n            return null;\n          }\n          \n          // For other URLs (http, https, blob, relative), normalize and validate\n          const normalized = normalizeImageUrl(trimmed);\n          if (!normalized) return null;\n          return validateImageUrl(normalized) ? normalized : null;\n        })\n        .filter((img): img is string => img !== null);\n      \n      const validatedProduct = {\n        ...product,\n        images: validatedImages,\n        // Ensure boolean fields are properly converted from numbers (0/1) to booleans\n        inStock: product.inStock !== undefined ? Boolean(product.inStock) : true,\n        enabled: product.enabled !== undefined ? Boolean(product.enabled) : true,\n        vinEnabled: product.vinEnabled !== undefined ? Boolean(product.vinEnabled) : false,\n        airShippingEnabled: product.airShippingEnabled !== undefined ? Boolean(product.airShippingEnabled) : true,\n        seaShippingEnabled: product.seaShippingEnabled !== undefined ? Boolean(product.seaShippingEnabled) : true,\n      };\n\n      const existingIndex = state.products.findIndex((p) => p.id === validatedProduct.id);\n      if (existingIndex >= 0) {\n        // Update existing product\n        const updatedProducts = [...state.products];\n        updatedProducts[existingIndex] = validatedProduct;\n        return { products: updatedProducts };\n      }\n      // Add new product\n      return { products: [...state.products, validatedProduct] };\n    }),\n\n  updateProduct: (product) =>\n    set((state) => {\n      // First, normalize images (this handles parsing JSON strings into arrays)\n      const normalizedImages = normalizeImages(product.images);\n      \n      // Then validate and normalize each image URL - be more lenient with base64\n      const validatedImages = normalizedImages\n        .map((img) => {\n          if (!img || typeof img !== 'string') return null;\n          const trimmed = img.trim();\n          if (trimmed === '') return null;\n          \n          // For base64 images, validate directly without normalization\n          if (trimmed.startsWith('data:image') || trimmed.startsWith('data:')) {\n            if (trimmed.includes(';base64,') && trimmed.length > 50) {\n              return trimmed; // Accept base64 images with basic validation\n            } else if (trimmed.startsWith('data:image') && trimmed.length > 50) {\n              // Even without ;base64,, if it's data:image and long enough, accept it\n              return trimmed;\n            }\n            return null;\n          }\n          \n          // For other URLs (http, https, blob, relative), normalize and validate\n          const normalized = normalizeImageUrl(trimmed);\n          if (!normalized) return null;\n          return validateImageUrl(normalized) ? normalized : null;\n        })\n        .filter((img): img is string => img !== null);\n      \n      const validatedProduct = {\n        ...product,\n        images: validatedImages,\n        // Ensure boolean fields are properly converted from numbers (0/1) to booleans\n        inStock: product.inStock !== undefined ? Boolean(product.inStock) : true,\n        enabled: product.enabled !== undefined ? Boolean(product.enabled) : true,\n        vinEnabled: product.vinEnabled !== undefined ? Boolean(product.vinEnabled) : false,\n        airShippingEnabled: product.airShippingEnabled !== undefined ? Boolean(product.airShippingEnabled) : true,\n        seaShippingEnabled: product.seaShippingEnabled !== undefined ? Boolean(product.seaShippingEnabled) : true,\n      };\n\n      const existingIndex = state.products.findIndex((p) => p.id === validatedProduct.id);\n      if (existingIndex >= 0) {\n        const updatedProducts = [...state.products];\n        updatedProducts[existingIndex] = validatedProduct;\n        return { products: updatedProducts };\n      }\n      return state;\n    }),\n\n  removeProduct: (id) =>\n    set((state) => ({\n      products: state.products.filter((p) => p.id !== id),\n    })),\n\n  getProduct: (id) => {\n    const state = get();\n    return state.products.find((p) => p.id === id);\n  },\n\n  getEnabledProducts: () => {\n    const state = get();\n    return state.products.filter((p) => p.enabled);\n  },\n\n  getFilteredProducts: () => {\n    const state = get();\n    const { products, filters } = state;\n    \n    let filtered = products.filter((p) => p.enabled);\n\n    // Apply search filter - search in all relevant fields\n    if (filters.search) {\n      const searchLower = filters.search.toLowerCase();\n      filtered = filtered.filter(\n        (p) => {\n          // Search in name\n          if (p.name?.toLowerCase().includes(searchLower)) return true;\n          // Search in description\n          if (p.description?.toLowerCase().includes(searchLower)) return true;\n          // Search in brand\n          if (p.brand?.toLowerCase().includes(searchLower)) return true;\n          // Search in category\n          if (p.category?.toLowerCase().includes(searchLower)) return true;\n          // Search in VIN\n          if (p.vin?.toLowerCase().includes(searchLower)) return true;\n          // Search in tags (if array)\n          if (Array.isArray(p.tags) && p.tags.some(tag => tag?.toLowerCase().includes(searchLower))) return true;\n          // Search in specifications (if object)\n          if (p.specifications && typeof p.specifications === 'object') {\n            const specString = JSON.stringify(p.specifications).toLowerCase();\n            if (specString.includes(searchLower)) return true;\n          }\n          return false;\n        }\n      );\n    }\n\n    // Apply price filters\n    if (filters.minPrice !== undefined) {\n      filtered = filtered.filter((p) => p.price >= filters.minPrice!);\n    }\n    if (filters.maxPrice !== undefined) {\n      filtered = filtered.filter((p) => p.price <= filters.maxPrice!);\n    }\n\n    // Apply brand filter\n    if (filters.brands && filters.brands.length > 0) {\n      filtered = filtered.filter(\n        (p) => p.brand && filters.brands!.includes(p.brand)\n      );\n    }\n\n    // Apply category filter\n    if (filters.categories && filters.categories.length > 0) {\n      filtered = filtered.filter(\n        (p) => p.category && filters.categories!.includes(p.category)\n      );\n    }\n\n    // Apply vehicle filter\n    if (filters.vehicle) {\n      filtered = filtered.filter((p) => p.vehicle === filters.vehicle);\n    }\n\n    // Apply stock filter\n    if (filters.inStock !== undefined) {\n      filtered = filtered.filter((p) => p.inStock === filters.inStock);\n    }\n\n    return filtered;\n  },\n\n  setFilters: (newFilters) =>\n    set((state) => {\n      const updatedFilters = { ...state.filters };\n      \n      // Apply new filters\n      Object.keys(newFilters).forEach((key) => {\n        const value = newFilters[key as keyof ProductFilters];\n        if (value === undefined || value === null || (Array.isArray(value) && value.length === 0)) {\n          // Remove filter if undefined, null, or empty array\n          delete updatedFilters[key as keyof ProductFilters];\n        } else {\n          // Set filter value\n          (updatedFilters as any)[key] = value;\n        }\n      });\n      \n      return { filters: updatedFilters };\n    }),\n\n  clearFilters: () => set({ filters: defaultFilters }),\n\n  // Async API sync methods\n  createProduct: async (productData) => {\n    const response = await fetch(\"/api/products\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(productData),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new Error(errorData.message || \"خطا در ایجاد محصول\");\n    }\n\n    const result = await response.json();\n    const newProduct = result.data;\n    get().addProduct(newProduct);\n    return newProduct;\n  },\n\n  updateProductInDB: async (id, productData) => {\n    const response = await fetch(`/api/products/${id}`, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(productData),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new Error(errorData.message || \"خطا در به‌روزرسانی محصول\");\n    }\n\n    const result = await response.json();\n    const updatedProduct = result.data;\n    get().updateProduct(updatedProduct);\n    return updatedProduct;\n  },\n\n  deleteProductFromDB: async (id) => {\n    const response = await fetch(`/api/products/${id}`, {\n      method: \"DELETE\",\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new Error(errorData.message || \"خطا در حذف محصول\");\n    }\n\n    get().removeProduct(id);\n  },\n\n  loadProductsFromDB: async (includeInactive: boolean = false) => {\n    try {\n      // For admin pages, we need all products (including inactive ones)\n      const url = includeInactive ? \"/api/products?limit=1000&all=true\" : \"/api/products?limit=1000\";\n      const response = await fetch(url);\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        const errorMessage = errorData.error || errorData.message || \"خطا در بارگذاری محصولات\";\n        throw new Error(errorMessage);\n      }\n      const result = await response.json();\n      \n      // Debug: Log raw API response\n      if (process.env.NODE_ENV === 'development') {\n        console.log('[ProductStore] Raw API response:', {\n          success: result.success,\n          dataLength: result.data?.length || 0,\n          firstProduct: result.data?.[0] ? {\n            id: result.data[0].id,\n            name: result.data[0].name,\n            imagesRaw: result.data[0].images,\n            imagesType: typeof result.data[0].images,\n            imagesIsArray: Array.isArray(result.data[0].images),\n            imagesLength: Array.isArray(result.data[0].images) ? result.data[0].images.length : 0,\n            firstImagePreview: Array.isArray(result.data[0].images) && result.data[0].images[0] \n              ? result.data[0].images[0].substring(0, 100) \n              : null,\n          } : null,\n        });\n      }\n      \n      const products = (result.data || []).map((product: any) => {\n        // First, normalize images (this handles parsing JSON strings into arrays)\n        const normalizedImages = normalizeImages(product.images);\n        \n        // Then validate and normalize each image URL - be more lenient with base64\n        let validatedImages: string[] = normalizedImages\n          .map((img: string) => {\n            if (!img || typeof img !== 'string') {\n              if (process.env.NODE_ENV === 'development') {\n                console.warn('[ProductStore] Invalid image (not string):', { img, type: typeof img });\n              }\n              return null;\n            }\n            const trimmed = img.trim();\n            if (trimmed === '') {\n              if (process.env.NODE_ENV === 'development') {\n                console.warn('[ProductStore] Invalid image (empty after trim)');\n              }\n              return null;\n            }\n            \n            // For base64 images, validate directly without normalization\n            if (trimmed.startsWith('data:image') || trimmed.startsWith('data:')) {\n              // Just check basic structure for base64\n              if (trimmed.includes(';base64,') && trimmed.length > 50) {\n                if (process.env.NODE_ENV === 'development') {\n                  console.log('[ProductStore] Accepted base64 image:', {\n                    length: trimmed.length,\n                    preview: trimmed.substring(0, 50),\n                  });\n                }\n                return trimmed; // Accept base64 images with basic validation\n              } else if (trimmed.startsWith('data:image') && trimmed.length > 50) {\n                // Even without ;base64,, if it's data:image and long enough, accept it\n                if (process.env.NODE_ENV === 'development') {\n                  console.log('[ProductStore] Accepted base64 image (without ;base64,):', {\n                    length: trimmed.length,\n                    preview: trimmed.substring(0, 50),\n                  });\n                }\n                return trimmed;\n              } else {\n                if (process.env.NODE_ENV === 'development') {\n                  console.warn('[ProductStore] Rejected base64 image (invalid structure):', {\n                    hasBase64: trimmed.includes(';base64,'),\n                    length: trimmed.length,\n                    preview: trimmed.substring(0, 50),\n                  });\n                }\n                return null;\n              }\n            }\n            \n            // For other URLs (http, https, blob, relative), normalize and validate\n            const normalized = normalizeImageUrl(trimmed);\n            if (!normalized) {\n              if (process.env.NODE_ENV === 'development') {\n                console.warn('[ProductStore] Rejected image (normalization failed):', {\n                  original: trimmed.substring(0, 100),\n                });\n              }\n              return null;\n            }\n            \n            const isValid = validateImageUrl(normalized);\n            if (!isValid && process.env.NODE_ENV === 'development') {\n              console.warn('[ProductStore] Rejected image (validation failed):', {\n                original: trimmed.substring(0, 100),\n                normalized: normalized.substring(0, 100),\n              });\n            }\n            return isValid ? normalized : null;\n          })\n          .filter((img: string | null): img is string => img !== null);\n        \n        // Debug: Log if images were parsed from string\n        if (process.env.NODE_ENV === 'development' && typeof product.images === 'string' && normalizedImages.length > 0) {\n          console.log('[ProductStore] Parsed images from string:', {\n            productId: product.id,\n            originalType: typeof product.images,\n            parsedCount: normalizedImages.length,\n            validatedCount: validatedImages.length,\n          });\n        }\n\n        const processedProduct = {\n          ...product,\n          images: validatedImages,\n          specifications: normalizeSpecifications(product.specifications),\n          // Ensure boolean fields are properly converted from numbers (0/1) to booleans\n          inStock: product.inStock !== undefined ? Boolean(product.inStock) : true,\n          enabled: product.enabled !== undefined ? Boolean(product.enabled) : true,\n          vinEnabled: product.vinEnabled !== undefined ? Boolean(product.vinEnabled) : false,\n          airShippingEnabled: product.airShippingEnabled !== undefined ? Boolean(product.airShippingEnabled) : true,\n          seaShippingEnabled: product.seaShippingEnabled !== undefined ? Boolean(product.seaShippingEnabled) : true,\n          createdAt: product.createdAt instanceof Date \n            ? product.createdAt \n            : new Date(product.createdAt),\n          updatedAt: product.updatedAt instanceof Date \n            ? product.updatedAt \n            : new Date(product.updatedAt),\n        };\n        \n        // Debug: Log processed product\n        if (process.env.NODE_ENV === 'development' && processedProduct.images.length === 0 && Array.isArray(product.images) && product.images.length > 0) {\n          console.warn('[ProductStore] Product lost all images during validation:', {\n            productId: processedProduct.id,\n            productName: processedProduct.name,\n            originalImagesCount: Array.isArray(product.images) ? product.images.length : 0,\n            validatedImagesCount: processedProduct.images.length,\n            originalFirstImage: Array.isArray(product.images) && product.images[0] \n              ? product.images[0].substring(0, 200) \n              : null,\n          });\n        }\n        \n        return processedProduct;\n      });\n      \n      // Debug: Log final products\n      if (process.env.NODE_ENV === 'development') {\n        const firstProductWithImages = products.find((p: Product) => p.images && p.images.length > 0);\n        console.log('[ProductStore] Processed products:', {\n          total: products.length,\n          productsWithImages: products.filter((p: Product) => p.images && p.images.length > 0).length,\n          productsWithoutImages: products.filter((p: Product) => !p.images || p.images.length === 0).length,\n          firstProductWithImages: firstProductWithImages ? {\n            id: firstProductWithImages.id,\n            name: firstProductWithImages.name,\n            imagesCount: firstProductWithImages.images.length,\n            firstImagePreview: firstProductWithImages.images[0].substring(0, 100),\n          } : null,\n        });\n      }\n      \n      get().setProducts(products);\n    } catch (error) {\n      logger.error(\"Error loading products from DB:\", error);\n      // Don't throw - allow app to continue with empty products\n    }\n  },\n\n  // Additional actions for product table\n  deleteProduct: async (id) => {\n    await get().deleteProductFromDB(id);\n  },\n\n  deleteProducts: async (ids) => {\n    await Promise.all(ids.map((id) => get().deleteProductFromDB(id)));\n  },\n\n  toggleProduct: async (id) => {\n    const product = get().getProduct(id);\n    if (product) {\n      await get().updateProductInDB(id, { enabled: !product.enabled });\n    }\n  },\n\n  toggleProducts: async (ids, enabled) => {\n    await Promise.all(\n      ids.map((id) => get().updateProductInDB(id, { enabled }))\n    );\n  },\n}));\n\n\n","/**\r\n * Image utility functions\r\n */\r\n\r\n/**\r\n * Get placeholder image URL\r\n * Uses external service for Next.js Image component compatibility\r\n * @param width - Image width in pixels (default: 600)\r\n * @param height - Image height in pixels (default: 600)\r\n * @returns Placeholder image URL\r\n */\r\nexport function getPlaceholderImage(width: number = 600, height: number = 600): string {\r\n  // Use placehold.co service for Next.js Image compatibility\r\n  const text = encodeURIComponent(`${width}x${height}`);\r\n  return `https://placehold.co/${width}x${height}/f3f4f6/9ca3af?text=${text}`;\r\n}\r\n\r\n/**\r\n * Validate if a string is a valid image URL\r\n * @param url - URL to validate\r\n * @returns true if valid, false otherwise\r\n */\r\nexport function validateImageUrl(url: string | null | undefined): boolean {\r\n  if (!url || typeof url !== 'string' || url.trim() === '') {\r\n    return false;\r\n  }\r\n\r\n  const trimmedUrl = url.trim();\r\n\r\n  // Check if it's a base64 data URL (be more lenient)\r\n  if (trimmedUrl.startsWith('data:image') || trimmedUrl.startsWith('data:')) {\r\n    // For base64, be more lenient - just check basic structure\r\n    // The browser will handle actual image validation\r\n    if (trimmedUrl.includes(';base64,') && trimmedUrl.length > 50) {\r\n      // Basic validation - let the browser handle the rest\r\n      return true;\r\n    }\r\n    // Even if it doesn't have ;base64,, if it's a data: URL and long enough, accept it\r\n    if (trimmedUrl.startsWith('data:image') && trimmedUrl.length > 50) {\r\n      return true;\r\n    }\r\n    // Fallback to strict validation\r\n    return validateBase64Image(trimmedUrl);\r\n  }\r\n\r\n  // Check if it's a blob URL\r\n  if (trimmedUrl.startsWith('blob:')) {\r\n    return true;\r\n  }\r\n\r\n  // Check if it's a relative path\r\n  if (trimmedUrl.startsWith('/')) {\r\n    return true;\r\n  }\r\n\r\n  // Check if it's a valid HTTP/HTTPS URL\r\n  try {\r\n    const urlObj = new URL(trimmedUrl);\r\n    return urlObj.protocol === 'http:' || urlObj.protocol === 'https:';\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Validate and check if base64 image is valid\r\n * @param base64 - Base64 string to validate\r\n * @returns true if valid, false otherwise\r\n */\r\nexport function validateBase64Image(base64: string): boolean {\r\n  if (!base64 || typeof base64 !== 'string') {\r\n    return false;\r\n  }\r\n\r\n  // Check if it starts with data:image\r\n  if (!base64.startsWith('data:image/')) {\r\n    return false;\r\n  }\r\n\r\n  // Check if it has the base64 prefix\r\n  if (!base64.includes(';base64,')) {\r\n    return false;\r\n  }\r\n\r\n  // Extract the base64 part\r\n  const base64Part = base64.split(';base64,')[1];\r\n  if (!base64Part || base64Part.trim() === '') {\r\n    return false;\r\n  }\r\n\r\n  // Check if base64 string is valid (basic check)\r\n  // Base64 should only contain A-Z, a-z, 0-9, +, /, and = characters\r\n  const base64Regex = /^[A-Za-z0-9+/]*={0,2}$/;\r\n  if (!base64Regex.test(base64Part)) {\r\n    return false;\r\n  }\r\n\r\n  // Check if it's not too large (more than 15MB base64 is problematic)\r\n  // But allow up to 15MB to handle high-quality product images\r\n  if (base64.length > 15 * 1024 * 1024) {\r\n    return false;\r\n  }\r\n\r\n  // Additional check: ensure the base64 part is not empty after trimming\r\n  if (base64Part.trim().length === 0) {\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n/**\r\n * Normalize image URL (convert relative to absolute, validate, etc.)\r\n * @param url - URL to normalize\r\n * @param baseUrl - Base URL for relative paths (default: current origin)\r\n * @returns Normalized URL or empty string if invalid\r\n */\r\nexport function normalizeImageUrl(\r\n  url: string | null | undefined,\r\n  baseUrl?: string\r\n): string {\r\n  if (!url || typeof url !== 'string' || url.trim() === '') {\r\n    return '';\r\n  }\r\n\r\n  const trimmedUrl = url.trim();\r\n\r\n  // If it's already a valid absolute URL or base64, return as is\r\n  if (trimmedUrl.startsWith('http://') || \r\n      trimmedUrl.startsWith('https://') || \r\n      trimmedUrl.startsWith('data:image') ||\r\n      trimmedUrl.startsWith('data:') || // More lenient - accept any data: URL\r\n      trimmedUrl.startsWith('blob:')) {\r\n    return trimmedUrl;\r\n  }\r\n\r\n  // Check if it might be a base64 string without the data: prefix\r\n  // Base64 strings are typically very long and contain only base64 characters\r\n  if (trimmedUrl.length > 100 && /^[A-Za-z0-9+/=]+$/.test(trimmedUrl)) {\r\n    // It might be a raw base64 string, but we can't use it without the data:image prefix\r\n    // Return empty string - the caller should handle this\r\n    return '';\r\n  }\r\n\r\n  // If it's a relative path starting with /\r\n  if (trimmedUrl.startsWith('/')) {\r\n    // If baseUrl is provided, use it; otherwise use current origin\r\n    if (baseUrl) {\r\n      return `${baseUrl}${trimmedUrl}`;\r\n    }\r\n    // In browser, use window.location.origin\r\n    if (typeof window !== 'undefined') {\r\n      return `${window.location.origin}${trimmedUrl}`;\r\n    }\r\n    // In server, return relative path (will be handled by Next.js)\r\n    return trimmedUrl;\r\n  }\r\n\r\n  // If it doesn't start with /, try to construct a full URL\r\n  // This handles cases where URL might be missing protocol\r\n  try {\r\n    const urlObj = new URL(trimmedUrl);\r\n    return urlObj.toString();\r\n  } catch {\r\n    // If URL construction fails, return empty string\r\n    return '';\r\n  }\r\n}\r\n\r\n/**\r\n * Preload an image\r\n * @param url - Image URL to preload\r\n * @returns Promise that resolves when image is loaded or rejects on error\r\n */\r\nexport function preloadImage(url: string): Promise<void> {\r\n  return new Promise((resolve, reject) => {\r\n    if (!validateImageUrl(url)) {\r\n      reject(new Error('Invalid image URL'));\r\n      return;\r\n    }\r\n\r\n    // For base64 images, we can't use Image object, so just resolve\r\n    if (url.startsWith('data:image') || url.startsWith('blob:')) {\r\n      resolve();\r\n      return;\r\n    }\r\n\r\n    const img = new Image();\r\n    img.onload = () => resolve();\r\n    img.onerror = () => reject(new Error('Failed to load image'));\r\n    img.src = url;\r\n  });\r\n}\r\n\r\n/**\r\n * Get cache key for an image URL\r\n * Removes query parameters that are used for cache busting\r\n * @param url - Image URL\r\n * @returns Cache key\r\n */\r\nexport function getImageCacheKey(url: string): string {\r\n  if (!url || typeof url !== 'string') {\r\n    return '';\r\n  }\r\n\r\n  // Remove cache busting parameters\r\n  try {\r\n    const urlObj = new URL(url);\r\n    urlObj.searchParams.delete('_retry');\r\n    urlObj.searchParams.delete('_t');\r\n    urlObj.searchParams.delete('_cache');\r\n    return urlObj.toString();\r\n  } catch {\r\n    // If URL parsing fails, remove common cache busting patterns manually\r\n    return url\r\n      .replace(/[?&]_retry=\\d+/g, '')\r\n      .replace(/[?&]_t=\\d+/g, '')\r\n      .replace(/[?&]_cache=\\d+/g, '');\r\n  }\r\n}\r\n\r\n/**\r\n * Check if image URL needs cache busting\r\n * @param url - Image URL\r\n * @returns true if cache busting is needed\r\n */\r\nexport function needsCacheBusting(url: string): boolean {\r\n  if (!url || typeof url !== 'string') {\r\n    return false;\r\n  }\r\n\r\n  // Base64 and blob URLs don't need cache busting\r\n  if (url.startsWith('data:image') || url.startsWith('blob:')) {\r\n    return false;\r\n  }\r\n\r\n  // Check if URL already has cache busting parameters\r\n  return !url.includes('_t=') && !url.includes('_retry=');\r\n}\r\n\r\n/**\r\n * Add cache busting to URL\r\n * @param url - Image URL\r\n * @returns URL with cache busting parameter\r\n */\r\nexport function addCacheBusting(url: string): string {\r\n  if (!url || typeof url !== 'string') {\r\n    return url;\r\n  }\r\n\r\n  // Don't add cache busting to base64 or blob URLs\r\n  if (url.startsWith('data:image') || url.startsWith('blob:')) {\r\n    return url;\r\n  }\r\n\r\n  const separator = url.includes('?') ? '&' : '?';\r\n  return `${url}${separator}_t=${Date.now()}`;\r\n}\r\n\r\n","/**\r\n * Utility functions for product data normalization\r\n */\r\n\r\n/**\r\n * Normalize images array from database\r\n * Handles various formats: string, array, null, undefined\r\n */\r\nexport function normalizeImages(images: any): string[] {\r\n  // اگر null یا undefined است\r\n  if (images == null) {\r\n    return [];\r\n  }\r\n\r\n  // اگر قبلاً array است\r\n  if (Array.isArray(images)) {\r\n    return images\r\n      .filter((img): img is string => \r\n        img != null && \r\n        typeof img === 'string' && \r\n        img.trim() !== ''\r\n      )\r\n      .map(img => img.trim());\r\n  }\r\n\r\n  // اگر string است، سعی کن parse کن\r\n  if (typeof images === 'string') {\r\n    // اگر string خالی است\r\n    if (images.trim() === '') {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const parsed = JSON.parse(images);\r\n      if (Array.isArray(parsed)) {\r\n        return parsed\r\n          .filter((img): img is string => \r\n            img != null && \r\n            typeof img === 'string' && \r\n            img.trim() !== ''\r\n          )\r\n          .map(img => img.trim());\r\n      }\r\n      // اگر یک string واحد است\r\n      if (typeof parsed === 'string' && parsed.trim() !== '') {\r\n        return [parsed.trim()];\r\n      }\r\n    } catch (e) {\r\n      // اگر parse ناموفق بود، خود string را به عنوان یک تصویر در نظر بگیر\r\n      return [images.trim()];\r\n    }\r\n  }\r\n\r\n  return [];\r\n}\r\n\r\n/**\r\n * Normalize tags array from database\r\n */\r\nexport function normalizeTags(tags: any): string[] {\r\n  if (tags == null) {\r\n    return [];\r\n  }\r\n\r\n  if (Array.isArray(tags)) {\r\n    return tags\r\n      .filter((tag): tag is string => \r\n        tag != null && \r\n        typeof tag === 'string' && \r\n        tag.trim() !== ''\r\n      )\r\n      .map(tag => tag.trim());\r\n  }\r\n\r\n  if (typeof tags === 'string') {\r\n    if (tags.trim() === '') {\r\n      return [];\r\n    }\r\n    try {\r\n      const parsed = JSON.parse(tags);\r\n      if (Array.isArray(parsed)) {\r\n        return parsed\r\n          .filter((tag): tag is string => \r\n            tag != null && \r\n            typeof tag === 'string' && \r\n            tag.trim() !== ''\r\n          )\r\n          .map(tag => tag.trim());\r\n      }\r\n    } catch (e) {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  return [];\r\n}\r\n\r\n/**\r\n * Normalize specifications object from database\r\n */\r\nexport function normalizeSpecifications(specs: any): Record<string, unknown> {\r\n  if (specs == null) {\r\n    return {};\r\n  }\r\n\r\n  if (typeof specs === 'object' && specs !== null && !Array.isArray(specs)) {\r\n    return specs;\r\n  }\r\n\r\n  if (typeof specs === 'string') {\r\n    if (specs.trim() === '') {\r\n      return {};\r\n    }\r\n    try {\r\n      const parsed = JSON.parse(specs);\r\n      if (typeof parsed === 'object' && parsed !== null && !Array.isArray(parsed)) {\r\n        return parsed;\r\n      }\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  return {};\r\n}\r\n\r\n"],"names":["DEFAULT_SEGMENT_KEY","PAGE_SEGMENT_KEY","addSearchParamsIfPageSegment","computeSelectedLayoutSegment","getSegmentValue","getSelectedLayoutSegmentPath","isGroupSegment","isParallelRouteSegment","segment","Array","isArray","endsWith","startsWith","searchParams","isPageSegment","includes","stringifiedQuery","JSON","stringify","segments","parallelRouteKey","length","rawSegment","tree","first","segmentPath","node","parallelRoutes","children","Object","values","segmentValue","push","createPromiseWithResolvers","resolve","reject","promise","Promise","res","rej","BailoutToCSRError","isBailoutToCSRError","BAILOUT_TO_CSR","Error","constructor","reason","digest","err"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9]}