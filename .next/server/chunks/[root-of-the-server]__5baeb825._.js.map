{"version":3,"sources":["../../../lib/logger.ts","../../../lib/db/postgres.ts"],"sourcesContent":["/**\r\n * Centralized logging utility\r\n * Disables console.log in production for better performance\r\n */\r\n\r\ntype LogLevel = 'log' | 'error' | 'warn' | 'info' | 'debug';\r\n\r\nclass Logger {\r\n  private isDevelopment = process.env.NODE_ENV === 'development';\r\n  private isProduction = process.env.NODE_ENV === 'production';\r\n\r\n  private shouldLog(level: LogLevel): boolean {\r\n    // Always log errors and warnings\r\n    if (level === 'error' || level === 'warn') {\r\n      return true;\r\n    }\r\n    // Only log other levels in development\r\n    return this.isDevelopment;\r\n  }\r\n\r\n  log(...args: any[]): void {\r\n    if (this.shouldLog('log')) {\r\n      console.log(...args);\r\n    }\r\n  }\r\n\r\n  error(...args: any[]): void {\r\n    console.error(...args);\r\n  }\r\n\r\n  warn(...args: any[]): void {\r\n    console.warn(...args);\r\n  }\r\n\r\n  info(...args: any[]): void {\r\n    if (this.shouldLog('info')) {\r\n      console.info(...args);\r\n    }\r\n  }\r\n\r\n  debug(...args: any[]): void {\r\n    if (this.shouldLog('debug')) {\r\n      console.debug(...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log database query (only in development)\r\n   */\r\n  dbQuery(query: string, params?: any[]): void {\r\n    if (this.isDevelopment) {\r\n      console.log('[DB Query]', query.substring(0, 100), params ? `[${params.length} params]` : '');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log API request (only in development)\r\n   */\r\n  apiRequest(method: string, path: string, statusCode?: number): void {\r\n    if (this.isDevelopment) {\r\n      console.log(`[API] ${method} ${path}${statusCode ? ` ${statusCode}` : ''}`);\r\n    }\r\n  }\r\n}\r\n\r\nexport const logger = new Logger();\r\n\r\n","/**\n * PostgreSQL Database Connection\n * \n * ÿß€åŸÜ ŸÖÿß⁄òŸàŸÑ ÿßÿ™ÿµÿßŸÑ ÿ®Ÿá PostgreSQL ÿ±ÿß ŸÖÿØ€åÿ±€åÿ™ ŸÖ€å‚Äå⁄©ŸÜÿØ\n * ŸÜÿßŸÖ ÿØ€åÿ™ÿßÿ®€åÿ≥: saded\n * ÿ±ŸÖÿ≤: saded\n */\n\nimport { Pool, PoolClient, QueryResult, QueryResultRow } from \"pg\";\nimport { logger } from \"@/lib/logger\";\n\n// Database configuration\n// Log configuration in development (without password)\nif (process.env.NODE_ENV === \"development\") {\n  logger.log(\"üîç Database Config:\", {\n    host: process.env.DB_HOST || \"localhost\",\n    port: process.env.DB_PORT || \"5432\",\n    database: process.env.DB_NAME || \"saded\",\n    user: process.env.DB_USER || \"postgres\",\n    password: process.env.DB_PASSWORD ? \"***SET***\" : \"‚ùå NOT SET\",\n  });\n}\n\nif (!process.env.DB_PASSWORD) {\n  logger.error(\"‚ö†Ô∏è  WARNING: DB_PASSWORD is not set in environment variables!\");\n  logger.error(\"   Please make sure .env file exists and contains DB_PASSWORD\");\n  logger.error(\"   If you just updated .env, restart your Next.js server\");\n  logger.error(\"   Current working directory:\", process.cwd());\n}\n\nconst DB_CONFIG = {\n  host: process.env.DB_HOST || \"127.0.0.1\", // Use IPv4 instead of localhost to avoid IPv6 issues\n  port: parseInt(process.env.DB_PORT || \"5432\"),\n  database: process.env.DB_NAME || \"saded\",\n  user: process.env.DB_USER || \"postgres\",\n  password: process.env.DB_PASSWORD || \"\",\n  // SSL configuration for cPanel PostgreSQL\n  ssl: process.env.DB_SSL === 'true' ? { rejectUnauthorized: false } : false,\n  max: 20, // Maximum number of clients in the pool\n  idleTimeoutMillis: 30000,\n  connectionTimeoutMillis: 2000,\n};\n\n// Create connection pool\nlet pool: Pool | null = null;\n\n/**\n * Get or create database connection pool\n */\nexport function getPool(): Pool {\n  if (!pool) {\n    // Log actual config being used (without password) in development\n    if (process.env.NODE_ENV === \"development\") {\n      logger.log(\"üîç Creating PostgreSQL pool with config:\", {\n        host: DB_CONFIG.host,\n        port: DB_CONFIG.port,\n        database: DB_CONFIG.database,\n        user: DB_CONFIG.user,\n        password: DB_CONFIG.password ? \"***SET***\" : \"‚ùå EMPTY\",\n      });\n    }\n\n    pool = new Pool(DB_CONFIG);\n\n    // Handle pool errors\n    pool.on(\"error\", (err) => {\n      logger.error(\"Unexpected error on idle PostgreSQL client\", err);\n    });\n  }\n\n  return pool;\n}\n\n/**\n * Test database connection\n */\nexport async function testConnection(): Promise<boolean> {\n  try {\n    const testPool = getPool();\n    const result = await testPool.query(\"SELECT NOW()\");\n    return result.rows.length > 0;\n  } catch (error) {\n    logger.error(\"Database connection test failed:\", error);\n    return false;\n  }\n}\n\n/**\n * Execute a query and return results\n */\nexport async function query<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<QueryResult<T>> {\n  const client = await getPool().connect();\n  try {\n    const result = await client.query<T>(text, params);\n    return result;\n  } catch (error: any) {\n    // Log detailed error (always log errors)\n    logger.error(\"‚ùå Database query error:\", {\n      message: error?.message,\n      code: error?.code,\n      query: text.substring(0, 100),\n      hasPassword: !!DB_CONFIG.password,\n    });\n    throw error;\n  } finally {\n    client.release();\n  }\n}\n\n/**\n * Execute a query and return single row\n */\nexport async function queryOne<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<T | null> {\n  const result = await query<T>(text, params);\n  return result.rows[0] || null;\n}\n\n/**\n * Execute a query and return all rows\n */\nexport async function queryAll<T extends QueryResultRow = any>(\n  text: string,\n  params?: any[]\n): Promise<T[]> {\n  const result = await query<T>(text, params);\n  return result.rows;\n}\n\n/**\n * Execute a transaction\n */\nexport async function transaction<T>(\n  callback: (client: PoolClient) => Promise<T>\n): Promise<T> {\n  const client = await getPool().connect();\n  try {\n    await client.query(\"BEGIN\");\n    const result = await callback(client);\n    await client.query(\"COMMIT\");\n    return result;\n  } catch (error) {\n    await client.query(\"ROLLBACK\");\n    throw error;\n  } finally {\n    client.release();\n  }\n}\n\n/**\n * Close all database connections\n */\nexport async function closePool(): Promise<void> {\n  if (pool) {\n    await pool.end();\n    pool = null;\n  }\n}\n\n/**\n * Initialize database tables\n */\nexport async function initializeTables(): Promise<void> {\n  // First, add new columns if they don't exist (for existing databases)\n  const addColumns = `\n    ALTER TABLE products ADD COLUMN IF NOT EXISTS \"airShippingCost\" BIGINT;\n    ALTER TABLE products ADD COLUMN IF NOT EXISTS \"seaShippingCost\" BIGINT;\n  `;\n\n  try {\n    await query(addColumns);\n    logger.debug(\"‚úÖ Shipping cost columns added/verified\");\n  } catch (error: any) {\n    // If table doesn't exist yet, that's fine - it will be created with the columns\n    if (!error?.message?.includes(\"does not exist\")) {\n      logger.warn(\"‚ö†Ô∏è Could not add shipping cost columns (may already exist or table doesn't exist yet):\", error?.message);\n    }\n  }\n\n  const createTables = `\n    -- Products table\n    CREATE TABLE IF NOT EXISTS products (\n      id VARCHAR(255) PRIMARY KEY,\n      name VARCHAR(255) NOT NULL,\n      description TEXT NOT NULL,\n      price BIGINT NOT NULL,\n      \"originalPrice\" BIGINT,\n      brand VARCHAR(255) NOT NULL,\n      category VARCHAR(255) NOT NULL,\n      vin VARCHAR(255),\n      \"vinEnabled\" BOOLEAN DEFAULT FALSE,\n      \"airShippingEnabled\" BOOLEAN DEFAULT TRUE,\n      \"seaShippingEnabled\" BOOLEAN DEFAULT TRUE,\n      \"airShippingCost\" BIGINT,\n      \"seaShippingCost\" BIGINT,\n      \"stockCount\" INTEGER DEFAULT 0,\n      \"inStock\" BOOLEAN DEFAULT TRUE,\n      enabled BOOLEAN DEFAULT TRUE,\n      images JSONB NOT NULL DEFAULT '[]'::jsonb,\n      tags JSONB DEFAULT '[]'::jsonb,\n      specifications JSONB DEFAULT '{}'::jsonb,\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      \"updatedAt\" TIMESTAMP NOT NULL DEFAULT NOW()\n    );\n\n    -- Categories table\n    CREATE TABLE IF NOT EXISTS categories (\n      id VARCHAR(255) PRIMARY KEY,\n      name VARCHAR(255) NOT NULL UNIQUE,\n      description TEXT,\n      slug VARCHAR(255) UNIQUE,\n      image VARCHAR(255),\n      icon VARCHAR(255),\n      enabled BOOLEAN DEFAULT TRUE,\n      \"isActive\" BOOLEAN DEFAULT TRUE,\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      \"updatedAt\" TIMESTAMP NOT NULL DEFAULT NOW()\n    );\n\n    -- Orders table\n    CREATE TABLE IF NOT EXISTS orders (\n      id VARCHAR(255) PRIMARY KEY,\n      \"orderNumber\" VARCHAR(255) UNIQUE NOT NULL,\n      \"userId\" VARCHAR(255),\n      \"customerName\" VARCHAR(255) NOT NULL,\n      \"customerPhone\" VARCHAR(255) NOT NULL,\n      \"customerEmail\" VARCHAR(255),\n      items JSONB NOT NULL DEFAULT '[]'::jsonb,\n      total BIGINT NOT NULL,\n      \"shippingCost\" BIGINT NOT NULL,\n      \"shippingMethod\" VARCHAR(50) NOT NULL,\n      \"shippingAddress\" JSONB NOT NULL DEFAULT '{}'::jsonb,\n      status VARCHAR(50) NOT NULL DEFAULT 'pending',\n      \"paymentStatus\" VARCHAR(50) NOT NULL DEFAULT 'pending',\n      notes TEXT,\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      \"updatedAt\" TIMESTAMP NOT NULL DEFAULT NOW()\n    );\n\n    -- Users table\n    CREATE TABLE IF NOT EXISTS users (\n      id VARCHAR(255) PRIMARY KEY,\n      email VARCHAR(255) UNIQUE NOT NULL,\n      password VARCHAR(255) NOT NULL,\n      name VARCHAR(255) NOT NULL,\n      role VARCHAR(50) NOT NULL DEFAULT 'user',\n      phone VARCHAR(255),\n      address TEXT,\n      enabled BOOLEAN DEFAULT TRUE,\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      \"updatedAt\" TIMESTAMP NOT NULL DEFAULT NOW()\n    );\n\n    -- Carts table (for storing user shopping carts)\n    CREATE TABLE IF NOT EXISTS carts (\n      id VARCHAR(255) PRIMARY KEY,\n      \"sessionId\" VARCHAR(255) NOT NULL,\n      \"userId\" VARCHAR(255),\n      items JSONB NOT NULL DEFAULT '[]'::jsonb,\n      \"shippingMethod\" VARCHAR(50),\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      \"updatedAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      UNIQUE(\"sessionId\")\n    );\n\n    -- Quick Buy Chats table\n    CREATE TABLE IF NOT EXISTS quick_buy_chats (\n      id VARCHAR(255) PRIMARY KEY,\n      \"customerName\" VARCHAR(255) NOT NULL,\n      \"customerPhone\" VARCHAR(255) NOT NULL,\n      \"customerEmail\" VARCHAR(255),\n      status VARCHAR(50) NOT NULL DEFAULT 'active',\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      \"updatedAt\" TIMESTAMP NOT NULL DEFAULT NOW()\n    );\n\n    -- Chat Messages table\n    CREATE TABLE IF NOT EXISTS chat_messages (\n      id VARCHAR(255) PRIMARY KEY,\n      \"chatId\" VARCHAR(255) NOT NULL REFERENCES quick_buy_chats(id) ON DELETE CASCADE,\n      text TEXT,\n      sender VARCHAR(50) NOT NULL,\n      attachments JSONB DEFAULT '[]'::jsonb,\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      FOREIGN KEY (\"chatId\") REFERENCES quick_buy_chats(id) ON DELETE CASCADE\n    );\n\n    -- Chat Attachments table (for storing file metadata)\n    CREATE TABLE IF NOT EXISTS chat_attachments (\n      id VARCHAR(255) PRIMARY KEY,\n      \"messageId\" VARCHAR(255) NOT NULL REFERENCES chat_messages(id) ON DELETE CASCADE,\n      type VARCHAR(50) NOT NULL,\n      \"filePath\" VARCHAR(500),\n      \"fileName\" VARCHAR(255),\n      \"fileSize\" BIGINT,\n      \"fileUrl\" VARCHAR(500),\n      \"createdAt\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      FOREIGN KEY (\"messageId\") REFERENCES chat_messages(id) ON DELETE CASCADE\n    );\n\n    -- Admin Presence table (for tracking admin online/offline status)\n    CREATE TABLE IF NOT EXISTS admin_presence (\n      \"adminId\" VARCHAR(255) PRIMARY KEY,\n      \"isOnline\" BOOLEAN DEFAULT FALSE,\n      \"lastSeen\" TIMESTAMP NOT NULL DEFAULT NOW(),\n      \"updatedAt\" TIMESTAMP NOT NULL DEFAULT NOW()\n    );\n\n    -- Create indexes\n    \n    -- Products indexes\n    CREATE INDEX IF NOT EXISTS idx_products_enabled ON products(enabled);\n    CREATE INDEX IF NOT EXISTS idx_products_category ON products(category);\n    CREATE INDEX IF NOT EXISTS idx_products_brand ON products(brand);\n    -- Composite index for common filter: enabled + category\n    CREATE INDEX IF NOT EXISTS idx_products_enabled_category ON products(enabled, category);\n    -- Composite index for search queries: enabled + price range\n    CREATE INDEX IF NOT EXISTS idx_products_enabled_price ON products(enabled, price);\n    -- Index for VIN search\n    CREATE INDEX IF NOT EXISTS idx_products_vin_enabled ON products(vin, \"vinEnabled\") WHERE \"vinEnabled\" = TRUE;\n    -- Index for inStock filter\n    CREATE INDEX IF NOT EXISTS idx_products_enabled_inStock ON products(enabled, \"inStock\");\n    \n    -- Orders indexes\n    CREATE INDEX IF NOT EXISTS idx_orders_userId ON orders(\"userId\");\n    CREATE INDEX IF NOT EXISTS idx_orders_status ON orders(status);\n    CREATE INDEX IF NOT EXISTS idx_orders_paymentStatus ON orders(\"paymentStatus\");\n    -- Composite index for order filtering\n    CREATE INDEX IF NOT EXISTS idx_orders_status_paymentStatus ON orders(status, \"paymentStatus\");\n    -- Index for order date queries\n    CREATE INDEX IF NOT EXISTS idx_orders_createdAt ON orders(\"createdAt\" DESC);\n    \n    -- Categories indexes\n    CREATE INDEX IF NOT EXISTS idx_categories_enabled ON categories(enabled);\n    CREATE INDEX IF NOT EXISTS idx_categories_enabled_active ON categories(enabled, \"isActive\");\n    \n    -- Carts indexes\n    CREATE INDEX IF NOT EXISTS idx_carts_sessionId ON carts(\"sessionId\");\n    CREATE INDEX IF NOT EXISTS idx_carts_userId ON carts(\"userId\");\n    \n    -- Chat indexes\n    CREATE INDEX IF NOT EXISTS idx_chat_messages_chatId ON chat_messages(\"chatId\");\n    CREATE INDEX IF NOT EXISTS idx_chat_messages_createdAt ON chat_messages(\"createdAt\");\n    -- Composite index for chat messages queries (chatId + createdAt for pagination)\n    CREATE INDEX IF NOT EXISTS idx_chat_messages_chatId_createdAt ON chat_messages(\"chatId\", \"createdAt\" DESC);\n    -- Index for unread messages count\n    CREATE INDEX IF NOT EXISTS idx_chat_messages_chatId_sender_status ON chat_messages(\"chatId\", sender, status);\n    CREATE INDEX IF NOT EXISTS idx_chat_attachments_messageId ON chat_attachments(\"messageId\");\n    CREATE INDEX IF NOT EXISTS idx_quick_buy_chats_status ON quick_buy_chats(status);\n    CREATE INDEX IF NOT EXISTS idx_quick_buy_chats_createdAt ON quick_buy_chats(\"createdAt\" DESC);\n    -- Index for finding chat by customer phone\n    CREATE INDEX IF NOT EXISTS idx_quick_buy_chats_customerPhone ON quick_buy_chats(\"customerPhone\");\n    \n    -- Admin presence index\n    CREATE INDEX IF NOT EXISTS idx_admin_presence_isOnline ON admin_presence(\"isOnline\");\n  `;\n\n  try {\n    await query(createTables);\n    logger.debug(\"‚úÖ Database tables initialized successfully\");\n  } catch (error) {\n    logger.error(\"‚ùå Error initializing database tables:\", error);\n    throw error;\n  }\n}\n\n/**\n * Check if database exists, if not create it\n */\nexport async function ensureDatabase(): Promise<void> {\n  // First connect to postgres database to check if saded exists\n  const adminPool = new Pool({\n    ...DB_CONFIG,\n    database: \"postgres\", // Connect to default postgres database\n    ssl: process.env.DB_SSL === 'true' ? { rejectUnauthorized: false } : false,\n  });\n\n  try {\n    // Check if database exists\n    const result = await adminPool.query(\n      \"SELECT 1 FROM pg_database WHERE datname = $1\",\n      [DB_CONFIG.database]\n    );\n\n    if (result.rows.length === 0) {\n      // Create database\n      await adminPool.query(`CREATE DATABASE ${DB_CONFIG.database}`);\n      logger.debug(`‚úÖ Database '${DB_CONFIG.database}' created successfully`);\n    } else {\n      logger.debug(`‚úÖ Database '${DB_CONFIG.database}' already exists`);\n    }\n  } catch (error: any) {\n    // If error is about database already existing, that's fine\n    if (error.code !== \"42P04\") {\n      logger.error(\"Error ensuring database:\", error);\n      throw error;\n    }\n  } finally {\n    await adminPool.end();\n  }\n}\n\n"],"names":[],"mappings":"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"}